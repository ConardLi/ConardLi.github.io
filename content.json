{"meta":{"title":"æä¸–å¥‡çš„æŠ€æœ¯ä¸“æ ","subtitle":null,"description":"Fe Coder","author":"ConardLi","url":"https://www.lisq.xyz"},"pages":[{"title":"about","date":"2018-10-28T15:07:13.000Z","updated":"2018-11-03T15:46:49.634Z","comments":true,"path":"about/index.html","permalink":"https://www.lisq.xyz/about/index.html","excerpt":"","text":"å…³äºï¼Œä»¥åå†è¯´â€¦â€¦.."}],"posts":[{"title":"ã€Reactæ·±å…¥ã€‘ä»Mixinåˆ°HOCå†åˆ°Hook","slug":"ã€Reactæ·±å…¥ã€‘ä»Mixinåˆ°HOCå†åˆ°Hook","date":"2019-04-09T15:27:27.000Z","updated":"2019-04-09T15:28:00.607Z","comments":true,"path":"2019/04/09/ã€Reactæ·±å…¥ã€‘ä»Mixinåˆ°HOCå†åˆ°Hook/","link":"","permalink":"https://www.lisq.xyz/2019/04/09/ã€Reactæ·±å…¥ã€‘ä»Mixinåˆ°HOCå†åˆ°Hook/","excerpt":"","text":"å¯¼è¯»å‰ç«¯å‘å±•é€Ÿåº¦éå¸¸ä¹‹å¿«ï¼Œé¡µé¢å’Œç»„ä»¶å˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œå¦‚ä½•æ›´å¥½çš„å®ç°çŠ¶æ€é€»è¾‘å¤ç”¨ä¸€ç›´éƒ½æ˜¯åº”ç”¨ç¨‹åºä¸­é‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œè¿™ç›´æ¥å…³ç³»ç€åº”ç”¨ç¨‹åºçš„è´¨é‡ä»¥åŠç»´æŠ¤çš„éš¾æ˜“ç¨‹åº¦ã€‚ æœ¬æ–‡ä»‹ç»äº†Reacté‡‡ç”¨çš„ä¸‰ç§å®ç°çŠ¶æ€é€»è¾‘å¤ç”¨çš„æŠ€æœ¯ï¼Œå¹¶åˆ†æäº†ä»–ä»¬çš„å®ç°åŸç†ã€ä½¿ç”¨æ–¹æ³•ã€å®é™…åº”ç”¨ä»¥åŠå¦‚ä½•é€‰æ‹©ä½¿ç”¨ä»–ä»¬ã€‚ æœ¬æ–‡ç•¥é•¿ï¼Œä¸‹é¢æ˜¯æœ¬æ–‡çš„æ€ç»´å¯¼å›¾ï¼Œæ‚¨å¯ä»¥ä»å¤´å¼€å§‹é˜…è¯»ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©æ„Ÿå…´è¶£çš„éƒ¨åˆ†é˜…è¯»ï¼š Mixinè®¾è®¡æ¨¡å¼ Mixinï¼ˆæ··å…¥ï¼‰æ˜¯ä¸€ç§é€šè¿‡æ‰©å±•æ”¶é›†åŠŸèƒ½çš„æ–¹å¼ï¼Œå®ƒæœ¬è´¨ä¸Šæ˜¯å°†ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ‹·è´åˆ°å¦ä¸€ä¸ªå¯¹è±¡ä¸Šé¢å»ï¼Œä¸è¿‡ä½ å¯ä»¥æ‹·è´ä»»æ„å¤šä¸ªå¯¹è±¡çš„ä»»æ„ä¸ªæ–¹æ³•åˆ°ä¸€ä¸ªæ–°å¯¹è±¡ä¸Šå»ï¼Œè¿™æ˜¯ç»§æ‰¿æ‰€ä¸èƒ½å®ç°çš„ã€‚å®ƒçš„å‡ºç°ä¸»è¦å°±æ˜¯ä¸ºäº†è§£å†³ä»£ç å¤ç”¨é—®é¢˜ã€‚ å¾ˆå¤šå¼€æºåº“æä¾›äº†Mixinçš„å®ç°ï¼Œå¦‚Underscoreçš„_.extendæ–¹æ³•ã€JQueryçš„extendæ–¹æ³•ã€‚ ä½¿ç”¨_.extendæ–¹æ³•å®ç°ä»£ç å¤ç”¨ï¼š 12345678910111213141516var LogMixin = &#123; actionLog: function() &#123; console.log('action...'); &#125;, requestLog: function() &#123; console.log('request...'); &#125;,&#125;;function User() &#123; /*..*/ &#125;function Goods() &#123; /*..*/ &#125;_.extend(User.prototype, LogMixin);_.extend(Goods.prototype, LogMixin);var user = new User();var good = new Goods();user.actionLog();good.requestLog(); æˆ‘ä»¬å¯ä»¥å°è¯•æ‰‹åŠ¨å†™ä¸€ä¸ªç®€å•çš„Mixinæ–¹æ³•ï¼š 12345678910111213141516function setMixin(target, mixin) &#123; if (arguments[2]) &#123; for (var i = 2, len = arguments.length; i &lt; len; i++) &#123; target.prototype[arguments[i]] = mixin.prototype[arguments[i]]; &#125; &#125; else &#123; for (var methodName in mixin.prototype) &#123; if (!Object.hasOwnProperty(target.prototype, methodName)) &#123; target.prototype[methodName] = mixin.prototype[methodName]; &#125; &#125; &#125;&#125;setMixin(User,LogMixin,'actionLog');setMixin(Goods,LogMixin,'requestLog'); æ‚¨å¯ä»¥ä½¿ç”¨setMixin\bæ–¹æ³•å°†ä»»æ„å¯¹è±¡çš„ä»»æ„æ–¹æ³•æ‰©å±•åˆ°ç›®æ ‡å¯¹è±¡ä¸Šã€‚ Reactä¸­åº”ç”¨MixinReactä¹Ÿæä¾›äº†Mixinçš„å®ç°ï¼Œå¦‚æœå®Œå…¨ä¸åŒçš„ç»„ä»¶æœ‰ç›¸ä¼¼çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥å¼•å…¥æ¥å®ç°ä»£ç å¤ç”¨ï¼Œå½“ç„¶åªæœ‰åœ¨ä½¿ç”¨createClassæ¥åˆ›å»ºReactç»„ä»¶æ—¶æ‰å¯ä»¥ä½¿ç”¨ï¼Œå› ä¸ºåœ¨Reactç»„ä»¶çš„es6å†™æ³•ä¸­å®ƒå·²ç»è¢«åºŸå¼ƒæ‰äº†ã€‚ ä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­ï¼Œå¾ˆå¤šç»„ä»¶æˆ–é¡µé¢éƒ½éœ€è¦è®°å½•ç”¨æˆ·è¡Œä¸ºï¼Œæ€§èƒ½æŒ‡æ ‡ç­‰ã€‚å¦‚æœæˆ‘ä»¬åœ¨æ¯ä¸ªç»„ä»¶éƒ½å¼•å…¥å†™æ—¥å¿—çš„é€»è¾‘ï¼Œä¼šäº§ç”Ÿå¤§é‡é‡å¤ä»£ç ï¼Œé€šè¿‡Mixinæˆ‘ä»¬å¯ä»¥è§£å†³è¿™ä¸€é—®é¢˜ï¼š 12345678910111213141516171819202122232425var LogMixin = &#123; log: function() &#123; console.log('log'); &#125;, componentDidMount: function() &#123; console.log('in'); &#125;, componentWillUnmount: function() &#123; console.log('out'); &#125;&#125;;var User = React.createClass(&#123; mixins: [LogMixin], render: function() &#123; return (&lt;div&gt;...&lt;/div&gt;) &#125;&#125;);var Goods = React.createClass(&#123; mixins: [LogMixin], render: function() &#123; return (&lt;div&gt;...&lt;/div&gt;) &#125;&#125;); Mixinå¸¦æ¥çš„å±å®³Reactå®˜æ–¹æ–‡æ¡£åœ¨Mixins Considered Harmfulä¸€æ–‡ä¸­æåˆ°äº†Mixinå¸¦æ¥äº†å±å®³ï¼š Mixin å¯èƒ½ä¼šç›¸äº’ä¾èµ–ï¼Œç›¸äº’è€¦åˆï¼Œä¸åˆ©äºä»£ç ç»´æŠ¤ ä¸åŒçš„Mixinä¸­çš„æ–¹æ³•å¯èƒ½ä¼šç›¸äº’å†²çª Mixinéå¸¸å¤šæ—¶ï¼Œç»„ä»¶æ˜¯å¯ä»¥æ„ŸçŸ¥åˆ°çš„ï¼Œç”šè‡³è¿˜è¦ä¸ºå…¶åšç›¸å…³å¤„ç†ï¼Œè¿™æ ·ä¼šç»™ä»£ç é€ æˆæ»šé›ªçƒå¼çš„å¤æ‚æ€§ Reactç°åœ¨å·²ç»ä¸å†æ¨èä½¿ç”¨Mixinæ¥è§£å†³ä»£ç å¤ç”¨é—®é¢˜ï¼Œå› ä¸ºMixinå¸¦æ¥çš„å±å®³æ¯”ä»–äº§ç”Ÿçš„ä»·å€¼è¿˜è¦å·¨å¤§ï¼Œå¹¶ä¸”Reactå…¨é¢æ¨èä½¿ç”¨é«˜é˜¶ç»„ä»¶æ¥æ›¿ä»£å®ƒã€‚å¦å¤–ï¼Œé«˜é˜¶ç»„ä»¶è¿˜èƒ½å®ç°æ›´å¤šå…¶ä»–æ›´å¼ºå¤§çš„åŠŸèƒ½ï¼Œåœ¨å­¦ä¹ é«˜é˜¶ç»„ä»¶ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªè®¾è®¡æ¨¡å¼ã€‚ è£…é¥°æ¨¡å¼ è£…é¥°è€…(decorator)æ¨¡å¼èƒ½å¤Ÿåœ¨ä¸æ”¹å˜å¯¹è±¡è‡ªèº«çš„åŸºç¡€ä¸Šï¼Œåœ¨ç¨‹åºè¿è¡ŒæœŸé—´ç»™å¯¹åƒåŠ¨æ€çš„æ·»åŠ èŒè´£ã€‚ä¸ç»§æ‰¿ç›¸æ¯”ï¼Œè£…é¥°è€…æ˜¯ä¸€ç§æ›´è½»ä¾¿çµæ´»çš„åšæ³•ã€‚ é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰ é«˜é˜¶ç»„ä»¶å¯ä»¥çœ‹ä½œReactå¯¹è£…é¥°æ¨¡å¼çš„ä¸€ç§å®ç°ï¼Œé«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¸”è¯¥å‡½æ•°æ¥å—ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ã€‚ é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰æ˜¯Reactä¸­çš„é«˜çº§æŠ€æœ¯ï¼Œç”¨æ¥é‡ç”¨ç»„ä»¶é€»è¾‘ã€‚ä½†é«˜é˜¶ç»„ä»¶æœ¬èº«å¹¶ä¸æ˜¯React APIã€‚å®ƒåªæ˜¯ä¸€ç§æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼æ˜¯ç”±Reactè‡ªèº«çš„ç»„åˆæ€§è´¨å¿…ç„¶äº§ç”Ÿçš„ã€‚ 123456789function visible(WrappedComponent) &#123; return class extends Component &#123; render() &#123; const &#123; visible, ...props &#125; = this.props; if (visible === false) return null; return &lt;WrappedComponent &#123;...props&#125; /&gt;; &#125; &#125;&#125; ä¸Šé¢çš„ä»£ç å°±æ˜¯ä¸€ä¸ªHOCçš„ç®€å•åº”ç”¨ï¼Œå‡½æ•°æ¥æ”¶ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°ç»„ä»¶ï¼Œæ–°ç»„å»ºå¯ä»¥æ¥æ”¶ä¸€ä¸ªvisible propsï¼Œæ ¹æ®visibleçš„å€¼æ¥åˆ¤æ–­æ˜¯å¦æ¸²æŸ“Visibleã€‚ ä¸‹é¢æˆ‘ä»¬ä»ä»¥ä¸‹å‡ æ–¹é¢æ¥å…·ä½“æ¢ç´¢HOCã€‚ HOCçš„å®ç°æ–¹å¼å±æ€§ä»£ç†å‡½æ•°è¿”å›ä¸€ä¸ªæˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ç»„ä»¶ï¼Œç„¶ååœ¨renderä¸­è¿”å›è¦åŒ…è£¹çš„ç»„ä»¶ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä»£ç†æ‰€æœ‰ä¼ å…¥çš„propsï¼Œå¹¶ä¸”å†³å®šå¦‚ä½•æ¸²æŸ“ï¼Œå®é™…ä¸Š ï¼Œè¿™ç§æ–¹å¼ç”Ÿæˆçš„é«˜é˜¶ç»„ä»¶å°±æ˜¯åŸç»„ä»¶çš„çˆ¶ç»„ä»¶ï¼Œä¸Šé¢çš„å‡½æ•°visibleå°±æ˜¯ä¸€ä¸ªHOCå±æ€§ä»£ç†çš„å®ç°æ–¹å¼ã€‚ 1234567function proxyHOC(WrappedComponent) &#123; return class extends Component &#123; render() &#123; return &lt;WrappedComponent &#123;...this.props&#125; /&gt;; &#125; &#125;&#125; å¯¹æ¯”åŸç”Ÿç»„ä»¶å¢å¼ºçš„é¡¹ï¼š å¯æ“ä½œæ‰€æœ‰ä¼ å…¥çš„props å¯æ“ä½œç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ å¯æ“ä½œç»„ä»¶çš„staticæ–¹æ³• è·å–refs åå‘ç»§æ‰¿è¿”å›ä¸€ä¸ªç»„ä»¶ï¼Œç»§æ‰¿åŸç»„ä»¶ï¼Œåœ¨renderä¸­è°ƒç”¨åŸç»„ä»¶çš„renderã€‚ç”±äºç»§æ‰¿äº†åŸç»„ä»¶ï¼Œèƒ½é€šè¿‡thisè®¿é—®åˆ°åŸç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸã€propsã€stateã€renderç­‰ï¼Œç›¸æ¯”å±æ€§ä»£ç†å®ƒèƒ½æ“ä½œæ›´å¤šçš„å±æ€§ã€‚ 1234567function inheritHOC(WrappedComponent) &#123; return class extends WrappedComponent &#123; render() &#123; return super.render(); &#125; &#125;&#125; å¯¹æ¯”åŸç”Ÿç»„ä»¶å¢å¼ºçš„é¡¹ï¼š å¯æ“ä½œæ‰€æœ‰ä¼ å…¥çš„props å¯æ“ä½œç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ å¯æ“ä½œç»„ä»¶çš„staticæ–¹æ³• è·å–refs å¯æ“ä½œstate å¯ä»¥æ¸²æŸ“åŠ«æŒ HOCå¯ä»¥å®ç°ä»€ä¹ˆåŠŸèƒ½ç»„åˆæ¸²æŸ“å¯ä½¿ç”¨ä»»ä½•å…¶ä»–ç»„ä»¶å’ŒåŸç»„ä»¶è¿›è¡Œç»„åˆæ¸²æŸ“ï¼Œè¾¾åˆ°æ ·å¼ã€å¸ƒå±€å¤ç”¨ç­‰æ•ˆæœã€‚ é€šè¿‡å±æ€§ä»£ç†å®ç° 12345678910function stylHOC(WrappedComponent) &#123; return class extends Component &#123; render() &#123; return (&lt;div&gt; &lt;div className=\"title\"&gt;&#123;this.props.title&#125;&lt;/div&gt; &lt;WrappedComponent &#123;...this.props&#125; /&gt; &lt;/div&gt;); &#125; &#125;&#125; é€šè¿‡åå‘ç»§æ‰¿å®ç° 12345678910function styleHOC(WrappedComponent) &#123; return class extends WrappedComponent &#123; render() &#123; return &lt;div&gt; &lt;div className=\"title\"&gt;&#123;this.props.title&#125;&lt;/div&gt; &#123;super.render()&#125; &lt;/div&gt; &#125; &#125;&#125; æ¡ä»¶æ¸²æŸ“æ ¹æ®ç‰¹å®šçš„å±æ€§å†³å®šåŸç»„ä»¶æ˜¯å¦æ¸²æŸ“ é€šè¿‡å±æ€§ä»£ç†å®ç° 12345678function visibleHOC(WrappedComponent) &#123; return class extends Component &#123; render() &#123; if (this.props.visible === false) return null; return &lt;WrappedComponent &#123;...props&#125; /&gt;; &#125; &#125;&#125; é€šè¿‡åå‘ç»§æ‰¿å®ç° 1234567891011function visibleHOC(WrappedComponent) &#123; return class extends WrappedComponent &#123; render() &#123; if (this.props.visible === false) &#123; return null &#125; else &#123; return super.render() &#125; &#125; &#125;&#125; æ“ä½œpropså¯ä»¥å¯¹ä¼ å…¥ç»„ä»¶çš„propsè¿›è¡Œå¢åŠ ã€ä¿®æ”¹ã€åˆ é™¤æˆ–è€…æ ¹æ®ç‰¹å®šçš„propsè¿›è¡Œç‰¹æ®Šçš„æ“ä½œã€‚ é€šè¿‡å±æ€§ä»£ç†å®ç° 1234567891011function proxyHOC(WrappedComponent) &#123; return class extends Component &#123; render() &#123; const newProps = &#123; ...this.props, user: 'ConardLi' &#125; return &lt;WrappedComponent &#123;...newProps&#125; /&gt;; &#125; &#125;&#125; è·å–refsé«˜é˜¶ç»„ä»¶ä¸­å¯è·å–åŸç»„ä»¶çš„refï¼Œé€šè¿‡refè·å–ç»„ä»¶å®åŠ›ï¼Œå¦‚ä¸‹é¢çš„ä»£ç ï¼Œå½“ç¨‹åºåˆå§‹åŒ–å®Œæˆåè°ƒç”¨åŸç»„ä»¶çš„logæ–¹æ³•ã€‚(ä¸çŸ¥é“refsæ€ä¹ˆç”¨ï¼Œè¯·ğŸ‘‡Refs &amp; DOM) é€šè¿‡å±æ€§ä»£ç†å®ç° 12345678910function refHOC(WrappedComponent) &#123; return class extends Component &#123; componentDidMount() &#123; this.wapperRef.log() &#125; render() &#123; return &lt;WrappedComponent &#123;...this.props&#125; ref=&#123;ref =&gt; &#123; this.wapperRef = ref &#125;&#125; /&gt;; &#125; &#125;&#125; è¿™é‡Œæ³¨æ„ï¼šè°ƒç”¨é«˜é˜¶ç»„ä»¶çš„æ—¶å€™å¹¶ä¸èƒ½è·å–åˆ°åŸç»„ä»¶çš„çœŸå®refï¼Œéœ€è¦æ‰‹åŠ¨è¿›è¡Œä¼ é€’ï¼Œå…·ä½“è¯·çœ‹ä¼ é€’refs çŠ¶æ€ç®¡ç†å°†åŸç»„ä»¶çš„çŠ¶æ€æå–åˆ°HOCä¸­è¿›è¡Œç®¡ç†ï¼Œå¦‚ä¸‹é¢çš„ä»£ç ï¼Œæˆ‘ä»¬å°†Inputçš„valueæå–åˆ°HOCä¸­è¿›è¡Œç®¡ç†ï¼Œä½¿å®ƒå˜æˆå—æ§ç»„ä»¶ï¼ŒåŒæ—¶ä¸å½±å“å®ƒä½¿ç”¨onChangeæ–¹æ³•è¿›è¡Œä¸€äº›å…¶ä»–æ“ä½œã€‚åŸºäºè¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªç®€å•çš„åŒå‘ç»‘å®šï¼Œå…·ä½“è¯·çœ‹åŒå‘ç»‘å®šã€‚ é€šè¿‡å±æ€§ä»£ç†å®ç° 1234567891011121314151617181920212223242526272829303132333435function proxyHoc(WrappedComponent) &#123; return class extends Component &#123; constructor(props) &#123; super(props); this.state = &#123; value: '' &#125;; &#125; onChange = (event) =&gt; &#123; const &#123; onChange &#125; = this.props; this.setState(&#123; value: event.target.value, &#125;, () =&gt; &#123; if(typeof onChange ==='function')&#123; onChange(event); &#125; &#125;) &#125; render() &#123; const newProps = &#123; value: this.state.value, onChange: this.onChange, &#125; return &lt;WrappedComponent &#123;...this.props&#125; &#123;...newProps&#125; /&gt;; &#125; &#125;&#125;class HOC extends Component &#123; render() &#123; return &lt;input &#123;...this.props&#125;&gt;&lt;/input&gt; &#125;&#125;export default proxyHoc(HOC); æ“ä½œstateä¸Šé¢çš„ä¾‹å­é€šè¿‡å±æ€§ä»£ç†åˆ©ç”¨HOCçš„stateå¯¹åŸç»„ä»¶è¿›è¡Œäº†ä¸€å®šçš„å¢å¼ºï¼Œä½†å¹¶ä¸èƒ½ç›´æ¥æ§åˆ¶åŸç»„ä»¶çš„stateï¼Œè€Œé€šè¿‡åå‘ç»§æ‰¿ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ“ä½œåŸç»„ä»¶çš„stateã€‚ä½†æ˜¯å¹¶ä¸æ¨èç›´æ¥ä¿®æ”¹æˆ–æ·»åŠ åŸç»„ä»¶çš„stateï¼Œå› ä¸ºè¿™æ ·æœ‰å¯èƒ½å’Œç»„ä»¶å†…éƒ¨çš„æ“ä½œæ„æˆå†²çªã€‚ é€šè¿‡åå‘ç»§æ‰¿å®ç° 12345678910111213function debugHOC(WrappedComponent) &#123; return class extends WrappedComponent &#123; render() &#123; console.log('props', this.props); console.log('state', this.state); return ( &lt;div className=\"debuging\"&gt; &#123;super.render()&#125; &lt;/div&gt; ) &#125; &#125;&#125; ä¸Šé¢çš„HOCåœ¨renderä¸­å°†propså’Œstateæ‰“å°å‡ºæ¥ï¼Œå¯ä»¥ç”¨ä½œè°ƒè¯•é˜¶æ®µï¼Œå½“ç„¶ä½ å¯ä»¥åœ¨é‡Œé¢å†™æ›´å¤šçš„è°ƒè¯•ä»£ç ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œåªéœ€è¦åœ¨æˆ‘ä»¬æƒ³è¦è°ƒè¯•çš„ç»„ä»¶ä¸ŠåŠ ä¸Š@debugå°±å¯ä»¥å¯¹è¯¥ç»„ä»¶è¿›è¡Œè°ƒè¯•ï¼Œè€Œä¸éœ€è¦åœ¨æ¯æ¬¡è°ƒè¯•çš„æ—¶å€™å†™å¾ˆå¤šå†—ä½™ä»£ç ã€‚(å¦‚æœä½ è¿˜ä¸çŸ¥é“æ€ä¹ˆä½¿ç”¨HOCï¼Œè¯·ğŸ‘‡å¦‚ä½•ä½¿ç”¨HOC) æ¸²æŸ“åŠ«æŒé«˜é˜¶ç»„ä»¶å¯ä»¥åœ¨renderå‡½æ•°ä¸­åšéå¸¸å¤šçš„æ“ä½œï¼Œä»è€Œæ§åˆ¶åŸç»„ä»¶çš„æ¸²æŸ“è¾“å‡ºã€‚åªè¦æ”¹å˜äº†åŸç»„ä»¶çš„æ¸²æŸ“ï¼Œæˆ‘ä»¬éƒ½å°†å®ƒç§°ä¹‹ä¸ºä¸€ç§æ¸²æŸ“åŠ«æŒã€‚ å®é™…ä¸Šï¼Œä¸Šé¢çš„ç»„åˆæ¸²æŸ“å’Œæ¡ä»¶æ¸²æŸ“éƒ½æ˜¯æ¸²æŸ“åŠ«æŒçš„ä¸€ç§ï¼Œé€šè¿‡åå‘ç»§æ‰¿ï¼Œä¸ä»…å¯ä»¥å®ç°ä»¥ä¸Šä¸¤ç‚¹ï¼Œè¿˜å¯ç›´æ¥å¢å¼ºç”±åŸç»„ä»¶renderå‡½æ•°äº§ç”Ÿçš„Reactå…ƒç´ ã€‚ é€šè¿‡åå‘ç»§æ‰¿å®ç° 1234567891011121314function hijackHOC(WrappedComponent) &#123; return class extends WrappedComponent &#123; render() &#123; const tree = super.render(); let newProps = &#123;&#125;; if (tree &amp;&amp; tree.type === 'input') &#123; newProps = &#123; value: 'æ¸²æŸ“è¢«åŠ«æŒäº†' &#125;; &#125; const props = Object.assign(&#123;&#125;, tree.props, newProps); const newTree = React.cloneElement(tree, props, tree.props.children); return newTree; &#125; &#125;&#125; æ³¨æ„ä¸Šé¢çš„è¯´æ˜æˆ‘ç”¨çš„æ˜¯å¢å¼ºè€Œä¸æ˜¯æ›´æ”¹ã€‚renderå‡½æ•°å†…å®é™…ä¸Šæ˜¯è°ƒç”¨React.creatElementäº§ç”Ÿçš„Reactå…ƒç´ ï¼š è™½ç„¶æˆ‘ä»¬èƒ½æ‹¿åˆ°å®ƒï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½ç›´æ¥ä¿®æ”¹å®ƒé‡Œé¢çš„å±æ€§ï¼Œæˆ‘ä»¬é€šè¿‡getOwnPropertyDescriptorså‡½æ•°æ¥æ‰“å°ä¸‹å®ƒçš„é…ç½®é¡¹ï¼š å¯ä»¥å‘ç°ï¼Œæ‰€æœ‰çš„writableå±æ€§å‡è¢«é…ç½®ä¸ºäº†falseï¼Œå³æ‰€æœ‰å±æ€§æ˜¯ä¸å¯å˜çš„ã€‚ï¼ˆå¯¹è¿™äº›é…ç½®é¡¹æœ‰ç–‘é—®ï¼Œè¯·ğŸ‘‡definePropertyï¼‰ ä¸èƒ½ç›´æ¥ä¿®æ”¹ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©cloneElementæ–¹æ³•æ¥åœ¨åŸç»„ä»¶çš„åŸºç¡€ä¸Šå¢å¼ºä¸€ä¸ªæ–°ç»„ä»¶ï¼š React.cloneElement()å…‹éš†å¹¶è¿”å›ä¸€ä¸ªæ–°çš„Reactå…ƒç´ ï¼Œä½¿ç”¨elementä½œä¸ºèµ·ç‚¹ã€‚ç”Ÿæˆçš„å…ƒç´ å°†ä¼šæ‹¥æœ‰åŸå§‹å…ƒç´ propsä¸æ–°propsçš„æµ…åˆå¹¶ã€‚æ–°çš„å­çº§ä¼šæ›¿æ¢ç°æœ‰çš„å­çº§ã€‚æ¥è‡ªåŸå§‹å…ƒç´ çš„ key å’Œ ref å°†ä¼šä¿ç•™ã€‚ React.cloneElement()å‡ ä¹ç›¸å½“äºï¼š 1&lt;element.type &#123;...element.props&#125; &#123;...props&#125;&gt;&#123;children&#125;&lt;/element.type&gt; å¦‚ä½•ä½¿ç”¨HOCä¸Šé¢çš„ç¤ºä¾‹ä»£ç éƒ½å†™çš„æ˜¯å¦‚ä½•å£°æ˜ä¸€ä¸ªHOCï¼ŒHOCå®é™…ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†è¦å¢å¼ºçš„ç»„ä»¶ä½œä¸ºå‚æ•°è°ƒç”¨HOCå‡½æ•°ï¼Œå¾—åˆ°å¢å¼ºåçš„ç»„ä»¶ã€‚ 123456class myComponent extends Component &#123; render() &#123; return (&lt;span&gt;åŸç»„ä»¶&lt;/span&gt;) &#125;&#125;export default inheritHOC(myComponent); composeåœ¨å®é™…åº”ç”¨ä¸­ï¼Œä¸€ä¸ªç»„ä»¶å¯èƒ½è¢«å¤šä¸ªHOCå¢å¼ºï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯è¢«æ‰€æœ‰çš„HOCå¢å¼ºåçš„ç»„ä»¶ï¼Œå€Ÿç”¨ä¸€å¼ è£…é¥°æ¨¡å¼çš„å›¾æ¥è¯´æ˜ï¼Œå¯èƒ½æ›´å®¹æ˜“ç†è§£ï¼š å‡è®¾ç°åœ¨æˆ‘ä»¬æœ‰loggerï¼Œvisibleï¼Œstyleç­‰å¤šä¸ªHOCï¼Œç°åœ¨è¦åŒæ—¶å¢å¼ºä¸€ä¸ªInputç»„ä»¶ï¼š 1logger(visible(style(Input))) è¿™ç§ä»£ç éå¸¸çš„éš¾ä»¥é˜…è¯»ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨å°è£…ä¸€ä¸ªç®€å•çš„å‡½æ•°ç»„åˆå·¥å…·ï¼Œå°†å†™æ³•æ”¹å†™å¦‚ä¸‹ï¼š 12const compose = (...fns) =&gt; fns.reduce((f, g) =&gt; (...args) =&gt; g(f(...args)));compose(logger,visible,style)(Input); composeå‡½æ•°è¿”å›ä¸€ä¸ªæ‰€æœ‰å‡½æ•°ç»„åˆåçš„å‡½æ•°ï¼Œcompose(f, g, h) å’Œ (...args) =&gt; f(g(h(...args)))æ˜¯ä¸€æ ·çš„ã€‚ å¾ˆå¤šç¬¬ä¸‰æ–¹åº“éƒ½æä¾›äº†ç±»ä¼¼composeçš„å‡½æ•°ï¼Œä¾‹å¦‚lodash.flowRightï¼ŒReduxæä¾›çš„combineReducerså‡½æ•°ç­‰ã€‚ Decoratorsæˆ‘ä»¬è¿˜å¯ä»¥å€ŸåŠ©ES7ä¸ºæˆ‘ä»¬æä¾›çš„Decoratorsæ¥è®©æˆ‘ä»¬çš„å†™æ³•å˜çš„æ›´åŠ ä¼˜é›…ï¼š 123456@logger@visible@styleclass Input extends Component &#123; // ...&#125; Decoratorsæ˜¯ES7çš„ä¸€ä¸ªææ¡ˆï¼Œè¿˜æ²¡æœ‰è¢«æ ‡å‡†åŒ–ï¼Œä½†ç›®å‰Babelè½¬ç å™¨å·²ç»æ”¯æŒï¼Œæˆ‘ä»¬éœ€è¦æå‰é…ç½®babel-plugin-transform-decorators-legacyï¼š 1\"plugins\": [\"transform-decorators-legacy\"] è¿˜å¯ä»¥ç»“åˆä¸Šé¢çš„composeå‡½æ•°ä½¿ç”¨ï¼š 12345const hoc = compose(logger, visible, style);@hocclass Input extends Component &#123; // ...&#125; HOCçš„å®é™…åº”ç”¨ä¸‹é¢æ˜¯ä¸€äº›æˆ‘åœ¨å…¬å¸é¡¹ç›®ä¸­å®é™…å¯¹HOCçš„å®é™…åº”ç”¨åœºæ™¯ï¼Œç”±äºæ–‡ç« ç¯‡å¹…åŸå› ï¼Œä»£ç ç»è¿‡å¾ˆå¤šç®€åŒ–ï¼Œå¦‚æœ‰é—®é¢˜æ¬¢è¿åœ¨è¯„è®ºåŒºæŒ‡å‡ºï¼š æ—¥å¿—æ‰“ç‚¹å®é™…ä¸Šè¿™å±äºä¸€ç±»æœ€å¸¸è§çš„åº”ç”¨ï¼Œå¤šä¸ªç»„ä»¶æ‹¥æœ‰ç±»ä¼¼çš„é€»è¾‘ï¼Œæˆ‘ä»¬è¦å¯¹é‡å¤çš„é€»è¾‘è¿›è¡Œå¤ç”¨ï¼Œå®˜æ–¹æ–‡æ¡£ä¸­CommentListçš„ç¤ºä¾‹ä¹Ÿæ˜¯è§£å†³äº†ä»£ç å¤ç”¨é—®é¢˜ï¼Œå†™çš„å¾ˆè¯¦ç»†ï¼Œæœ‰å…´è¶£å¯ä»¥ğŸ‘‡ä½¿ç”¨é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰è§£å†³æ¨ªåˆ‡å…³æ³¨ç‚¹ã€‚ æŸäº›é¡µé¢éœ€è¦è®°å½•ç”¨æˆ·è¡Œä¸ºï¼Œæ€§èƒ½æŒ‡æ ‡ç­‰ç­‰ï¼Œé€šè¿‡é«˜é˜¶ç»„ä»¶åšè¿™äº›äº‹æƒ…å¯ä»¥çœå»å¾ˆå¤šé‡å¤ä»£ç ã€‚ 123456789101112131415161718function logHoc(WrappedComponent) &#123; return class extends Component &#123; componentWillMount() &#123; this.start = Date.now(); &#125; componentDidMount() &#123; this.end = Date.now(); console.log(`$&#123;WrappedComponent.dispalyName&#125; æ¸²æŸ“æ—¶é—´ï¼š$&#123;this.end - this.start&#125; ms`); console.log(`$&#123;user&#125;è¿›å…¥$&#123;WrappedComponent.dispalyName&#125;`); &#125; componentWillUnmount() &#123; console.log(`$&#123;user&#125;é€€å‡º$&#123;WrappedComponent.dispalyName&#125;`); &#125; render() &#123; return &lt;WrappedComponent &#123;...this.props&#125; /&gt; &#125; &#125;&#125; å¯ç”¨ã€æƒé™æ§åˆ¶1234567891011function auth(WrappedComponent) &#123; return class extends Component &#123; render() &#123; const &#123; visible, auth, display = null, ...props &#125; = this.props; if (visible === false || (auth &amp;&amp; authList.indexOf(auth) === -1)) &#123; return display &#125; return &lt;WrappedComponent &#123;...props&#125; /&gt;; &#125; &#125;&#125; authListæ˜¯æˆ‘ä»¬åœ¨è¿›å…¥ç¨‹åºæ—¶å‘åç«¯è¯·æ±‚çš„æ‰€æœ‰æƒé™åˆ—è¡¨ï¼Œå½“ç»„ä»¶æ‰€éœ€è¦çš„æƒé™ä¸åˆ—è¡¨ä¸­ï¼Œæˆ–è€…è®¾ç½®çš„visibleæ˜¯falseï¼Œæˆ‘ä»¬å°†å…¶æ˜¾ç¤ºä¸ºä¼ å…¥çš„ç»„ä»¶æ ·å¼ï¼Œæˆ–è€…nullã€‚æˆ‘ä»¬å¯ä»¥å°†ä»»ä½•éœ€è¦è¿›è¡Œæƒé™æ ¡éªŒçš„ç»„ä»¶åº”ç”¨HOCï¼š 1234567@authclass Input extends Component &#123; ... &#125;@authclass Button extends Component &#123; ... &#125;&lt;Button auth=\"user/addUser\"&gt;æ·»åŠ ç”¨æˆ·&lt;/Button&gt;&lt;Input auth=\"user/search\" visible=&#123;false&#125; &gt;æ·»åŠ ç”¨æˆ·&lt;/Input&gt; åŒå‘ç»‘å®šåœ¨vueä¸­ï¼Œç»‘å®šä¸€ä¸ªå˜é‡åå¯å®ç°åŒå‘æ•°æ®ç»‘å®šï¼Œå³è¡¨å•ä¸­çš„å€¼æ”¹å˜åç»‘å®šçš„å˜é‡ä¹Ÿä¼šè‡ªåŠ¨æ”¹å˜ã€‚è€ŒReactä¸­æ²¡æœ‰åšè¿™æ ·çš„å¤„ç†ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œè¡¨å•å…ƒç´ éƒ½æ˜¯éå—æ§ç»„ä»¶ã€‚ç»™è¡¨å•å…ƒç´ ç»‘å®šä¸€ä¸ªçŠ¶æ€åï¼Œå¾€å¾€éœ€è¦æ‰‹åŠ¨ä¹¦å†™onChangeæ–¹æ³•æ¥å°†å…¶æ”¹å†™ä¸ºå—æ§ç»„ä»¶ï¼Œåœ¨è¡¨å•å…ƒç´ éå¸¸å¤šçš„æƒ…å†µä¸‹è¿™äº›é‡å¤æ“ä½œæ˜¯éå¸¸ç—›è‹¦çš„ã€‚ æˆ‘ä»¬å¯ä»¥å€ŸåŠ©é«˜é˜¶ç»„ä»¶æ¥å®ç°ä¸€ä¸ªç®€å•çš„åŒå‘ç»‘å®šï¼Œä»£ç ç•¥é•¿ï¼Œå¯ä»¥ç»“åˆä¸‹é¢çš„æ€ç»´å¯¼å›¾è¿›è¡Œç†è§£ã€‚ é¦–å…ˆæˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ªFormç»„ä»¶ï¼Œè¯¥ç»„ä»¶ç”¨äºåŒ…è£¹æ‰€æœ‰éœ€è¦åŒ…è£¹çš„è¡¨å•ç»„ä»¶ï¼Œé€šè¿‡contexå‘å­ç»„ä»¶æš´éœ²ä¸¤ä¸ªå±æ€§ï¼š modelï¼šå½“å‰Formç®¡æ§çš„æ‰€æœ‰æ•°æ®ï¼Œç”±è¡¨å•nameå’Œvalueç»„æˆï¼Œå¦‚{name:&#39;ConardLi&#39;,pwd:&#39;123&#39;}ã€‚modelå¯ç”±å¤–éƒ¨ä¼ å…¥ï¼Œä¹Ÿå¯è‡ªè¡Œç®¡æ§ã€‚ changeModelï¼šæ”¹å˜modelä¸­æŸä¸ªnameçš„å€¼ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940class Form extends Component &#123; static childContextTypes = &#123; model: PropTypes.object, changeModel: PropTypes.func &#125; constructor(props, context) &#123; super(props, context); this.state = &#123; model: props.model || &#123;&#125; &#125;; &#125; componentWillReceiveProps(nextProps) &#123; if (nextProps.model) &#123; this.setState(&#123; model: nextProps.model &#125;) &#125; &#125; changeModel = (name, value) =&gt; &#123; this.setState(&#123; model: &#123; ...this.state.model, [name]: value &#125; &#125;) &#125; getChildContext() &#123; return &#123; changeModel: this.changeModel, model: this.props.model || this.state.model &#125;; &#125; onSubmit = () =&gt; &#123; console.log(this.state.model); &#125; render() &#123; return &lt;div&gt; &#123;this.props.children&#125; &lt;button onClick=&#123;this.onSubmit&#125;&gt;æäº¤&lt;/button&gt; &lt;/div&gt; &#125;&#125; ä¸‹é¢å®šä¹‰ç”¨äºåŒå‘ç»‘å®šçš„HOCï¼Œå…¶ä»£ç†äº†è¡¨å•çš„onChangeå±æ€§å’Œvalueå±æ€§ï¼š å‘ç”ŸonChangeäº‹ä»¶æ—¶è°ƒç”¨ä¸Šå±‚Formçš„changeModelæ–¹æ³•æ¥æ”¹å˜contextä¸­çš„modelã€‚ åœ¨æ¸²æŸ“æ—¶å°†valueæ”¹ä¸ºä»contextä¸­å–å‡ºçš„å€¼ã€‚ 1234567891011121314151617181920212223242526272829303132function proxyHoc(WrappedComponent) &#123; return class extends Component &#123; static contextTypes = &#123; model: PropTypes.object, changeModel: PropTypes.func &#125; onChange = (event) =&gt; &#123; const &#123; changeModel &#125; = this.context; const &#123; onChange &#125; = this.props; const &#123; v_model &#125; = this.props; changeModel(v_model, event.target.value); if(typeof onChange === 'function')&#123;onChange(event);&#125; &#125; render() &#123; const &#123; model &#125; = this.context; const &#123; v_model &#125; = this.props; return &lt;WrappedComponent &#123;...this.props&#125; value=&#123;model[v_model]&#125; onChange=&#123;this.onChange&#125; /&gt;; &#125; &#125;&#125;@proxyHocclass Input extends Component &#123; render() &#123; return &lt;input &#123;...this.props&#125;&gt;&lt;/input&gt; &#125;&#125; ä¸Šé¢çš„ä»£ç åªæ˜¯ç®€ç•¥çš„ä¸€éƒ¨åˆ†ï¼Œé™¤äº†inputï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å°†HOCåº”ç”¨åœ¨selectç­‰å…¶ä»–è¡¨å•ç»„ä»¶ï¼Œç”šè‡³è¿˜å¯ä»¥å°†ä¸Šé¢çš„HOCå…¼å®¹åˆ°spanã€tableç­‰å±•ç¤ºç»„ä»¶ï¼Œè¿™æ ·åšå¯ä»¥å¤§å¤§ç®€åŒ–ä»£ç ï¼Œè®©æˆ‘ä»¬çœå»äº†å¾ˆå¤šçŠ¶æ€ç®¡ç†çš„å·¥ä½œï¼Œä½¿ç”¨å¦‚ä¸‹ï¼š 12345678910export default class extends Component &#123; render() &#123; return ( &lt;Form &gt; &lt;Input v_model=\"name\"&gt;&lt;/Input&gt; &lt;Input v_model=\"pwd\"&gt;&lt;/Input&gt; &lt;/Form&gt; ) &#125;&#125; è¡¨å•æ ¡éªŒåŸºäºä¸Šé¢çš„åŒå‘ç»‘å®šçš„ä¾‹å­ï¼Œæˆ‘ä»¬å†æ¥ä¸€ä¸ªè¡¨å•éªŒè¯å™¨ï¼Œè¡¨å•éªŒè¯å™¨å¯ä»¥åŒ…å«éªŒè¯å‡½æ•°ä»¥åŠæç¤ºä¿¡æ¯ï¼Œå½“éªŒè¯ä¸é€šè¿‡æ—¶ï¼Œå±•ç¤ºé”™è¯¯ä¿¡æ¯ï¼š 123456789101112131415161718192021222324function validateHoc(WrappedComponent) &#123; return class extends Component &#123; constructor(props) &#123; super(props); this.state = &#123; error: '' &#125; &#125; onChange = (event) =&gt; &#123; const &#123; validator &#125; = this.props; if (validator &amp;&amp; typeof validator.func === 'function') &#123; if (!validator.func(event.target.value)) &#123; this.setState(&#123; error: validator.msg &#125;) &#125; else &#123; this.setState(&#123; error: '' &#125;) &#125; &#125; &#125; render() &#123; return &lt;div&gt; &lt;WrappedComponent onChange=&#123;this.onChange&#125; &#123;...this.props&#125; /&gt; &lt;div&gt;&#123;this.state.error || ''&#125;&lt;/div&gt; &lt;/div&gt; &#125; &#125;&#125; 12345678910const validatorName = &#123; func: (val) =&gt; val &amp;&amp; !isNaN(val), msg: 'è¯·è¾“å…¥æ•°å­—'&#125;const validatorPwd = &#123; func: (val) =&gt; val &amp;&amp; val.length &gt; 6, msg: 'å¯†ç å¿…é¡»å¤§äº6ä½'&#125;&lt;HOCInput validator=&#123;validatorName&#125; v_model=\"name\"&gt;&lt;/HOCInput&gt;&lt;HOCInput validator=&#123;validatorPwd&#125; v_model=\"pwd\"&gt;&lt;/HOCInput&gt; å½“ç„¶ï¼Œè¿˜å¯ä»¥åœ¨Formæäº¤çš„æ—¶å€™åˆ¤æ–­æ‰€æœ‰éªŒè¯å™¨æ˜¯å¦é€šè¿‡ï¼ŒéªŒè¯å™¨ä¹Ÿå¯ä»¥è®¾ç½®ä¸ºæ•°ç»„ç­‰ç­‰ï¼Œç”±äºæ–‡ç« ç¯‡å¹…åŸå› ï¼Œä»£ç è¢«ç®€åŒ–äº†å¾ˆå¤šï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥è‡ªå·±å®ç°ã€‚ Reduxçš„connect reduxä¸­çš„connectï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªHOCï¼Œä¸‹é¢å°±æ˜¯ä¸€ä¸ªç®€åŒ–ç‰ˆçš„connectå®ç°ï¼š 1234567891011121314151617181920212223242526272829303132333435363738export const connect = (mapStateToProps, mapDispatchToProps) =&gt; (WrappedComponent) =&gt; &#123; class Connect extends Component &#123; static contextTypes = &#123; store: PropTypes.object &#125; constructor () &#123; super() this.state = &#123; allProps: &#123;&#125; &#125; &#125; componentWillMount () &#123; const &#123; store &#125; = this.context this._updateProps() store.subscribe(() =&gt; this._updateProps()) &#125; _updateProps () &#123; const &#123; store &#125; = this.context let stateProps = mapStateToProps ? mapStateToProps(store.getState(), this.props): &#123;&#125; let dispatchProps = mapDispatchToProps? mapDispatchToProps(store.dispatch, this.props) : &#123;&#125; this.setState(&#123; allProps: &#123; ...stateProps, ...dispatchProps, ...this.props &#125; &#125;) &#125; render () &#123; return &lt;WrappedComponent &#123;...this.state.allProps&#125; /&gt; &#125; &#125; return Connect&#125; ä»£ç éå¸¸æ¸…æ™°ï¼Œconnectå‡½æ•°å…¶å®å°±åšäº†ä¸€ä»¶äº‹ï¼Œå°†mapStateToPropså’ŒmapDispatchToPropsåˆ†åˆ«è§£æ„åä¼ ç»™åŸç»„ä»¶ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨åŸç»„ä»¶å†…å°±å¯ä»¥ç›´æ¥ç”¨propsè·å–stateä»¥åŠdispatchå‡½æ•°äº†ã€‚ ä½¿ç”¨HOCçš„æ³¨æ„äº‹é¡¹å‘Šè¯«â€”é™æ€å±æ€§æ‹·è´å½“æˆ‘ä»¬åº”ç”¨HOCå»å¢å¼ºå¦ä¸€ä¸ªç»„ä»¶æ—¶ï¼Œæˆ‘ä»¬å®é™…ä½¿ç”¨çš„ç»„ä»¶å·²ç»ä¸æ˜¯åŸç»„ä»¶äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‹¿ä¸åˆ°åŸç»„ä»¶çš„ä»»ä½•é™æ€å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨HOCçš„ç»“å°¾æ‰‹åŠ¨æ‹·è´ä»–ä»¬ï¼š 12345678910function proxyHOC(WrappedComponent) &#123; class HOCComponent extends Component &#123; render() &#123; return &lt;WrappedComponent &#123;...this.props&#125; /&gt;; &#125; &#125; HOCComponent.staticMethod = WrappedComponent.staticMethod; // ... return HOCComponent;&#125; å¦‚æœåŸç»„ä»¶æœ‰éå¸¸å¤šçš„é™æ€å±æ€§ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯éå¸¸ç—›è‹¦çš„ï¼Œè€Œä¸”ä½ éœ€è¦å»äº†è§£éœ€è¦å¢å¼ºçš„æ‰€æœ‰ç»„ä»¶çš„é™æ€å±æ€§æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨hoist-non-react-staticsæ¥å¸®åŠ©æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨å¸®æˆ‘ä»¬æ‹·è´æ‰€æœ‰éReactçš„é™æ€æ–¹æ³•ï¼Œä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š 12345678910import hoistNonReactStatic from 'hoist-non-react-statics';function proxyHOC(WrappedComponent) &#123; class HOCComponent extends Component &#123; render() &#123; return &lt;WrappedComponent &#123;...this.props&#125; /&gt;; &#125; &#125; hoistNonReactStatic(HOCComponent,WrappedComponent); return HOCComponent;&#125; å‘Šè¯«â€”ä¼ é€’refsä½¿ç”¨é«˜é˜¶ç»„ä»¶åï¼Œè·å–åˆ°çš„refå®é™…ä¸Šæ˜¯æœ€å¤–å±‚çš„å®¹å™¨ç»„ä»¶ï¼Œè€ŒéåŸç»„ä»¶ï¼Œä½†æ˜¯å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦ç”¨åˆ°åŸç»„ä»¶çš„refã€‚ é«˜é˜¶ç»„ä»¶å¹¶ä¸èƒ½åƒé€ä¼ propsé‚£æ ·å°†refsé€ä¼ ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªå›è°ƒå‡½æ•°æ¥å®Œæˆrefçš„ä¼ é€’ï¼š12345678910111213141516171819function hoc(WrappedComponent) &#123; return class extends Component &#123; getWrappedRef = () =&gt; this.wrappedRef; render() &#123; return &lt;WrappedComponent ref=&#123;ref =&gt; &#123; this.wrappedRef = ref &#125;&#125; &#123;...this.props&#125; /&gt;; &#125; &#125;&#125;@hocclass Input extends Component &#123; render() &#123; return &lt;input&gt;&lt;/input&gt; &#125;&#125;class App extends Component &#123; render() &#123; return ( &lt;Input ref=&#123;ref =&gt; &#123; this.inpitRef = ref.getWrappedRef() &#125;&#125; &gt;&lt;/Input&gt; ); &#125;&#125; React 16.3ç‰ˆæœ¬æä¾›äº†ä¸€ä¸ªforwardRef APIæ¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œrefsä¼ é€’ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨é«˜é˜¶ç»„ä»¶ä¸Šè·å–çš„refå°±æ˜¯åŸç»„ä»¶çš„refäº†ï¼Œè€Œä¸éœ€è¦å†æ‰‹åŠ¨ä¼ é€’ï¼Œå¦‚æœä½ çš„Reactç‰ˆæœ¬å¤§äº16.3ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼: 1234567891011function hoc(WrappedComponent) &#123; class HOC extends Component &#123; render() &#123; const &#123; forwardedRef, ...props &#125; = this.props; return &lt;WrappedComponent ref=&#123;forwardedRef&#125; &#123;...props&#125; /&gt;; &#125; &#125; return React.forwardRef((props, ref) =&gt; &#123; return &lt;HOC forwardedRef=&#123;ref&#125; &#123;...props&#125; /&gt;; &#125;);&#125; å‘Šè¯«â€”ä¸è¦åœ¨renderæ–¹æ³•å†…ä½¿ç”¨é«˜é˜¶ç»„ä»¶React Diffç®—æ³•çš„åŸåˆ™æ˜¯ï¼š ä½¿ç”¨ç»„ä»¶æ ‡è¯†ç¡®å®šæ˜¯å¸è½½è¿˜æ˜¯æ›´æ–°ç»„ä»¶ å¦‚æœç»„ä»¶çš„å’Œå‰ä¸€æ¬¡æ¸²æŸ“æ—¶æ ‡è¯†æ˜¯ç›¸åŒçš„ï¼Œé€’å½’æ›´æ–°å­ç»„ä»¶ å¦‚æœæ ‡è¯†ä¸åŒå¸è½½ç»„ä»¶é‡æ–°æŒ‚è½½æ–°ç»„ä»¶ æ¯æ¬¡è°ƒç”¨é«˜é˜¶ç»„ä»¶ç”Ÿæˆçš„éƒ½æ˜¯æ˜¯ä¸€ä¸ªå…¨æ–°çš„ç»„ä»¶ï¼Œç»„ä»¶çš„å”¯ä¸€æ ‡è¯†å“åº”çš„ä¹Ÿä¼šæ”¹å˜ï¼Œå¦‚æœåœ¨renderæ–¹æ³•è°ƒç”¨äº†é«˜é˜¶ç»„ä»¶ï¼Œè¿™ä¼šå¯¼è‡´ç»„ä»¶æ¯æ¬¡éƒ½ä¼šè¢«å¸è½½åé‡æ–°æŒ‚è½½ã€‚ çº¦å®š-ä¸è¦æ”¹å˜åŸå§‹ç»„ä»¶å®˜æ–¹æ–‡æ¡£å¯¹é«˜é˜¶ç»„ä»¶çš„è¯´æ˜ï¼š é«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªæ²¡æœ‰å‰¯ä½œç”¨çš„çº¯å‡½æ•°ã€‚ æˆ‘ä»¬å†æ¥çœ‹çœ‹çº¯å‡½æ•°çš„å®šä¹‰ï¼š å¦‚æœå‡½æ•°çš„è°ƒç”¨å‚æ•°ç›¸åŒï¼Œåˆ™æ°¸è¿œè¿”å›ç›¸åŒçš„ç»“æœã€‚å®ƒä¸ä¾èµ–äºç¨‹åºæ‰§è¡ŒæœŸé—´å‡½æ•°å¤–éƒ¨ä»»ä½•çŠ¶æ€æˆ–æ•°æ®çš„å˜åŒ–ï¼Œå¿…é¡»åªä¾èµ–äºå…¶è¾“å…¥å‚æ•°ã€‚è¯¥å‡½æ•°ä¸ä¼šäº§ç”Ÿä»»ä½•å¯è§‚å¯Ÿçš„å‰¯ä½œç”¨ï¼Œä¾‹å¦‚ç½‘ç»œè¯·æ±‚ï¼Œè¾“å…¥å’Œè¾“å‡ºè®¾å¤‡æˆ–æ•°æ®çªå˜ã€‚ å¦‚æœæˆ‘ä»¬åœ¨é«˜é˜¶ç»„ä»¶å¯¹åŸç»„ä»¶è¿›è¡Œäº†ä¿®æ”¹ï¼Œä¾‹å¦‚ä¸‹é¢çš„ä»£ç ï¼š 1InputComponent.prototype.componentWillReceiveProps = function(nextProps) &#123; ... &#125; è¿™æ ·å°±ç ´åäº†æˆ‘ä»¬å¯¹é«˜é˜¶ç»„ä»¶çš„çº¦å®šï¼ŒåŒæ—¶ä¹Ÿæ”¹å˜äº†ä½¿ç”¨é«˜é˜¶ç»„ä»¶çš„åˆè¡·ï¼šæˆ‘ä»¬ä½¿ç”¨é«˜é˜¶ç»„ä»¶æ˜¯ä¸ºäº†å¢å¼ºè€Œéæ”¹å˜åŸç»„ä»¶ã€‚ çº¦å®š-é€ä¼ ä¸ç›¸å…³çš„propsä½¿ç”¨é«˜é˜¶ç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä»£ç†æ‰€æœ‰çš„propsï¼Œä½†å¾€å¾€ç‰¹å®šçš„HOCåªä¼šç”¨åˆ°å…¶ä¸­çš„ä¸€ä¸ªæˆ–å‡ ä¸ªpropsã€‚æˆ‘ä»¬éœ€è¦æŠŠå…¶ä»–ä¸ç›¸å…³çš„propsé€ä¼ ç»™åŸç»„ä»¶ï¼Œå¦‚ä¸‹é¢çš„ä»£ç ï¼š 123456789function visible(WrappedComponent) &#123; return class extends Component &#123; render() &#123; const &#123; visible, ...props &#125; = this.props; if (visible === false) return null; return &lt;WrappedComponent &#123;...props&#125; /&gt;; &#125; &#125;&#125; æˆ‘ä»¬åªä½¿ç”¨visibleå±æ€§æ¥æ§åˆ¶ç»„ä»¶çš„æ˜¾ç¤ºå¯éšè—ï¼ŒæŠŠå…¶ä»–propsé€ä¼ ä¸‹å»ã€‚ çº¦å®š-displayNameåœ¨ä½¿ç”¨React Developer Toolsè¿›è¡Œè°ƒè¯•æ—¶ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨äº†HOCï¼Œè°ƒè¯•ç•Œé¢å¯èƒ½å˜å¾—éå¸¸éš¾ä»¥é˜…è¯»ï¼Œå¦‚ä¸‹é¢çš„ä»£ç ï¼š 123456789101112@visibleclass Show extends Component &#123; render() &#123; return &lt;h1&gt;æˆ‘æ˜¯ä¸€ä¸ªæ ‡ç­¾&lt;/h1&gt; &#125;&#125;@visibleclass Title extends Component &#123; render() &#123; return &lt;h1&gt;æˆ‘æ˜¯ä¸€ä¸ªæ ‡é¢˜&lt;/h1&gt; &#125;&#125; ä¸ºäº†æ–¹ä¾¿è°ƒè¯•ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨ä¸ºHOCæŒ‡å®šä¸€ä¸ªdisplayNameï¼Œå®˜æ–¹æ¨èä½¿ç”¨HOCName(WrappedComponentName)ï¼š 1static displayName = `Visible($&#123;WrappedComponent.displayName&#125;)` è¿™ä¸ªçº¦å®šå¸®åŠ©ç¡®ä¿é«˜é˜¶ç»„ä»¶æœ€å¤§ç¨‹åº¦çš„çµæ´»æ€§å’Œå¯é‡ç”¨æ€§ã€‚ ä½¿ç”¨HOCçš„åŠ¨æœºå›é¡¾ä¸‹ä¸Šæ–‡æåˆ°çš„ Mixin å¸¦æ¥çš„é£é™©ï¼š Mixin å¯èƒ½ä¼šç›¸äº’ä¾èµ–ï¼Œç›¸äº’è€¦åˆï¼Œä¸åˆ©äºä»£ç ç»´æŠ¤ ä¸åŒçš„Mixinä¸­çš„æ–¹æ³•å¯èƒ½ä¼šç›¸äº’å†²çª Mixinéå¸¸å¤šæ—¶ï¼Œç»„ä»¶æ˜¯å¯ä»¥æ„ŸçŸ¥åˆ°çš„ï¼Œç”šè‡³è¿˜è¦ä¸ºå…¶åšç›¸å…³å¤„ç†ï¼Œè¿™æ ·ä¼šç»™ä»£ç é€ æˆæ»šé›ªçƒå¼çš„å¤æ‚æ€§ è€ŒHOCçš„å‡ºç°å¯ä»¥è§£å†³è¿™äº›é—®é¢˜ï¼š é«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªæ²¡æœ‰å‰¯ä½œç”¨çš„çº¯å‡½æ•°ï¼Œå„ä¸ªé«˜é˜¶ç»„ä»¶ä¸ä¼šäº’ç›¸ä¾èµ–è€¦åˆ é«˜é˜¶ç»„ä»¶ä¹Ÿæœ‰å¯èƒ½é€ æˆå†²çªï¼Œä½†æˆ‘ä»¬å¯ä»¥åœ¨éµå®ˆçº¦å®šçš„æƒ…å†µä¸‹é¿å…è¿™äº›è¡Œä¸º é«˜é˜¶ç»„ä»¶å¹¶ä¸å…³å¿ƒæ•°æ®ä½¿ç”¨çš„æ–¹å¼å’ŒåŸå› ï¼Œè€Œè¢«åŒ…è£¹çš„ç»„ä»¶ä¹Ÿä¸å…³å¿ƒæ•°æ®æ¥è‡ªä½•å¤„ã€‚é«˜é˜¶ç»„ä»¶çš„å¢åŠ ä¸ä¼šä¸ºåŸç»„ä»¶å¢åŠ è´Ÿæ‹… HOCçš„ç¼ºé™· HOCéœ€è¦åœ¨åŸç»„ä»¶ä¸Šè¿›è¡ŒåŒ…è£¹æˆ–è€…åµŒå¥—ï¼Œå¦‚æœå¤§é‡ä½¿ç”¨HOCï¼Œå°†ä¼šäº§ç”Ÿéå¸¸å¤šçš„åµŒå¥—ï¼Œè¿™è®©è°ƒè¯•å˜å¾—éå¸¸å›°éš¾ã€‚ HOCå¯ä»¥åŠ«æŒpropsï¼Œåœ¨ä¸éµå®ˆçº¦å®šçš„æƒ…å†µä¸‹ä¹Ÿå¯èƒ½é€ æˆå†²çªã€‚ Hooks Hooksæ˜¯React v16.7.0-alphaä¸­åŠ å…¥çš„æ–°ç‰¹æ€§ã€‚å®ƒå¯ä»¥è®©ä½ åœ¨classä»¥å¤–ä½¿ç”¨stateå’Œå…¶ä»–Reactç‰¹æ€§ã€‚ ä½¿ç”¨Hooksï¼Œä½ å¯ä»¥åœ¨å°†å«æœ‰stateçš„é€»è¾‘ä»ç»„ä»¶ä¸­æŠ½è±¡å‡ºæ¥ï¼Œè¿™å°†å¯ä»¥è®©è¿™äº›é€»è¾‘å®¹æ˜“è¢«æµ‹è¯•ã€‚åŒæ—¶ï¼ŒHookså¯ä»¥å¸®åŠ©ä½ åœ¨ä¸é‡å†™ç»„ä»¶ç»“æ„çš„æƒ…å†µä¸‹å¤ç”¨è¿™äº›é€»è¾‘ã€‚æ‰€ä»¥ï¼Œå®ƒä¹Ÿå¯ä»¥ä½œä¸ºä¸€ç§å®ç°çŠ¶æ€é€»è¾‘å¤ç”¨çš„æ–¹æ¡ˆã€‚ é˜…è¯»ä¸‹é¢çš„ç« èŠ‚ä½¿ç”¨Hookçš„åŠ¨æœºä½ å¯ä»¥å‘ç°ï¼Œå®ƒå¯ä»¥åŒæ—¶è§£å†³Mixinå’ŒHOCå¸¦æ¥çš„é—®é¢˜ã€‚ å®˜æ–¹æä¾›çš„HooksState Hookæˆ‘ä»¬è¦ä½¿ç”¨classç»„ä»¶å®ç°ä¸€ä¸ªè®¡æ•°å™¨åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šè¿™æ ·å†™ï¼š 12345678910111213141516export default class Count extends Component &#123; constructor(props) &#123; super(props); this.state = &#123; count: 0 &#125; &#125; render() &#123; return ( &lt;div&gt; &lt;p&gt;You clicked &#123;this.state.count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; &#123; this.setState(&#123; count: this.state.count + 1 &#125;) &#125;&#125;&gt; Click me &lt;/button&gt; &lt;/div&gt; ) &#125;&#125; é€šè¿‡useStateï¼Œæˆ‘ä»¬ä½¿ç”¨å‡½æ•°å¼ç»„ä»¶ä¹Ÿèƒ½å®ç°è¿™æ ·çš„åŠŸèƒ½ï¼š 1234567891011export default function HookTest() &#123; const [count, setCount] = useState(0); return ( &lt;div&gt; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; &#123; setCount(count + 1); setNumber(number + 1); &#125;&#125;&gt; Click me &lt;/button&gt; &lt;/div&gt; );&#125; useStateæ˜¯ä¸€ä¸ªé’©å­ï¼Œä»–å¯ä»¥ä¸ºå‡½æ•°å¼ç»„ä»¶å¢åŠ ä¸€äº›çŠ¶æ€ï¼Œå¹¶ä¸”æä¾›æ”¹å˜è¿™äº›çŠ¶æ€çš„å‡½æ•°ï¼ŒåŒæ—¶å®ƒæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°ä½œä¸ºçŠ¶æ€çš„é»˜è®¤å€¼ã€‚ Effect Hook Effect Hook å¯ä»¥è®©ä½ åœ¨å‡½æ•°ç»„ä»¶ä¸­æ‰§è¡Œä¸€äº›å…·æœ‰ side effectï¼ˆå‰¯ä½œç”¨ï¼‰çš„æ“ä½œ å‚æ•° useEffectæ–¹æ³•æ¥æ”¶ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼š 1.å›è°ƒå‡½æ•°ï¼šåœ¨ç¬¬ç»„ä»¶ä¸€æ¬¡renderå’Œä¹‹åçš„æ¯æ¬¡updateåè¿è¡Œï¼ŒReactä¿è¯åœ¨DOMå·²ç»æ›´æ–°å®Œæˆä¹‹åæ‰ä¼šè¿è¡Œå›è°ƒã€‚ 2.çŠ¶æ€ä¾èµ–(æ•°ç»„)ï¼šå½“é…ç½®äº†çŠ¶æ€ä¾èµ–é¡¹åï¼Œåªæœ‰æ£€æµ‹åˆ°é…ç½®çš„çŠ¶æ€å˜åŒ–æ—¶ï¼Œæ‰ä¼šè°ƒç”¨å›è°ƒå‡½æ•°ã€‚ 123456useEffect(() =&gt; &#123; // åªè¦ç»„ä»¶renderåå°±ä¼šæ‰§è¡Œ&#125;);useEffect(() =&gt; &#123; // åªæœ‰countæ”¹å˜æ—¶æ‰ä¼šæ‰§è¡Œ&#125;,[count]); å›è°ƒè¿”å›å€¼ useEffectçš„ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå½“é¡µé¢æ¸²æŸ“äº†ä¸‹ä¸€æ¬¡æ›´æ–°çš„ç»“æœåï¼Œæ‰§è¡Œä¸‹ä¸€æ¬¡useEffectä¹‹å‰ï¼Œä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å¸¸å¸¸ç”¨æ¥å¯¹ä¸Šä¸€æ¬¡è°ƒç”¨useEffectè¿›è¡Œæ¸…ç†ã€‚ 1234567891011121314151617export default function HookTest() &#123; const [count, setCount] = useState(0); useEffect(() =&gt; &#123; console.log('æ‰§è¡Œ...', count); return () =&gt; &#123; console.log('æ¸…ç†...', count); &#125; &#125;, [count]); return ( &lt;div&gt; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; &#123; setCount(count + 1); setNumber(number + 1); &#125;&#125;&gt; Click me &lt;/button&gt; &lt;/div&gt; );&#125; æ‰§è¡Œä¸Šé¢çš„ä»£ç ï¼Œå¹¶ç‚¹å‡»å‡ æ¬¡æŒ‰é’®ï¼Œä¼šå¾—åˆ°ä¸‹é¢çš„ç»“æœï¼š æ³¨æ„ï¼Œå¦‚æœåŠ ä¸Šæµè§ˆå™¨æ¸²æŸ“çš„æƒ…å†µï¼Œç»“æœåº”è¯¥æ˜¯è¿™æ ·çš„ï¼š 1234567891011é¡µé¢æ¸²æŸ“...1æ‰§è¡Œ... 1é¡µé¢æ¸²æŸ“...2æ¸…ç†... 1æ‰§è¡Œ... 2é¡µé¢æ¸²æŸ“...3æ¸…ç†... 2æ‰§è¡Œ... 3é¡µé¢æ¸²æŸ“...4æ¸…ç†... 3æ‰§è¡Œ... 4 é‚£ä¹ˆä¸ºä»€ä¹ˆåœ¨æµè§ˆå™¨æ¸²æŸ“å®Œåï¼Œå†æ‰§è¡Œæ¸…ç†çš„æ–¹æ³•è¿˜èƒ½æ‰¾åˆ°ä¸Šæ¬¡çš„stateå‘¢ï¼ŸåŸå› å¾ˆç®€å•ï¼Œæˆ‘ä»¬åœ¨useEffectä¸­è¿”å›çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿™å½¢æˆäº†ä¸€ä¸ªé—­åŒ…ï¼Œè¿™èƒ½ä¿è¯æˆ‘ä»¬ä¸Šä¸€æ¬¡æ‰§è¡Œå‡½æ•°å­˜å‚¨çš„å˜é‡ä¸è¢«é”€æ¯å’Œæ±¡æŸ“ã€‚ ä½ å¯ä»¥å°è¯•ä¸‹é¢çš„ä»£ç å¯èƒ½æ›´å¥½ç†è§£ 12345678910111213141516171819202122var flag = 1;var clean;function effect(flag) &#123; return function () &#123; console.log(flag); &#125;&#125;clean = effect(flag);flag = 2;clean();clean = effect(flag);flag = 3;clean();clean = effect(flag);// æ‰§è¡Œç»“æœeffect... 1clean... 1effect... 2clean... 2effect... 3 æ¨¡æ‹ŸcomponentDidMount componentDidMountç­‰ä»·äºuseEffectçš„å›è°ƒä»…åœ¨é¡µé¢åˆå§‹åŒ–å®Œæˆåæ‰§è¡Œä¸€æ¬¡ï¼Œå½“useEffectçš„ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ä¸€ä¸ªç©ºæ•°ç»„æ—¶å¯ä»¥å®ç°è¿™ä¸ªæ•ˆæœã€‚ 123function useDidMount(callback) &#123; useEffect(callback, []);&#125; å®˜æ–¹ä¸æ¨èä¸Šé¢è¿™ç§å†™æ³•ï¼Œå› ä¸ºè¿™æœ‰å¯èƒ½å¯¼è‡´ä¸€äº›é”™è¯¯ã€‚ æ¨¡æ‹ŸcomponentWillUnmount 123function useUnMount(callback) &#123; useEffect(() =&gt; callback, []);&#125; ä¸åƒ componentDidMount æˆ–è€… componentDidUpdateï¼ŒuseEffect ä¸­ä½¿ç”¨çš„ effect å¹¶ä¸ä¼šé˜»æ»æµè§ˆå™¨æ¸²æŸ“é¡µé¢ã€‚è¿™è®©ä½ çš„ app çœ‹èµ·æ¥æ›´åŠ æµç•…ã€‚ ref Hookä½¿ç”¨useRef Hookï¼Œä½ å¯ä»¥è½»æ¾çš„è·å–åˆ°domçš„refã€‚ 123456789101112export default function Input() &#123; const inputEl = useRef(null); const onButtonClick = () =&gt; &#123; inputEl.current.focus(); &#125;; return ( &lt;div&gt; &lt;input ref=&#123;inputEl&#125; type=\"text\" /&gt; &lt;button onClick=&#123;onButtonClick&#125;&gt;Focus the input&lt;/button&gt; &lt;/div&gt; );&#125; æ³¨æ„useRef()å¹¶ä¸ä»…ä»…å¯ä»¥ç”¨æ¥å½“ä½œè·å–refä½¿ç”¨ï¼Œä½¿ç”¨useRefäº§ç”Ÿçš„refçš„currentå±æ€§æ˜¯å¯å˜çš„ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨å®ƒæ¥ä¿å­˜ä¸€ä¸ªä»»æ„å€¼ã€‚ æ¨¡æ‹ŸcomponentDidUpdate componentDidUpdateå°±ç›¸å½“äºé™¤å»ç¬¬ä¸€æ¬¡è°ƒç”¨çš„useEffectï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©useRefç”Ÿæˆä¸€ä¸ªæ ‡è¯†ï¼Œæ¥è®°å½•æ˜¯å¦ä¸ºç¬¬ä¸€æ¬¡æ‰§è¡Œï¼š 12345678910function useDidUpdate(callback, prop) &#123; const init = useRef(true); useEffect(() =&gt; &#123; if (init.current) &#123; init.current = false; &#125; else &#123; return callback(); &#125; &#125;, prop);&#125; ä½¿ç”¨Hookçš„æ³¨æ„äº‹é¡¹ä½¿ç”¨èŒƒå›´ åªèƒ½åœ¨Reactå‡½æ•°å¼ç»„ä»¶æˆ–è‡ªå®šä¹‰Hookä¸­ä½¿ç”¨Hookã€‚ Hookçš„æå‡ºä¸»è¦å°±æ˜¯ä¸ºäº†è§£å†³classç»„ä»¶çš„ä¸€ç³»åˆ—é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬èƒ½åœ¨classç»„ä»¶ä¸­ä½¿ç”¨å®ƒã€‚ å£°æ˜çº¦æŸ ä¸è¦åœ¨å¾ªç¯ï¼Œæ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨Hookã€‚ Hooké€šè¿‡æ•°ç»„å®ç°çš„ï¼Œæ¯æ¬¡useState éƒ½ä¼šæ”¹å˜ä¸‹æ ‡ï¼ŒReactéœ€è¦åˆ©ç”¨è°ƒç”¨é¡ºåºæ¥æ­£ç¡®æ›´æ–°ç›¸åº”çš„çŠ¶æ€ï¼Œå¦‚æœuseState è¢«åŒ…è£¹å¾ªç¯æˆ–æ¡ä»¶è¯­å¥ä¸­ï¼Œé‚£æ¯å°±å¯èƒ½ä¼šå¼•èµ·è°ƒç”¨é¡ºåºçš„é”™ä¹±ï¼Œä»è€Œé€ æˆæ„æƒ³ä¸åˆ°çš„é”™è¯¯ã€‚ æˆ‘ä»¬å¯ä»¥å®‰è£…ä¸€ä¸ªeslintæ’ä»¶æ¥å¸®åŠ©æˆ‘ä»¬é¿å…è¿™äº›é—®é¢˜ã€‚12345678910111213// å®‰è£…npm install eslint-plugin-react-hooks --save-dev// é…ç½®&#123; \"plugins\": [ // ... \"react-hooks\" ], \"rules\": &#123; // ... \"react-hooks/rules-of-hooks\": \"error\" &#125;&#125; è‡ªå®šä¹‰Hookåƒä¸Šé¢ä»‹ç»çš„HOCå’Œmixinä¸€æ ·ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥é€šè¿‡è‡ªå®šä¹‰çš„Hookå°†ç»„ä»¶ä¸­ç±»ä¼¼çš„çŠ¶æ€é€»è¾‘æŠ½å–å‡ºæ¥ã€‚ è‡ªå®šä¹‰Hookéå¸¸ç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”æŠŠç›¸åº”éœ€è¦çš„çŠ¶æ€å’Œeffectå°è£…è¿›å»ï¼ŒåŒæ—¶ï¼ŒHookä¹‹é—´ä¹Ÿæ˜¯å¯ä»¥ç›¸äº’å¼•ç”¨çš„ã€‚ä½¿ç”¨useå¼€å¤´å‘½åè‡ªå®šä¹‰Hookï¼Œè¿™æ ·å¯ä»¥æ–¹ä¾¿eslintè¿›è¡Œæ£€æŸ¥ã€‚ ä¸‹é¢æˆ‘ä»¬çœ‹å‡ ä¸ªå…·ä½“çš„Hookå°è£…ï¼š æ—¥å¿—æ‰“ç‚¹æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸Šé¢å°è£…çš„ç”Ÿå‘½å‘¨æœŸHookã€‚ 12345678910111213141516const useLogger = (componentName, ...params) =&gt; &#123; useDidMount(() =&gt; &#123; console.log(`$&#123;componentName&#125;åˆå§‹åŒ–`, ...params); &#125;); useUnMount(() =&gt; &#123; console.log(`$&#123;componentName&#125;å¸è½½`, ...params); &#125;) useDidUpdate(() =&gt; &#123; console.log(`$&#123;componentName&#125;æ›´æ–°`, ...params); &#125;);&#125;;function Page1(props)&#123; useLogger('Page1',props); return (&lt;div&gt;...&lt;/div&gt;)&#125; ä¿®æ”¹titleæ ¹æ®ä¸åŒçš„é¡µé¢åç§°ä¿®æ”¹é¡µé¢title: 12345678910111213function useTitle(title) &#123; useEffect( () =&gt; &#123; document.title = title; return () =&gt; (document.title = \"ä¸»é¡µ\"); &#125;, [title] );&#125;function Page1(props)&#123; useTitle('Page1'); return (&lt;div&gt;...&lt;/div&gt;)&#125; åŒå‘ç»‘å®šæˆ‘ä»¬å°†è¡¨å•onChangeçš„é€»è¾‘æŠ½å–å‡ºæ¥å°è£…æˆä¸€ä¸ªHookï¼Œè¿™æ ·æ‰€æœ‰éœ€è¦è¿›è¡ŒåŒå‘ç»‘å®šçš„è¡¨å•ç»„ä»¶éƒ½å¯ä»¥è¿›è¡Œå¤ç”¨ï¼š1234567891011121314function useBind(init) &#123; let [value, setValue] = useState(init); let onChange = useCallback(function(event) &#123; setValue(event.currentTarget.value); &#125;, []); return &#123; value, onChange &#125;;&#125;function Page1(props)&#123; let value = useBind(''); return &lt;input &#123;...value&#125; /&gt;;&#125; å½“ç„¶ï¼Œä½ å¯ä»¥å‘ä¸Šé¢çš„HOCé‚£æ ·ï¼Œç»“åˆcontextå’Œformæ¥å°è£…ä¸€ä¸ªæ›´é€šç”¨çš„åŒå‘ç»‘å®šï¼Œæœ‰å…´è¶£å¯ä»¥æ‰‹åŠ¨å®ç°ä¸€ä¸‹ã€‚ ä½¿ç”¨Hookçš„åŠ¨æœºå‡å°‘çŠ¶æ€é€»è¾‘å¤ç”¨çš„é£é™©Hookå’ŒMixinåœ¨ç”¨æ³•ä¸Šæœ‰ä¸€å®šçš„ç›¸ä¼¼ä¹‹å¤„ï¼Œä½†æ˜¯Mixinå¼•å…¥çš„é€»è¾‘å’ŒçŠ¶æ€æ˜¯å¯ä»¥ç›¸äº’è¦†ç›–çš„ï¼Œè€Œå¤šä¸ªHookä¹‹é—´äº’ä¸å½±å“ï¼Œè¿™è®©æˆ‘ä»¬ä¸éœ€è¦åœ¨æŠŠä¸€éƒ¨åˆ†ç²¾åŠ›æ”¾åœ¨é˜²æ­¢é¿å…é€»è¾‘å¤ç”¨çš„å†²çªä¸Šã€‚ åœ¨ä¸éµå®ˆçº¦å®šçš„æƒ…å†µä¸‹ä½¿ç”¨HOCä¹Ÿæœ‰å¯èƒ½å¸¦æ¥ä¸€å®šå†²çªï¼Œæ¯”å¦‚propsè¦†ç›–ç­‰ç­‰ï¼Œä½¿ç”¨Hookåˆ™å¯ä»¥é¿å…è¿™äº›é—®é¢˜ã€‚ é¿å…åœ°ç‹±å¼åµŒå¥—å¤§é‡ä½¿ç”¨HOCçš„æƒ…å†µä¸‹è®©æˆ‘ä»¬çš„ä»£ç å˜å¾—åµŒå¥—å±‚çº§éå¸¸æ·±ï¼Œä½¿ç”¨HOCï¼Œæˆ‘ä»¬å¯ä»¥å®ç°æ‰å¹³å¼çš„çŠ¶æ€é€»è¾‘å¤ç”¨ï¼Œè€Œé¿å…äº†å¤§é‡çš„ç»„ä»¶åµŒå¥—ã€‚ è®©ç»„ä»¶æ›´å®¹æ˜“ç†è§£åœ¨ä½¿ç”¨classç»„ä»¶æ„å»ºæˆ‘ä»¬çš„ç¨‹åºæ—¶ï¼Œä»–ä»¬å„è‡ªæ‹¥æœ‰è‡ªå·±çš„çŠ¶æ€ï¼Œä¸šåŠ¡é€»è¾‘çš„å¤æ‚ä½¿è¿™äº›ç»„ä»¶å˜å¾—è¶Šæ¥è¶Šåºå¤§ï¼Œå„ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ä¼šè°ƒç”¨è¶Šæ¥è¶Šå¤šçš„é€»è¾‘ï¼Œè¶Šæ¥è¶Šéš¾ä»¥ç»´æŠ¤ã€‚ä½¿ç”¨Hookï¼Œå¯ä»¥è®©ä½ æ›´å¤§é™åº¦çš„å°†å…¬ç”¨é€»è¾‘æŠ½ç¦»ï¼Œå°†ä¸€ä¸ªç»„ä»¶åˆ†å‰²æˆæ›´å°çš„å‡½æ•°ï¼Œè€Œä¸æ˜¯å¼ºåˆ¶åŸºäºç”Ÿå‘½å‘¨æœŸæ–¹æ³•è¿›è¡Œåˆ†å‰²ã€‚ ä½¿ç”¨å‡½æ•°ä»£æ›¿classç›¸æ¯”å‡½æ•°ï¼Œç¼–å†™ä¸€ä¸ªclasså¯èƒ½éœ€è¦æŒæ¡æ›´å¤šçš„çŸ¥è¯†ï¼Œéœ€è¦æ³¨æ„çš„ç‚¹ä¹Ÿè¶Šå¤šï¼Œæ¯”å¦‚thisæŒ‡å‘ã€ç»‘å®šäº‹ä»¶ç­‰ç­‰ã€‚å¦å¤–ï¼Œè®¡ç®—æœºç†è§£ä¸€ä¸ªclassæ¯”ç†è§£ä¸€ä¸ªå‡½æ•°æ›´å¿«ã€‚Hooksè®©ä½ å¯ä»¥åœ¨classesä¹‹å¤–ä½¿ç”¨æ›´å¤šReactçš„æ–°ç‰¹æ€§ã€‚ ç†æ€§çš„é€‰æ‹©å®é™…ä¸Šï¼ŒHookåœ¨react 16.8.0æ‰æ­£å¼å‘å¸ƒHookç¨³å®šç‰ˆæœ¬ï¼Œç¬”è€…ä¹Ÿè¿˜æœªåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œç›®å‰ç¬”è€…åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨çš„æœ€å¤šçš„æ˜¯HOCã€‚ Reactå®˜æ–¹å®Œå…¨æ²¡æœ‰æŠŠclassesä»Reactä¸­ç§»é™¤çš„æ‰“ç®—ï¼Œclassç»„ä»¶å’ŒHookå®Œå…¨å¯ä»¥åŒæ—¶å­˜åœ¨ï¼Œå®˜æ–¹ä¹Ÿå»ºè®®é¿å…ä»»ä½•â€œå¤§èŒƒå›´é‡æ„â€ï¼Œæ¯•ç«Ÿè¿™æ˜¯ä¸€ä¸ªéå¸¸æ–°çš„ç‰ˆæœ¬ï¼Œå¦‚æœä½ å–œæ¬¢å®ƒï¼Œå¯ä»¥åœ¨æ–°çš„éå…³é”®æ€§çš„ä»£ç ä¸­ä½¿ç”¨Hookã€‚ å°ç»“mixinå·²è¢«æŠ›å¼ƒï¼ŒHOCæ­£å½“å£®å¹´ï¼ŒHookåˆéœ²é”‹èŠ’ï¼Œå‰ç«¯åœˆå°±æ˜¯è¿™æ ·ï¼ŒæŠ€æœ¯è¿­ä»£é€Ÿåº¦éå¸¸ä¹‹å¿«ï¼Œä½†æˆ‘ä»¬åœ¨å­¦ä¹ è¿™äº›çŸ¥è¯†ä¹‹æ—¶ä¸€å®šè¦æ˜ç™½ä¸ºä»€ä¹ˆè¦å­¦ï¼Œå­¦äº†æœ‰æ²¡æœ‰ç”¨ï¼Œè¦ä¸è¦ç”¨ã€‚ä¸å¿˜åˆå¿ƒï¼Œæ–¹å¾—å§‹ç»ˆã€‚ æ–‡ä¸­å¦‚æœ‰é”™è¯¯ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºæŒ‡æ­£ï¼Œè°¢è°¢é˜…è¯»ã€‚","categories":[],"tags":[{"name":"React","slug":"React","permalink":"https://www.lisq.xyz/tags/React/"}]},{"title":"å…¨é¢åˆ†æå‰ç«¯çš„ç½‘ç»œè¯·æ±‚æ–¹å¼","slug":"ã€æµè§ˆå™¨å’Œç½‘ç»œã€‘å…¨é¢åˆ†æå‰ç«¯çš„ç½‘ç»œè¯·æ±‚æ–¹å¼","date":"2019-03-28T12:38:59.000Z","updated":"2019-04-06T05:14:21.095Z","comments":true,"path":"2019/03/28/ã€æµè§ˆå™¨å’Œç½‘ç»œã€‘å…¨é¢åˆ†æå‰ç«¯çš„ç½‘ç»œè¯·æ±‚æ–¹å¼/","link":"","permalink":"https://www.lisq.xyz/2019/03/28/ã€æµè§ˆå™¨å’Œç½‘ç»œã€‘å…¨é¢åˆ†æå‰ç«¯çš„ç½‘ç»œè¯·æ±‚æ–¹å¼/","excerpt":"","text":"ä¸€ã€å‰ç«¯è¿›è¡Œç½‘ç»œè¯·æ±‚çš„å…³æ³¨ç‚¹å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåœ¨å‰ç«¯å‘èµ·ä¸€ä¸ªç½‘ç»œè¯·æ±‚æˆ‘ä»¬åªéœ€å…³æ³¨ä¸‹é¢å‡ ç‚¹ï¼š ä¼ å…¥åŸºæœ¬å‚æ•°ï¼ˆurlï¼Œè¯·æ±‚æ–¹å¼ï¼‰ è¯·æ±‚å‚æ•°ã€è¯·æ±‚å‚æ•°ç±»å‹ è®¾ç½®è¯·æ±‚å¤´ è·å–å“åº”çš„æ–¹å¼ è·å–å“åº”å¤´ã€å“åº”çŠ¶æ€ã€å“åº”ç»“æœ å¼‚å¸¸å¤„ç† æºå¸¦cookieè®¾ç½® è·¨åŸŸè¯·æ±‚ äºŒã€å‰ç«¯è¿›è¡Œç½‘ç»œè¯·æ±‚çš„æ–¹å¼ formè¡¨å•ã€ifreamã€åˆ·æ–°é¡µé¢ Ajax - å¼‚æ­¥ç½‘ç»œè¯·æ±‚çš„å¼€å±±é¼»ç¥– jQuery - ä¸€ä¸ªæ—¶ä»£ fetch - Ajaxçš„æ›¿ä»£è€… axiosã€requestç­‰ä¼—å¤šå¼€æºåº“ ä¸‰ã€å…³äºç½‘ç»œè¯·æ±‚çš„ç–‘é—® Ajaxçš„å‡ºç°è§£å†³äº†ä»€ä¹ˆé—®é¢˜ åŸç”ŸAjaxå¦‚ä½•ä½¿ç”¨ jQueryçš„ç½‘ç»œè¯·æ±‚æ–¹å¼ fetchçš„ç”¨æ³•ä»¥åŠå‘ç‚¹ å¦‚ä½•æ­£ç¡®çš„ä½¿ç”¨fetch å¦‚ä½•é€‰æ‹©åˆé€‚çš„è·¨åŸŸæ–¹å¼ å¸¦ç€ä»¥ä¸Šè¿™äº›é—®é¢˜ã€å…³æ³¨ç‚¹æˆ‘ä»¬å¯¹å‡ ç§ç½‘ç»œè¯·æ±‚è¿›è¡Œä¸€æ¬¡å…¨é¢çš„åˆ†æã€‚ å››ã€Ajaxçš„å‡ºç°è§£å†³äº†ä»€ä¹ˆé—®é¢˜åœ¨Ajaxå‡ºç°ä¹‹å‰ï¼Œwebç¨‹åºæ˜¯è¿™æ ·å·¥ä½œçš„ï¼š è¿™ç§äº¤äº’çš„çš„ç¼ºé™·æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œä»»ä½•å’ŒæœåŠ¡å™¨çš„äº¤äº’éƒ½éœ€è¦åˆ·æ–°é¡µé¢ï¼Œç”¨æˆ·ä½“éªŒéå¸¸å·®ï¼ŒAjaxçš„å‡ºç°è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚Ajaxå…¨ç§°Asynchronous JavaScript + XMLï¼ˆå¼‚æ­¥JavaScriptå’ŒXMLï¼‰ ä½¿ç”¨Ajaxï¼Œç½‘é¡µåº”ç”¨èƒ½å¤Ÿå¿«é€Ÿåœ°å°†å¢é‡æ›´æ–°å‘ˆç°åœ¨ç”¨æˆ·ç•Œé¢ä¸Šï¼Œè€Œä¸éœ€è¦é‡è½½ï¼ˆåˆ·æ–°ï¼‰æ•´ä¸ªé¡µé¢ã€‚ Ajaxæœ¬èº«ä¸æ˜¯ä¸€ç§æ–°æŠ€æœ¯ï¼Œè€Œæ˜¯ç”¨æ¥æè¿°ä¸€ç§ä½¿ç”¨ç°æœ‰æŠ€æœ¯é›†åˆå®ç°çš„ä¸€ä¸ªæŠ€æœ¯æ–¹æ¡ˆï¼Œæµè§ˆå™¨çš„XMLHttpRequestæ˜¯å®ç°Ajaxæœ€é‡è¦çš„å¯¹è±¡ï¼ˆIE6ä»¥ä¸‹ä½¿ç”¨ActiveXObjectï¼‰ã€‚ å°½ç®¡Xåœ¨Ajaxä¸­ä»£è¡¨XML, ä½†ç”±äºJSONçš„è®¸å¤šä¼˜åŠ¿ï¼Œæ¯”å¦‚æ›´åŠ è½»é‡ä»¥åŠä½œä¸ºJavascriptçš„ä¸€éƒ¨åˆ†ï¼Œç›®å‰JSONçš„ä½¿ç”¨æ¯”XMLæ›´åŠ æ™®éã€‚ äº”ã€åŸç”ŸAjaxçš„ç”¨æ³•è¿™é‡Œä¸»è¦åˆ†æXMLHttpRequestå¯¹è±¡ï¼Œä¸‹é¢æ˜¯å®ƒçš„ä¸€æ®µåŸºç¡€ä½¿ç”¨ï¼š 1234567891011121314151617181920212223242526272829var xhr = new XMLHttpRequest();xhr.open('post','www.xxx.com',true)// æ¥æ”¶è¿”å›å€¼xhr.onreadystatechange = function()&#123; if(xhr.readyState === 4 )&#123; if(xhr.status &gt;= 200 &amp;&amp; xhr.status &lt; 300) || xhr.status == 304)&#123; console.log(xhr.responseText); &#125; &#125;&#125;// å¤„ç†è¯·æ±‚å‚æ•°postData = &#123;\"name1\":\"value1\",\"name2\":\"value2\"&#125;;postData = (function(value)&#123;var dataString = \"\";for(var key in value)&#123; dataString += key+\"=\"+value[key]+\"&amp;\";&#125;; return dataString;&#125;(postData));// è®¾ç½®è¯·æ±‚å¤´xhr.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\");// å¼‚å¸¸å¤„ç†xhr.onerror = function() &#123; console.log('Network request failed')&#125;// è·¨åŸŸæºå¸¦cookiexhr.withCredentials = true;// å‘å‡ºè¯·æ±‚xhr.send(postData); ä¸‹é¢åˆ†åˆ«å¯¹XMLHttpRequestå¯¹è±¡å¸¸ç”¨çš„çš„å‡½æ•°ã€å±æ€§ã€äº‹ä»¶è¿›è¡Œåˆ†æã€‚ å‡½æ•°open ç”¨äºåˆå§‹åŒ–ä¸€ä¸ªè¯·æ±‚ï¼Œç”¨æ³•ï¼š 1xhr.open(method, url, async); methodï¼šè¯·æ±‚æ–¹å¼ï¼Œå¦‚getã€post urlï¼šè¯·æ±‚çš„url asyncï¼šæ˜¯å¦ä¸ºå¼‚æ­¥è¯·æ±‚ send ç”¨äºå‘é€HTTPè¯·æ±‚ï¼Œå³è°ƒç”¨è¯¥æ–¹æ³•åHTTPè¯·æ±‚æ‰ä¼šè¢«çœŸæ­£å‘å‡ºï¼Œç”¨æ³•ï¼š 1xhr.send(param) paramï¼šhttpè¯·æ±‚çš„å‚æ•°ï¼Œå¯ä»¥ä¸ºstringã€Blobç­‰ç±»å‹ã€‚ abort ç”¨äºç»ˆæ­¢ä¸€ä¸ªajaxè¯·æ±‚ï¼Œè°ƒç”¨æ­¤æ–¹æ³•åreadyStateå°†è¢«è®¾ç½®ä¸º0ï¼Œç”¨æ³•ï¼š 1xhr.abort() setRequestHeader ç”¨äºè®¾ç½®HTTPè¯·æ±‚å¤´ï¼Œæ­¤æ–¹æ³•å¿…é¡»åœ¨open()æ–¹æ³•å’Œsend()ä¹‹é—´è°ƒç”¨ï¼Œç”¨æ³•ï¼š 1xhr.setRequestHeader(header, value); getResponseHeader ç”¨äºè·å–httpè¿”å›å¤´ï¼Œå¦‚æœåœ¨è¿”å›å¤´ä¸­æœ‰å¤šä¸ªä¸€æ ·çš„åç§°ï¼Œé‚£ä¹ˆè¿”å›çš„å€¼å°±ä¼šæ˜¯ç”¨é€—å·å’Œç©ºæ ¼å°†å€¼åˆ†éš”çš„å­—ç¬¦ä¸²ï¼Œç”¨æ³•ï¼š 1var header = xhr.getResponseHeader(name); å±æ€§readyState ç”¨æ¥æ ‡è¯†å½“å‰XMLHttpRequestå¯¹è±¡æ‰€å¤„çš„çŠ¶æ€ï¼ŒXMLHttpRequestå¯¹è±¡æ€»æ˜¯ä½äºä¸‹åˆ—çŠ¶æ€ä¸­çš„ä¸€ä¸ªï¼š å€¼ çŠ¶æ€ æè¿° 0 UNSENT ä»£ç†è¢«åˆ›å»ºï¼Œä½†å°šæœªè°ƒç”¨ open() æ–¹æ³•ã€‚ 1 OPENED open() æ–¹æ³•å·²ç»è¢«è°ƒç”¨ã€‚ 2 HEADERS_RECEIVED send()æ–¹æ³•å·²ç»è¢«è°ƒç”¨ï¼Œå¹¶ä¸”å¤´éƒ¨å’ŒçŠ¶æ€å·²ç»å¯è·å¾—ã€‚ 3 LOADING ä¸‹è½½ä¸­ï¼› responseText å±æ€§å·²ç»åŒ…å«éƒ¨åˆ†æ•°æ®ã€‚ 4 DONE ä¸‹è½½æ“ä½œå·²å®Œæˆã€‚ status è¡¨ç¤ºhttpè¯·æ±‚çš„çŠ¶æ€, åˆå§‹å€¼ä¸º0ã€‚å¦‚æœæœåŠ¡å™¨æ²¡æœ‰æ˜¾å¼åœ°æŒ‡å®šçŠ¶æ€ç , é‚£ä¹ˆstatuså°†è¢«è®¾ç½®ä¸ºé»˜è®¤å€¼, å³200ã€‚ responseType è¡¨ç¤ºå“åº”çš„æ•°æ®ç±»å‹ï¼Œå¹¶å…è®¸æˆ‘ä»¬æ‰‹åŠ¨è®¾ç½®ï¼Œå¦‚æœä¸ºç©ºï¼Œé»˜è®¤ä¸ºtextç±»å‹ï¼Œå¯ä»¥æœ‰ä¸‹é¢çš„å–å€¼ï¼š å€¼ æè¿° &quot;&quot; å°† responseTypeè®¾ä¸ºç©ºå­—ç¬¦ä¸²ä¸è®¾ç½®ä¸º&quot;text&quot;ç›¸åŒï¼Œ æ˜¯é»˜è®¤ç±»å‹ ï¼ˆå®é™…ä¸Šæ˜¯ DOMStringï¼‰ã€‚ &quot;arraybuffer&quot; response æ˜¯ä¸€ä¸ªåŒ…å«äºŒè¿›åˆ¶æ•°æ®çš„JavaScript ArrayBuffer ã€‚ &quot;blob&quot; responseæ˜¯ä¸€ä¸ªåŒ…å«äºŒè¿›åˆ¶æ•°æ®çš„ Blob å¯¹è±¡ ã€‚ &quot;document&quot; response æ˜¯ä¸€ä¸ªHTML Documentæˆ–XML XMLDocumentï¼Œè¿™å–å†³äºæ¥æ”¶åˆ°çš„æ•°æ®çš„ MIME ç±»å‹ã€‚ &quot;json&quot; response æ˜¯ä¸€ä¸ª JavaScript å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡æ˜¯é€šè¿‡å°†æ¥æ”¶åˆ°çš„æ•°æ®ç±»å‹è§†ä¸ºJSONè§£æå¾—åˆ°çš„ã€‚ &quot;text&quot; responseæ˜¯åŒ…å«åœ¨DOMStringå¯¹è±¡ä¸­çš„æ–‡æœ¬ã€‚ response è¿”å›å“åº”çš„æ­£æ–‡ï¼Œè¿”å›çš„ç±»å‹ç”±ä¸Šé¢çš„responseTypeå†³å®šã€‚ withCredentials ajaxè¯·æ±‚é»˜è®¤ä¼šæºå¸¦åŒæºè¯·æ±‚çš„cookieï¼Œè€Œè·¨åŸŸè¯·æ±‚åˆ™ä¸ä¼šæºå¸¦cookieï¼Œè®¾ç½®xhrçš„withCredentialsçš„å±æ€§ä¸ºtrueå°†å…è®¸æºå¸¦è·¨åŸŸcookieã€‚ äº‹ä»¶å›è°ƒonreadystatechange 1xhr.onreadystatechange = callback; å½“readyStateå±æ€§å‘ç”Ÿå˜åŒ–æ—¶ï¼Œcallbackä¼šè¢«è§¦å‘ã€‚ onloadstart 1xhr.onloadstart = callback; åœ¨ajaxè¯·æ±‚å‘é€ä¹‹å‰ï¼ˆreadyState==1å, readyState==2å‰ï¼‰ï¼Œcallbackä¼šè¢«è§¦å‘ã€‚ onprogress 123xhr.onprogress = function(event)&#123; console.log(event.loaded / event.total);&#125; å›è°ƒå‡½æ•°å¯ä»¥è·å–èµ„æºæ€»å¤§å°totalï¼Œå·²ç»åŠ è½½çš„èµ„æºå¤§å°loadedï¼Œç”¨è¿™ä¸¤ä¸ªå€¼å¯ä»¥è®¡ç®—åŠ è½½è¿›åº¦ã€‚ onload 1xhr.onload = callback; å½“ä¸€ä¸ªèµ„æºåŠå…¶ä¾èµ–èµ„æºå·²å®ŒæˆåŠ è½½æ—¶ï¼Œå°†è§¦å‘callbackï¼Œé€šå¸¸æˆ‘ä»¬ä¼šåœ¨onloadäº‹ä»¶ä¸­å¤„ç†è¿”å›å€¼ã€‚ å¼‚å¸¸å¤„ç†onerror 1xhr.onerror = callback; å½“ajaxèµ„æºåŠ è½½å¤±è´¥æ—¶ä¼šè§¦å‘callbackã€‚ ontimeout 1xhr.ontimeout = callback; å½“è¿›åº¦ç”±äºé¢„å®šæ—¶é—´åˆ°æœŸè€Œç»ˆæ­¢æ—¶ï¼Œä¼šè§¦å‘callbackï¼Œè¶…æ—¶æ—¶é—´å¯ä½¿ç”¨timeoutå±æ€§è¿›è¡Œè®¾ç½®ã€‚ å…­ã€jQueryå¯¹Ajaxçš„å°è£…åœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´é‡Œï¼Œäººä»¬ä½¿ç”¨jQueryæä¾›çš„ajaxå°è£…è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼ŒåŒ…æ‹¬$.ajaxã€$.getã€$.postç­‰ï¼Œè¿™å‡ ä¸ªæ–¹æ³•æ”¾åˆ°ç°åœ¨ï¼Œæˆ‘ä¾ç„¶è§‰å¾—å¾ˆå®ç”¨ã€‚ 12345678910111213$.ajax(&#123; dataType: 'json', // è®¾ç½®è¿”å›å€¼ç±»å‹ contentType: 'application/json', // è®¾ç½®å‚æ•°ç±»å‹ headers: &#123;'Content-Type','application/json'&#125;,// è®¾ç½®è¯·æ±‚å¤´ xhrFields: &#123; withCredentials: true &#125;, // è·¨åŸŸæºå¸¦cookie data: JSON.stringify(&#123;a: [&#123;b:1, a:1&#125;]&#125;), // ä¼ é€’å‚æ•° error:function(xhr,status)&#123; // é”™è¯¯å¤„ç† console.log(xhr,status); &#125;, success: function (data,status) &#123; // è·å–ç»“æœ console.log(data,status); &#125;&#125;) $.ajaxåªæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°æ¥æ”¶ä¸€ç³»åˆ—é…ç½®ï¼Œå…¶è‡ªå·±å°è£…äº†ä¸€ä¸ªjqXHRå¯¹è±¡ï¼Œæœ‰å…´è¶£å¯ä»¥é˜…è¯»ä¸€ä¸‹jQuary-ajax æºç  å¸¸ç”¨é…ç½®ï¼š url å½“å‰é¡µåœ°å€ã€‚å‘é€è¯·æ±‚çš„åœ°å€ã€‚ type ç±»å‹ï¼šString è¯·æ±‚æ–¹å¼ (&quot;POST&quot; æˆ–&quot;GET&quot;)ï¼Œ é»˜è®¤ä¸º &quot;GET&quot;ã€‚æ³¨æ„ï¼šå…¶å®ƒHTTPè¯·æ±‚æ–¹æ³•ï¼Œå¦‚PUTå’Œ DELETEä¹Ÿå¯ä»¥ä½¿ç”¨ï¼Œä½†ä»…éƒ¨åˆ†æµè§ˆå™¨æ”¯æŒã€‚ timeout ç±»å‹ï¼šNumberè®¾ç½®è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ã€‚æ­¤è®¾ç½®å°†è¦†ç›–å…¨å±€è®¾ç½®ã€‚ success ç±»å‹ï¼šFunction è¯·æ±‚æˆåŠŸåçš„å›è°ƒå‡½æ•°ã€‚ jsonp åœ¨ä¸€ä¸ªjsonpè¯·æ±‚ä¸­é‡å†™å›è°ƒå‡½æ•°çš„åå­—ã€‚è¿™ä¸ªå€¼ç”¨æ¥æ›¿ä»£åœ¨&quot;callback=?&quot;è¿™ç§GETæˆ–POSTè¯·æ±‚ä¸­URLå‚æ•°é‡Œçš„&quot;callback&quot;éƒ¨åˆ†ã€‚ error ç±»å‹ï¼šFunction ã€‚è¯·æ±‚å¤±è´¥æ—¶è°ƒç”¨æ­¤å‡½æ•°ã€‚ æ³¨æ„ï¼šæºç é‡Œå¯¹é”™è¯¯çš„åˆ¤å®šï¼š 1isSuccess = status &gt;= 200 &amp;&amp; status &lt; 300 || status === 304; è¿”å›å€¼é™¤äº†è¿™å‡ ä¸ªçŠ¶æ€ç éƒ½ä¼šè¿›errorå›è°ƒã€‚ dataType 123456\"xml\": è¿”å› XML æ–‡æ¡£ï¼Œå¯ç”¨ jQuery å¤„ç†ã€‚\"html\": è¿”å›çº¯æ–‡æœ¬ HTML ä¿¡æ¯ï¼›åŒ…å«çš„ script æ ‡ç­¾ä¼šåœ¨æ’å…¥ dom æ—¶æ‰§è¡Œã€‚\"script\": è¿”å›çº¯æ–‡æœ¬ JavaScript ä»£ç ã€‚ä¸ä¼šè‡ªåŠ¨ç¼“å­˜ç»“æœã€‚é™¤éè®¾ç½®äº† \"cache\" å‚æ•°ã€‚æ³¨æ„ï¼šåœ¨è¿œç¨‹è¯·æ±‚æ—¶(ä¸åœ¨åŒä¸€ä¸ªåŸŸä¸‹)ï¼Œæ‰€æœ‰ POST è¯·æ±‚éƒ½å°†è½¬ä¸º GET è¯·æ±‚ã€‚ï¼ˆå› ä¸ºå°†ä½¿ç”¨ DOM çš„ scriptæ ‡ç­¾æ¥åŠ è½½ï¼‰\"json\": è¿”å› JSON æ•°æ® ã€‚\"jsonp\": JSONP æ ¼å¼ã€‚ä½¿ç”¨ JSONP å½¢å¼è°ƒç”¨å‡½æ•°æ—¶ï¼Œå¦‚ \"myurl?callback=?\" jQuery å°†è‡ªåŠ¨æ›¿æ¢ ? ä¸ºæ­£ç¡®çš„å‡½æ•°åï¼Œä»¥æ‰§è¡Œå›è°ƒå‡½æ•°ã€‚\"text\": è¿”å›çº¯æ–‡æœ¬å­—ç¬¦ä¸² data ç±»å‹ï¼šString ä½¿ç”¨JSON.stringifyè½¬ç  complete ç±»å‹ï¼šFunctionè¯·æ±‚å®Œæˆåå›è°ƒå‡½æ•° (è¯·æ±‚æˆåŠŸæˆ–å¤±è´¥ä¹‹åå‡è°ƒç”¨)ã€‚ async ç±»å‹ï¼šBoolean é»˜è®¤å€¼:trueã€‚é»˜è®¤è®¾ç½®ä¸‹ï¼Œæ‰€æœ‰è¯·æ±‚å‡ä¸ºå¼‚æ­¥è¯·æ±‚ã€‚å¦‚æœéœ€è¦å‘é€åŒæ­¥è¯·æ±‚ï¼Œè¯·å°†æ­¤é€‰é¡¹è®¾ç½®ä¸º falseã€‚ contentType ç±»å‹ï¼šStringé»˜è®¤å€¼: &quot;application/x-www-form-urlencoded&quot;ã€‚å‘é€ä¿¡æ¯è‡³æœåŠ¡å™¨æ—¶å†…å®¹ç¼–ç ç±»å‹ã€‚ é”®å€¼å¯¹è¿™æ ·ç»„ç»‡åœ¨ä¸€èˆ¬çš„æƒ…å†µä¸‹æ˜¯æ²¡æœ‰ä»€ä¹ˆé—®é¢˜çš„ï¼Œè¿™é‡Œè¯´çš„ä¸€èˆ¬æ˜¯ï¼Œä¸å¸¦åµŒå¥—ç±»å‹JSONï¼Œä¹Ÿå°±æ˜¯ ç®€å•çš„JSONï¼Œå½¢å¦‚è¿™æ ·ï¼š 12345&#123; a: 1, b: 2, c: 3&#125; ä½†æ˜¯åœ¨ä¸€äº›å¤æ‚çš„æƒ…å†µä¸‹å°±æœ‰é—®é¢˜äº†ã€‚ ä¾‹å¦‚åœ¨ Ajaxä¸­ä½ è¦ä¼ ä¸€ä¸ªå¤æ‚çš„ json å¯¹åƒï¼Œä¹Ÿå°±è¯´æ˜¯å¯¹è±¡åµŒæ•°ç»„ï¼Œæ•°ç»„ä¸­åŒ…æ‹¬å¯¹è±¡ï¼Œä½ è¿™æ ·ä¼ ï¼šapplication/x-www-form-urlencoded è¿™ç§å½¢å¼æ˜¯æ²¡æœ‰åŠæ³•å°†å¤æ‚çš„JSONç»„ç»‡æˆé”®å€¼å¯¹å½¢å¼ã€‚ 1234567&#123; data: &#123; a: [&#123; x: 2 &#125;] &#125;&#125; å¯ä»¥ç”¨å¦‚ä¸‹æ–¹å¼ä¼ é€’å¤æ‚çš„jsonå¯¹è±¡ 12345$.ajax(&#123; dataType: 'json', contentType: 'application/json', data: JSON.stringify(&#123;a: [&#123;b:1, a:1&#125;]&#125;)&#125;) ä¸ƒã€jQueryçš„æ›¿ä»£è€…è¿‘å¹´æ¥å‰ç«¯MV*çš„å‘å±•å£®å¤§ï¼Œäººä»¬è¶Šæ¥è¶Šå°‘çš„ä½¿ç”¨jQueryï¼Œæˆ‘ä»¬ä¸å¯èƒ½å•ç‹¬ä¸ºäº†ä½¿ç”¨jQueryçš„Ajax apiæ¥å•ç‹¬å¼•å…¥ä»–ï¼Œæ— å¯é¿å…çš„ï¼Œæˆ‘ä»¬éœ€è¦å¯»æ‰¾æ–°çš„æŠ€æœ¯æ–¹æ¡ˆã€‚ å°¤é›¨æºªåœ¨ä»–çš„æ–‡æ¡£ä¸­æ¨èå¤§å®¶ç”¨axiosè¿›è¡Œç½‘ç»œè¯·æ±‚ã€‚axiosåŸºäºPromiseå¯¹åŸç”Ÿçš„XHRè¿›è¡Œäº†éå¸¸å…¨é¢çš„å°è£…ï¼Œä½¿ç”¨æ–¹å¼ä¹Ÿéå¸¸çš„ä¼˜é›…ã€‚å¦å¤–ï¼ŒaxiosåŒæ ·æä¾›äº†åœ¨nodeç¯å¢ƒä¸‹çš„æ”¯æŒï¼Œå¯è°“æ˜¯ç½‘ç»œè¯·æ±‚çš„é¦–é€‰æ–¹æ¡ˆã€‚ æœªæ¥å¿…å®šè¿˜ä¼šå‡ºç°æ›´ä¼˜ç§€çš„å°è£…ï¼Œä»–ä»¬æœ‰éå¸¸å‘¨å…¨çš„è€ƒè™‘ä»¥åŠè¯¦ç»†çš„æ–‡æ¡£ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸å¤šåšè€ƒç©¶ï¼Œæˆ‘ä»¬æŠŠå…³æ³¨çš„é‡ç‚¹æ”¾åœ¨æ›´åº•å±‚çš„APIfetchã€‚ Fetch APIæ˜¯ä¸€ä¸ªç”¨ç”¨äºè®¿é—®å’Œæ“çºµHTTPç®¡é“çš„å¼ºå¤§çš„åŸç”Ÿ APIã€‚ è¿™ç§åŠŸèƒ½ä»¥å‰æ˜¯ä½¿ç”¨ XMLHttpRequestå®ç°çš„ã€‚Fetchæä¾›äº†ä¸€ä¸ªæ›´å¥½çš„æ›¿ä»£æ–¹æ³•ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°è¢«å…¶ä»–æŠ€æœ¯ä½¿ç”¨ï¼Œä¾‹å¦‚ Service Workersã€‚Fetchè¿˜æä¾›äº†å•ä¸ªé€»è¾‘ä½ç½®æ¥å®šä¹‰å…¶ä»–HTTPç›¸å…³æ¦‚å¿µï¼Œä¾‹å¦‚CORSå’ŒHTTPçš„æ‰©å±•ã€‚ å¯è§fetchæ˜¯ä½œä¸ºXMLHttpRequestçš„æ›¿ä»£å“å‡ºç°çš„ã€‚ ä½¿ç”¨fetchï¼Œä½ ä¸éœ€è¦å†é¢å¤–åŠ è½½ä¸€ä¸ªå¤–éƒ¨èµ„æºã€‚ä½†å®ƒè¿˜æ²¡æœ‰è¢«æµè§ˆå™¨å®Œå…¨æ”¯æŒï¼Œæ‰€ä»¥ä½ ä»ç„¶éœ€è¦ä¸€ä¸ªpolyfillã€‚ å…«ã€fetchçš„ä½¿ç”¨ä¸€ä¸ªåŸºæœ¬çš„ fetchè¯·æ±‚ï¼š 1234567891011121314151617const options = &#123; method: \"POST\", // è¯·æ±‚å‚æ•° headers: &#123; \"Content-Type\": \"application/json\"&#125;, // è®¾ç½®è¯·æ±‚å¤´ body: JSON.stringify(&#123;name:'123'&#125;), // è¯·æ±‚å‚æ•° credentials: \"same-origin\", // cookieè®¾ç½® mode: \"cors\", // è·¨åŸŸ&#125;fetch('http://www.xxx.com') .then(function(response) &#123; return response.json(); &#125;) .then(function(myJson) &#123; console.log(myJson); // å“åº”æ•°æ® &#125;) .catch(function(err)&#123; console.log(err); // å¼‚å¸¸å¤„ç† &#125;) Fetch APIæä¾›äº†ä¸€ä¸ªå…¨å±€çš„fetch()æ–¹æ³•ï¼Œä»¥åŠå‡ ä¸ªè¾…åŠ©å¯¹è±¡æ¥å‘èµ·ä¸€ä¸ªç½‘ç»œè¯·æ±‚ã€‚ fetch() fetch()æ–¹æ³•ç”¨äºå‘èµ·è·å–èµ„æºçš„è¯·æ±‚ã€‚å®ƒè¿”å›ä¸€ä¸ªpromiseï¼Œè¿™ä¸ª promise ä¼šåœ¨è¯·æ±‚å“åº”åè¢« resolveï¼Œå¹¶ä¼ å› Response å¯¹è±¡ã€‚ Headers å¯ä»¥é€šè¿‡Headers()æ„é€ å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªä½ è‡ªå·±çš„headerså¯¹è±¡ï¼Œç›¸å½“äº response/request çš„å¤´ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ä½ æŸ¥è¯¢åˆ°è¿™äº›å¤´ä¿¡æ¯ï¼Œæˆ–è€…é’ˆå¯¹ä¸åŒçš„ç»“æœåšä¸åŒçš„æ“ä½œã€‚12var myHeaders = new Headers();myHeaders.append(\"Content-Type\", \"text/plain\"); Request é€šè¿‡Request()æ„é€ å‡½æ•°å¯ä»¥åˆ›å»ºä¸€ä¸ªRequestå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å¯ä»¥ä½œä¸ºfetchå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚ Response åœ¨fetch()å¤„ç†å®Œpromisesä¹‹åè¿”å›ä¸€ä¸ªResponseå®ä¾‹ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªResponseå®ä¾‹ã€‚ ä¹ã€fetch polyfillæºç åˆ†æç”±äºfetchæ˜¯ä¸€ä¸ªéå¸¸åº•å±‚çš„APIï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•è¿›ä¸€æ­¥çš„æ¢ç©¶å®ƒçš„åº•å±‚ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å€ŸåŠ©å®ƒçš„polyfillæ¢ç©¶å®ƒçš„åŸºæœ¬åŸç†ï¼Œå¹¶æ‰¾å‡ºå…¶ä¸­çš„å‘ç‚¹ã€‚ ä»£ç ç»“æ„ ç”±ä»£ç å¯è§ï¼Œpolyfillä¸»è¦å¯¹Fetch APIæä¾›çš„å››å¤§å¯¹è±¡è¿›è¡Œäº†å°è£…ï¼š fetch å°è£… ä»£ç éå¸¸æ¸…æ™°ï¼š æ„é€ ä¸€ä¸ªPromiseå¯¹è±¡å¹¶è¿”å› åˆ›å»ºä¸€ä¸ªRequestå¯¹è±¡ åˆ›å»ºä¸€ä¸ªXMLHttpRequestå¯¹è±¡ å–å‡ºRequestå¯¹è±¡ä¸­çš„è¯·æ±‚urlï¼Œè¯·æ±‚æ–¹å‘ï¼Œopenä¸€ä¸ªxhrè¯·æ±‚ï¼Œå¹¶å°†Requestå¯¹è±¡ä¸­å­˜å‚¨çš„headerså–å‡ºèµ‹ç»™xhr xhr onloadåå–å‡ºresponseçš„statusã€headersã€bodyå°è£…Responseå¯¹è±¡ï¼Œè°ƒç”¨resolveã€‚ å¼‚å¸¸å¤„ç† å¯ä»¥å‘ç°ï¼Œè°ƒç”¨rejectæœ‰ä¸‰ç§å¯èƒ½ï¼š 1.è¯·æ±‚è¶…æ—¶ 2.è¯·æ±‚å¤±è´¥ æ³¨æ„ï¼šå½“å’ŒæœåŠ¡å™¨å»ºç«‹ç®€ä»‹ï¼Œå¹¶æ”¶åˆ°æœåŠ¡å™¨çš„å¼‚å¸¸çŠ¶æ€ç å¦‚404ã€500ç­‰å¹¶ä¸èƒ½è§¦å‘onerrorã€‚å½“ç½‘ç»œæ•…éšœæ—¶æˆ–è¯·æ±‚è¢«é˜»æ­¢æ—¶ï¼Œæ‰ä¼šæ ‡è®°ä¸º rejectï¼Œå¦‚è·¨åŸŸã€urlä¸å­˜åœ¨ï¼Œç½‘ç»œå¼‚å¸¸ç­‰ä¼šè§¦å‘onerrorã€‚ æ‰€ä»¥ä½¿ç”¨fetchå½“æ¥æ”¶åˆ°å¼‚å¸¸çŠ¶æ€ç éƒ½æ˜¯ä¼šè¿›å…¥thenè€Œä¸æ˜¯catchã€‚è¿™äº›é”™è¯¯è¯·æ±‚å¾€å¾€è¦æ‰‹åŠ¨å¤„ç†ã€‚ 3.æ‰‹åŠ¨ç»ˆæ­¢ å¯ä»¥åœ¨requestå‚æ•°ä¸­ä¼ å…¥signalå¯¹è±¡ï¼Œå¹¶å¯¹signalå¯¹è±¡æ·»åŠ abortäº‹ä»¶ç›‘å¬ï¼Œå½“xhr.readyStateå˜ä¸º4ï¼ˆå“åº”å†…å®¹è§£æå®Œæˆï¼‰åå°†signalå¯¹è±¡çš„abortäº‹ä»¶ç›‘å¬ç§»é™¤æ‰ã€‚ è¿™è¡¨ç¤ºï¼Œåœ¨ä¸€ä¸ªfetchè¯·æ±‚ç»“æŸä¹‹å‰å¯ä»¥è°ƒç”¨signal.abortå°†å…¶ç»ˆæ­¢ã€‚åœ¨æµè§ˆå™¨ä¸­å¯ä»¥ä½¿ç”¨AbortController()æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªæ§åˆ¶å™¨ï¼Œç„¶åä½¿ç”¨AbortController.signalå±æ€§ è¿™æ˜¯ä¸€ä¸ªå®éªŒä¸­çš„åŠŸèƒ½ï¼Œæ­¤åŠŸèƒ½æŸäº›æµè§ˆå™¨å°šåœ¨å¼€å‘ä¸­ Headerså°è£… åœ¨headerå¯¹è±¡ä¸­ç»´æŠ¤äº†ä¸€ä¸ªmapå¯¹è±¡ï¼Œæ„é€ å‡½æ•°ä¸­å¯ä»¥ä¼ å…¥Headerå¯¹è±¡ã€æ•°ç»„ã€æ™®é€šå¯¹è±¡ç±»å‹çš„headerï¼Œå¹¶å°†æ‰€æœ‰çš„å€¼ç»´æŠ¤åˆ°mapä¸­ã€‚ ä¹‹å‰åœ¨fetchå‡½æ•°ä¸­çœ‹åˆ°è°ƒç”¨äº†headerçš„forEachæ–¹æ³•ï¼Œä¸‹é¢æ˜¯å®ƒçš„å®ç°ï¼š å¯è§headerçš„éå†å³å…¶å†…éƒ¨mapçš„éå†ã€‚ å¦å¤–Headerè¿˜æä¾›äº†appendã€deleteã€getã€setç­‰æ–¹æ³•ï¼Œéƒ½æ˜¯å¯¹å…¶å†…éƒ¨çš„mapå¯¹è±¡è¿›è¡Œæ“ä½œã€‚ Requestå¯¹è±¡ Requestå¯¹è±¡æ¥æ”¶çš„ä¸¤ä¸ªå‚æ•°å³fetchå‡½æ•°æ¥æ”¶çš„ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥ç›´æ¥ä¼ é€’urlï¼Œä¹Ÿå¯ä»¥ä¼ é€’ä¸€ä¸ªæ„é€ å¥½çš„requestå¯¹è±¡ã€‚ç¬¬äºŒä¸ªå‚æ•°å³æ§åˆ¶ä¸åŒé…ç½®çš„optionå¯¹è±¡ã€‚ å¯ä»¥ä¼ å…¥credentialsã€headersã€methodã€modeã€signalã€referrerç­‰å±æ€§ã€‚ è¿™é‡Œæ³¨æ„ï¼š ä¼ å…¥çš„headersè¢«å½“ä½œHeadersæ„é€ å‡½æ•°çš„å‚æ•°æ¥æ„é€ headerå¯¹è±¡ã€‚ cookieå¤„ç†fetchå‡½æ•°ä¸­è¿˜æœ‰å¦‚ä¸‹çš„ä»£ç ï¼š 12345if (request.credentials === 'include') &#123; xhr.withCredentials = true&#125; else if (request.credentials === 'omit') &#123; xhr.withCredentials = false&#125; é»˜è®¤çš„credentialsç±»å‹ä¸ºsame-origin,å³å¯æºå¸¦åŒæºè¯·æ±‚çš„coodkieã€‚ ç„¶åæˆ‘å‘ç°è¿™é‡Œpolyfillçš„å®ç°å’ŒMDN-ä½¿ç”¨Fetchä»¥åŠå¾ˆå¤šèµ„æ–™æ˜¯ä¸ä¸€è‡´çš„ï¼š mdn: é»˜è®¤æƒ…å†µä¸‹ï¼Œfetch ä¸ä¼šä»æœåŠ¡ç«¯å‘é€æˆ–æ¥æ”¶ä»»ä½• cookies äºæ˜¯æˆ‘åˆ†åˆ«å®éªŒäº†ä¸‹ä½¿ç”¨polyfillå’Œä½¿ç”¨åŸç”Ÿfetchæºå¸¦cookieçš„æƒ…å†µï¼Œå‘ç°åœ¨ä¸è®¾ç½®credentialsçš„æƒ…å†µä¸‹å±…ç„¶éƒ½æ˜¯é»˜è®¤æºå¸¦åŒæºcookieçš„ï¼Œè¿™å’Œæ–‡æ¡£çš„è¯´æ˜è¯´ä¸ä¸€è‡´çš„ï¼ŒæŸ¥é˜…äº†è®¸å¤šèµ„æ–™åéƒ½æ˜¯è¯´fetché»˜è®¤ä¸ä¼šæºå¸¦cookieï¼Œä¸‹é¢æ˜¯ä½¿ç”¨åŸç”Ÿfetchåœ¨æµè§ˆå™¨è¿›è¡Œè¯·æ±‚çš„æƒ…å†µï¼š ç„¶åæˆ‘å‘ç°åœ¨MDN-Fetch-Requestå·²ç»æŒ‡å‡ºæ–°ç‰ˆæµè§ˆå™¨credentialsé»˜è®¤å€¼å·²æ›´æ”¹ä¸ºsame-originï¼Œæ—§ç‰ˆä¾ç„¶æ˜¯omitã€‚ ç¡®å®MDN-ä½¿ç”¨Fetchè¿™é‡Œçš„æ–‡æ¡£æ›´æ–°çš„æœ‰äº›ä¸åŠæ—¶ï¼Œè¯¯äººå­å¼Ÿäº†â€¦ Responseå¯¹è±¡Responseå¯¹è±¡æ˜¯fetchè°ƒç”¨æˆåŠŸåçš„è¿”å›å€¼ï¼š å›é¡¾ä¸‹fetchä¸­å¯¹Response`çš„æ“ä½œï¼š 12345678910xhr.onload = function () &#123; var options = &#123; status: xhr.status, statusText: xhr.statusText, headers: parseHeaders(xhr.getAllResponseHeaders() || '') &#125; options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL') var body = 'response' in xhr ? xhr.response : xhr.responseText resolve(new Response(body, options))&#125; Responseæ„é€ å‡½æ•°ï¼š å¯è§åœ¨æ„é€ å‡½æ•°ä¸­ä¸»è¦å¯¹optionsä¸­çš„statusã€statusTextã€headersã€urlç­‰åˆ†åˆ«åšäº†å¤„ç†å¹¶æŒ‚è½½åˆ°Responseå¯¹è±¡ä¸Šã€‚ æ„é€ å‡½æ•°é‡Œé¢å¹¶æ²¡æœ‰å¯¹responseTextçš„æ˜ç¡®å¤„ç†ï¼Œæœ€åäº¤ç»™äº†_initBodyå‡½æ•°å¤„ç†ï¼Œè€ŒResponseå¹¶æ²¡æœ‰ä¸»åŠ¨å£°æ˜_initBodyå±æ€§ï¼Œä»£ç æœ€åä½¿ç”¨Responseè°ƒç”¨äº†Bodyå‡½æ•°ï¼Œå®é™…ä¸Š_initBodyå‡½æ•°æ˜¯é€šè¿‡Bodyå‡½æ•°æŒ‚è½½åˆ°Responseèº«ä¸Šçš„ï¼Œå…ˆæ¥çœ‹çœ‹_initBodyå‡½æ•°ï¼š å¯è§ï¼Œ_initBodyå‡½æ•°æ ¹æ®xhr.responseçš„ç±»å‹ï¼ˆBlobã€FormDataã€String...ï¼‰ï¼Œä¸ºä¸åŒçš„å‚æ•°è¿›è¡Œèµ‹å€¼ï¼Œè¿™äº›å‚æ•°åœ¨Bodyæ–¹æ³•ä¸­å¾—åˆ°ä¸åŒçš„åº”ç”¨ï¼Œä¸‹é¢å…·ä½“çœ‹çœ‹Bodyå‡½æ•°è¿˜åšäº†å“ªäº›å…¶ä»–çš„æ“ä½œï¼š Bodyå‡½æ•°ä¸­è¿˜ä¸ºResponseå¯¹è±¡æŒ‚è½½äº†å››ä¸ªå‡½æ•°ï¼Œtextã€jsonã€blobã€formDataï¼Œè¿™äº›å‡½æ•°ä¸­çš„æ“ä½œå°±æ˜¯å°†_initBodyä¸­å¾—åˆ°çš„ä¸åŒç±»å‹çš„è¿”å›å€¼è¿”å›ã€‚ è¿™ä¹Ÿè¯´æ˜äº†ï¼Œåœ¨fetchæ‰§è¡Œå®Œæ¯•åï¼Œä¸èƒ½ç›´æ¥åœ¨responseä¸­è·å–åˆ°è¿”å›å€¼è€Œå¿…é¡»è°ƒç”¨text()ã€json()ç­‰å‡½æ•°æ‰èƒ½è·å–åˆ°è¿”å›å€¼ã€‚ è¿™é‡Œè¿˜æœ‰ä¸€ç‚¹éœ€è¦è¯´æ˜ï¼šå‡ ä¸ªå‡½æ•°ä¸­éƒ½æœ‰ç±»ä¼¼ä¸‹é¢çš„é€»è¾‘ï¼š 1234var rejected = consumed(this)if (rejected) &#123; return rejected&#125; consumedå‡½æ•°ï¼š123456function consumed(body) &#123; if (body.bodyUsed) &#123; return Promise.reject(new TypeError('Already read')) &#125; body.bodyUsed = true&#125; æ¯æ¬¡è°ƒç”¨text()ã€json()ç­‰å‡½æ•°åä¼šå°†bodyUsedå˜é‡å˜ä¸ºtrueï¼Œç”¨æ¥æ ‡è¯†è¿”å›å€¼å·²ç»è¯»å–è¿‡äº†ï¼Œä¸‹ä¸€æ¬¡å†è¯»å–ç›´æ¥æŠ›å‡ºTypeError(&#39;Already read&#39;)ã€‚è¿™ä¹Ÿéµå¾ªäº†åŸç”Ÿfetchçš„åŸåˆ™ï¼š å› ä¸ºResponseså¯¹è±¡è¢«è®¾ç½®ä¸ºäº† stream çš„æ–¹å¼ï¼Œæ‰€ä»¥å®ƒä»¬åªèƒ½è¢«è¯»å–ä¸€æ¬¡ åã€fetchçš„å‘ç‚¹VUEçš„æ–‡æ¡£ä¸­å¯¹fetchæœ‰ä¸‹é¢çš„æè¿°ï¼š ä½¿ç”¨fetchè¿˜æœ‰å¾ˆå¤šåˆ«çš„æ³¨æ„äº‹é¡¹ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå¤§å®¶ç°é˜¶æ®µè¿˜æ˜¯æ›´å–œæ¬¢axios å¤šä¸€äº›ã€‚å½“ç„¶è¿™ä¸ªäº‹æƒ…åœ¨æœªæ¥å¯èƒ½ä¼šå‘ç”Ÿæ”¹å˜ã€‚ ç”±äºfetchæ˜¯ä¸€ä¸ªéå¸¸åº•å±‚çš„APIï¼Œå®ƒå¹¶æ²¡æœ‰è¢«è¿›è¡Œå¾ˆå¤šå°è£…ï¼Œè¿˜æœ‰è®¸å¤šé—®é¢˜éœ€è¦å¤„ç†ï¼š ä¸èƒ½ç›´æ¥ä¼ é€’JavaScriptå¯¹è±¡ä½œä¸ºå‚æ•° éœ€è¦è‡ªå·±åˆ¤æ–­è¿”å›å€¼ç±»å‹ï¼Œå¹¶æ‰§è¡Œå“åº”è·å–è¿”å›å€¼çš„æ–¹æ³• è·å–è¿”å›å€¼æ–¹æ³•åªèƒ½è°ƒç”¨ä¸€æ¬¡ï¼Œä¸èƒ½å¤šæ¬¡è°ƒç”¨ æ— æ³•æ­£å¸¸çš„æ•è·å¼‚å¸¸ è€ç‰ˆæµè§ˆå™¨ä¸ä¼šé»˜è®¤æºå¸¦cookie ä¸æ”¯æŒjsonp åä¸€ã€å¯¹fetchçš„å°è£…è¯·æ±‚å‚æ•°å¤„ç†æ”¯æŒä¼ å…¥ä¸åŒçš„å‚æ•°ç±»å‹ï¼š12345678910111213141516171819function stringify(url, data) &#123; var dataString = url.indexOf('?') == -1 ? '?' : '&amp;'; for (var key in data) &#123; dataString += key + '=' + data[key] + '&amp;'; &#125;; return dataString;&#125;if (request.formData) &#123; request.body = request.data;&#125; else if (/^get$/i.test(request.method)) &#123; request.url = `$&#123;request.url&#125;$&#123;stringify(request.url, request.data)&#125;`;&#125; else if (request.form) &#123; request.headers.set('Content-Type', 'application/x-www-form-urlencoded;charset=UTF-8'); request.body = stringify(request.data);&#125; else &#123; request.headers.set('Content-Type', 'application/json;charset=UTF-8'); request.body = JSON.stringify(request.data);&#125; cookieæºå¸¦fetchåœ¨æ–°ç‰ˆæµè§ˆå™¨å·²ç»å¼€å§‹é»˜è®¤æºå¸¦åŒæºcookieï¼Œä½†åœ¨è€ç‰ˆæµè§ˆå™¨ä¸­ä¸ä¼šé»˜è®¤æºå¸¦ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ä»–è¿›è¡Œç»Ÿä¸€è®¾ç½®ï¼š 12request.credentials = 'same-origin'; // åŒæºæºå¸¦request.credentials = 'include'; // å¯è·¨åŸŸæºå¸¦ å¼‚å¸¸å¤„ç† å½“æ¥æ”¶åˆ°ä¸€ä¸ªä»£è¡¨é”™è¯¯çš„ HTTP çŠ¶æ€ç æ—¶ï¼Œä» fetch()è¿”å›çš„ Promise ä¸ä¼šè¢«æ ‡è®°ä¸º rejectï¼Œ å³ä½¿è¯¥ HTTP å“åº”çš„çŠ¶æ€ç æ˜¯ 404 æˆ– 500ã€‚ç›¸åï¼Œå®ƒä¼šå°† Promise çŠ¶æ€æ ‡è®°ä¸º resolve ï¼ˆä½†æ˜¯ä¼šå°† resolve çš„è¿”å›å€¼çš„ ok å±æ€§è®¾ç½®ä¸º false ï¼‰ï¼Œä»…å½“ç½‘ç»œæ•…éšœæ—¶æˆ–è¯·æ±‚è¢«é˜»æ­¢æ—¶ï¼Œæ‰ä¼šæ ‡è®°ä¸º rejectã€‚ å› æ­¤æˆ‘ä»¬è¦å¯¹fetchçš„å¼‚å¸¸è¿›è¡Œç»Ÿä¸€å¤„ç† 123456789.then(response =&gt; &#123; if (response.ok) &#123; return Promise.resolve(response); &#125;else&#123; const error = new Error(`è¯·æ±‚å¤±è´¥! çŠ¶æ€ç : $&#123;response.status&#125;, å¤±è´¥ä¿¡æ¯: $&#123;response.statusText&#125;`); error.response = response; return Promise.reject(error); &#125;&#125;); è¿”å›å€¼å¤„ç†å¯¹ä¸åŒçš„è¿”å›å€¼ç±»å‹è°ƒç”¨ä¸åŒçš„å‡½æ•°æ¥æ”¶ï¼Œè¿™é‡Œå¿…é¡»æå‰åˆ¤æ–­å¥½ç±»å‹ï¼Œä¸èƒ½å¤šæ¬¡è°ƒç”¨è·å–è¿”å›å€¼çš„æ–¹æ³•ï¼š 12345678.then(response =&gt; &#123; let contentType = response.headers.get('content-type'); if (contentType.includes('application/json')) &#123; return response.json(); &#125; else &#123; return response.text(); &#125;&#125;); jsonpfetchæœ¬èº«æ²¡æœ‰æä¾›å¯¹jsonpçš„æ”¯æŒï¼Œjsonpæœ¬èº«ä¹Ÿä¸å±äºä¸€ç§éå¸¸å¥½çš„è§£å†³è·¨åŸŸçš„æ–¹å¼ï¼Œæ¨èä½¿ç”¨corsæˆ–è€…nginxè§£å†³è·¨åŸŸï¼Œå…·ä½“è¯·çœ‹ä¸‹é¢çš„ç« èŠ‚ã€‚ fetchå°è£…å¥½äº†ï¼Œå¯ä»¥æ„‰å¿«çš„ä½¿ç”¨äº†ã€‚ å—¯ï¼ŒaxiosçœŸå¥½ç”¨â€¦ åäºŒã€è·¨åŸŸæ€»ç»“è°ˆåˆ°ç½‘ç»œè¯·æ±‚ï¼Œå°±ä¸å¾—ä¸æè·¨åŸŸã€‚ æµè§ˆå™¨çš„åŒæºç­–ç•¥é™åˆ¶äº†ä»åŒä¸€ä¸ªæºåŠ è½½çš„æ–‡æ¡£æˆ–è„šæœ¬å¦‚ä½•ä¸æ¥è‡ªå¦ä¸€ä¸ªæºçš„èµ„æºè¿›è¡Œäº¤äº’ã€‚è¿™æ˜¯ä¸€ä¸ªç”¨äºéš”ç¦»æ½œåœ¨æ¶æ„æ–‡ä»¶çš„é‡è¦å®‰å…¨æœºåˆ¶ã€‚é€šå¸¸ä¸å…è®¸ä¸åŒæºé—´çš„è¯»æ“ä½œã€‚ è·¨åŸŸæ¡ä»¶ï¼šåè®®ï¼ŒåŸŸåï¼Œç«¯å£ï¼Œæœ‰ä¸€ä¸ªä¸åŒå°±ç®—è·¨åŸŸã€‚ ä¸‹é¢æ˜¯è§£å†³è·¨åŸŸçš„å‡ ç§æ–¹å¼ï¼š nginxä½¿ç”¨nginxåå‘ä»£ç†å®ç°è·¨åŸŸï¼Œå‚è€ƒæˆ‘è¿™ç¯‡æ–‡ç« ï¼šå‰ç«¯å¼€å‘è€…å¿…å¤‡çš„nginxçŸ¥è¯† corsCORSæ˜¯ä¸€ä¸ªW3Cæ ‡å‡†ï¼Œå…¨ç§°æ˜¯â€è·¨åŸŸèµ„æºå…±äº«â€ï¼ˆCross-origin resource sharingï¼‰ã€‚å®ƒå…è®¸æµè§ˆå™¨å‘è·¨æºæœåŠ¡å™¨ï¼Œå‘å‡ºXMLHttpRequestè¯·æ±‚ã€‚ æœåŠ¡ç«¯è®¾ç½®Access-Control-Allow-Originå°±å¯ä»¥å¼€å¯CORSã€‚ è¯¥å±æ€§è¡¨ç¤ºå“ªäº›åŸŸåå¯ä»¥è®¿é—®èµ„æºï¼Œå¦‚æœè®¾ç½®é€šé…ç¬¦åˆ™è¡¨ç¤ºæ‰€æœ‰ç½‘ç«™éƒ½å¯ä»¥è®¿é—®èµ„æºã€‚ 123456app.all('*', function (req, res, next) &#123; res.header(\"Access-Control-Allow-Origin\", \"*\"); res.header(\"Access-Control-Allow-Headers\", \"X-Requested-With\"); res.header(\"Access-Control-Allow-Methods\", \"PUT,POST,GET,DELETE,OPTIONS\"); next();&#125;); jsonpscriptæ ‡ç­¾çš„srcå±æ€§ä¸­çš„é“¾æ¥å¯ä»¥è®¿é—®è·¨åŸŸçš„jsè„šæœ¬ï¼Œåˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼ŒæœåŠ¡ç«¯ä¸å†è¿”å›JSONæ ¼å¼çš„æ•°æ®ï¼Œè€Œæ˜¯è¿”å›ä¸€æ®µè°ƒç”¨æŸä¸ªå‡½æ•°çš„jsä»£ç ï¼Œåœ¨srcä¸­è¿›è¡Œäº†è°ƒç”¨ï¼Œè¿™æ ·å®ç°äº†è·¨åŸŸã€‚ jqueryå¯¹jsonpçš„æ”¯æŒï¼š 12345678910$.ajax(&#123; type : \"get\", url : \"http://xxxx\" dataType: \"jsonp\", jsonp:\"callback\", jsonpCallback: \"doo\", success : function(data) &#123; console.log(data); &#125;&#125;); fetchã€axiosç­‰å¹¶æ²¡æœ‰ç›´æ¥æä¾›å¯¹jsonpçš„æ”¯æŒï¼Œå¦‚æœéœ€è¦ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•è¿›è¡Œæ‰‹åŠ¨å°è£…ï¼š 123456789101112131415161718192021222324252627282930313233(function (window,document) &#123; \"use strict\"; var jsonp = function (url,data,callback) &#123; // 1.å°†ä¼ å…¥çš„dataæ•°æ®è½¬åŒ–ä¸ºurlå­—ç¬¦ä¸²å½¢å¼ // &#123;id:1,name:'jack'&#125; =&gt; id=1&amp;name=jack var dataString = url.indexof('?') == -1? '?': '&amp;'; for(var key in data)&#123; dataString += key + '=' + data[key] + '&amp;'; &#125;; // 2 å¤„ç†urlä¸­çš„å›è°ƒå‡½æ•° // cbFuncNameå›è°ƒå‡½æ•°çš„åå­— ï¼šmy_json_cb_åå­—çš„å‰ç¼€ + éšæœºæ•°ï¼ˆæŠŠå°æ•°ç‚¹å»æ‰ï¼‰ var cbFuncName = 'my_json_cb_' + Math.random().toString().replace('.',''); dataString += 'callback=' + cbFuncName; // 3.åˆ›å»ºä¸€ä¸ªscriptæ ‡ç­¾å¹¶æ’å…¥åˆ°é¡µé¢ä¸­ var scriptEle = document.createElement('script'); scriptEle.src = url + dataString; // 4.æŒ‚è½½å›è°ƒå‡½æ•° window[cbFuncName] = function (data) &#123; callback(data); // å¤„ç†å®Œå›è°ƒå‡½æ•°çš„æ•°æ®ä¹‹åï¼Œåˆ é™¤jsonpçš„scriptæ ‡ç­¾ document.body.removeChild(scriptEle); &#125; document.body.appendChild(scriptEle); &#125; window.$jsonp = jsonp;&#125;)(window,document) postMessageè·¨åŸŸpostMessage()æ–¹æ³•å…è®¸æ¥è‡ªä¸åŒæºçš„è„šæœ¬é‡‡ç”¨å¼‚æ­¥æ–¹å¼è¿›è¡Œæœ‰é™çš„é€šä¿¡ï¼Œå¯ä»¥å®ç°è·¨æ–‡æœ¬æ¡£ã€å¤šçª—å£ã€è·¨åŸŸæ¶ˆæ¯ä¼ é€’ã€‚ 1234567891011//æ•è·iframevar domain = 'http://scriptandstyle.com';var iframe = document.getElementById('myIFrame').contentWindow;//å‘é€æ¶ˆæ¯setInterval(function()&#123; var message = 'Hello! The time is: ' + (new Date().getTime()); console.log('blog.local: sending message: ' + message); //send the message and target URI iframe.postMessage(message,domain); &#125;,6000); 123456//å“åº”äº‹ä»¶window.addEventListener('message',function(event) &#123; if(event.origin !== 'http://davidwalsh.name') return; console.log('message received: ' + event.data,event); event.source.postMessage('holla back youngin!',event.origin);&#125;,false); postMessageè·¨åŸŸé€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼šåŒæµè§ˆå™¨å¤šçª—å£é—´è·¨åŸŸé€šä¿¡ã€iframeé—´è·¨åŸŸé€šä¿¡ã€‚ WebSocketWebSocket æ˜¯ä¸€ç§åŒå‘é€šä¿¡åè®®ï¼Œåœ¨å»ºç«‹è¿æ¥ä¹‹åï¼ŒWebSocketçš„ serverä¸ clientéƒ½èƒ½ä¸»åŠ¨å‘å¯¹æ–¹å‘é€æˆ–æ¥æ”¶æ•°æ®è€Œä¸å—åŒæºç­–ç•¥çš„é™åˆ¶ã€‚ 1234567891011121314151617181920212223function WebSocketTest()&#123; if (\"WebSocket\" in window)&#123; alert(\"æ‚¨çš„æµè§ˆå™¨æ”¯æŒ WebSocket!\"); // æ‰“å¼€ä¸€ä¸ª web socket var ws = new WebSocket(\"ws://localhost:3000/abcd\"); ws.onopen = function()&#123; // Web Socket å·²è¿æ¥ä¸Šï¼Œä½¿ç”¨ send() æ–¹æ³•å‘é€æ•°æ® ws.send(\"å‘é€æ•°æ®\"); alert(\"æ•°æ®å‘é€ä¸­...\"); &#125;; ws.onmessage = function (evt) &#123; var received_msg = evt.data; alert(\"æ•°æ®å·²æ¥æ”¶...\"); &#125;; ws.onclose = function()&#123; // å…³é—­ websocket alert(\"è¿æ¥å·²å…³é—­...\"); &#125;; &#125; else&#123; // æµè§ˆå™¨ä¸æ”¯æŒ WebSocket alert(\"æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ WebSocket!\"); &#125;&#125; æ–‡ä¸­å¦‚æœ‰é”™è¯¯ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºæŒ‡æ­£ï¼Œè°¢è°¢é˜…è¯»ã€‚","categories":[],"tags":[{"name":"æµè§ˆå™¨å’Œç½‘ç»œ","slug":"æµè§ˆå™¨å’Œç½‘ç»œ","permalink":"https://www.lisq.xyz/tags/æµè§ˆå™¨å’Œç½‘ç»œ/"}]},{"title":"å‰ç«¯å¼€å‘è€…å¿…å¤‡çš„nginxçŸ¥è¯†","slug":"ã€å‰ç«¯å·¥ç¨‹ã€‘å‰ç«¯å¼€å‘è€…å¿…å¤‡çš„nginxçŸ¥è¯†","date":"2019-03-12T06:50:35.000Z","updated":"2019-04-06T05:25:56.565Z","comments":true,"path":"2019/03/12/ã€å‰ç«¯å·¥ç¨‹ã€‘å‰ç«¯å¼€å‘è€…å¿…å¤‡çš„nginxçŸ¥è¯†/","link":"","permalink":"https://www.lisq.xyz/2019/03/12/ã€å‰ç«¯å·¥ç¨‹ã€‘å‰ç«¯å¼€å‘è€…å¿…å¤‡çš„nginxçŸ¥è¯†/","excerpt":"","text":"nginxåœ¨åº”ç”¨ç¨‹åºä¸­çš„ä½œç”¨ è§£å†³è·¨åŸŸ è¯·æ±‚è¿‡æ»¤ é…ç½®gzip è´Ÿè½½å‡è¡¡ é™æ€èµ„æºæœåŠ¡å™¨ nginxæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„HTTPå’Œåå‘ä»£ç†æœåŠ¡å™¨ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªé€šç”¨çš„TCP/UDPä»£ç†æœåŠ¡å™¨ï¼Œæœ€åˆç”±ä¿„ç½—æ–¯äººIgor Sysoevç¼–å†™ã€‚ nginxç°åœ¨å‡ ä¹æ˜¯ä¼—å¤šå¤§å‹ç½‘ç«™çš„å¿…ç”¨æŠ€æœ¯ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸éœ€è¦äº²è‡ªå»é…ç½®å®ƒï¼Œä½†æ˜¯äº†è§£å®ƒåœ¨åº”ç”¨ç¨‹åºä¸­æ‰€æ‹…ä»»çš„è§’è‰²ï¼Œä»¥åŠå¦‚ä½•è§£å†³è¿™äº›é—®é¢˜æ˜¯éå¸¸å¿…è¦çš„ã€‚ ä¸‹é¢æˆ‘å°†ä»nginxåœ¨ä¼ä¸šä¸­çš„çœŸå®åº”ç”¨æ¥è§£é‡Šnginxåœ¨åº”ç”¨ç¨‹åºä¸­èµ·åˆ°çš„ä½œç”¨ã€‚ ä¸ºäº†ä¾¿äºç†è§£ï¼Œé¦–å…ˆå…ˆæ¥äº†è§£ä¸€ä¸‹ä¸€äº›åŸºç¡€çŸ¥è¯†ï¼Œnginxæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„åå‘ä»£ç†æœåŠ¡å™¨é‚£ä¹ˆä»€ä¹ˆæ˜¯åå‘ä»£ç†å‘¢ï¼Ÿ æ­£å‘ä»£ç†ä¸åå‘ä»£ç†ä»£ç†æ˜¯åœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´å‡è®¾çš„ä¸€å±‚æœåŠ¡å™¨ï¼Œä»£ç†å°†æ¥æ”¶å®¢æˆ·ç«¯çš„è¯·æ±‚å¹¶å°†å®ƒè½¬å‘ç»™æœåŠ¡å™¨ï¼Œç„¶åå°†æœåŠ¡ç«¯çš„å“åº”è½¬å‘ç»™å®¢æˆ·ç«¯ã€‚ ä¸ç®¡æ˜¯æ­£å‘ä»£ç†è¿˜æ˜¯åå‘ä»£ç†ï¼Œå®ç°çš„éƒ½æ˜¯ä¸Šé¢çš„åŠŸèƒ½ã€‚ æ­£å‘ä»£ç† æ­£å‘ä»£ç†ï¼Œæ„æ€æ˜¯ä¸€ä¸ªä½äºå®¢æˆ·ç«¯å’ŒåŸå§‹æœåŠ¡å™¨(origin server)ä¹‹é—´çš„æœåŠ¡å™¨ï¼Œä¸ºäº†ä»åŸå§‹æœåŠ¡å™¨å–å¾—å†…å®¹ï¼Œå®¢æˆ·ç«¯å‘ä»£ç†å‘é€ä¸€ä¸ªè¯·æ±‚å¹¶æŒ‡å®šç›®æ ‡(åŸå§‹æœåŠ¡å™¨)ï¼Œç„¶åä»£ç†å‘åŸå§‹æœåŠ¡å™¨è½¬äº¤è¯·æ±‚å¹¶å°†è·å¾—çš„å†…å®¹è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ æ­£å‘ä»£ç†æ˜¯ä¸ºæˆ‘ä»¬æœåŠ¡çš„ï¼Œå³ä¸ºå®¢æˆ·ç«¯æœåŠ¡çš„ï¼Œå®¢æˆ·ç«¯å¯ä»¥æ ¹æ®æ­£å‘ä»£ç†è®¿é—®åˆ°å®ƒæœ¬èº«æ— æ³•è®¿é—®åˆ°çš„æœåŠ¡å™¨èµ„æºã€‚ æ­£å‘ä»£ç†å¯¹æˆ‘ä»¬æ˜¯é€æ˜çš„ï¼Œå¯¹æœåŠ¡ç«¯æ˜¯éé€æ˜çš„ï¼Œå³æœåŠ¡ç«¯å¹¶ä¸çŸ¥é“è‡ªå·±æ”¶åˆ°çš„æ˜¯æ¥è‡ªä»£ç†çš„è®¿é—®è¿˜æ˜¯æ¥è‡ªçœŸå®å®¢æˆ·ç«¯çš„è®¿é—®ã€‚ åå‘ä»£ç† åå‘ä»£ç†ï¼ˆReverse Proxyï¼‰æ–¹å¼æ˜¯æŒ‡ä»¥ä»£ç†æœåŠ¡å™¨æ¥æ¥å—internetä¸Šçš„è¿æ¥è¯·æ±‚ï¼Œç„¶åå°†è¯·æ±‚è½¬å‘ç»™å†…éƒ¨ç½‘ç»œä¸Šçš„æœåŠ¡å™¨ï¼Œå¹¶å°†ä»æœåŠ¡å™¨ä¸Šå¾—åˆ°çš„ç»“æœè¿”å›ç»™internetä¸Šè¯·æ±‚è¿æ¥çš„å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶ä»£ç†æœåŠ¡å™¨å¯¹å¤–å°±è¡¨ç°ä¸ºä¸€ä¸ªåå‘ä»£ç†æœåŠ¡å™¨ã€‚ åå‘ä»£ç†æ˜¯ä¸ºæœåŠ¡ç«¯æœåŠ¡çš„ï¼Œåå‘ä»£ç†å¯ä»¥å¸®åŠ©æœåŠ¡å™¨æ¥æ”¶æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¸®åŠ©æœåŠ¡å™¨åšè¯·æ±‚è½¬å‘ï¼Œè´Ÿè½½å‡è¡¡ç­‰ã€‚ åå‘ä»£ç†å¯¹æœåŠ¡ç«¯æ˜¯é€æ˜çš„ï¼Œå¯¹æˆ‘ä»¬æ˜¯éé€æ˜çš„ï¼Œå³æˆ‘ä»¬å¹¶ä¸çŸ¥é“è‡ªå·±è®¿é—®çš„æ˜¯ä»£ç†æœåŠ¡å™¨ï¼Œè€ŒæœåŠ¡å™¨çŸ¥é“åå‘ä»£ç†åœ¨ä¸ºä»–æœåŠ¡ã€‚ åŸºæœ¬é…ç½®é…ç½®ç»“æ„ä¸‹é¢æ˜¯ä¸€ä¸ªnginxé…ç½®æ–‡ä»¶çš„åŸºæœ¬ç»“æ„ï¼š 123456789101112131415161718192021222324events &#123; &#125;http &#123; server &#123; location path &#123; ... &#125; location path &#123; ... &#125; &#125; server &#123; ... &#125;&#125; main:nginxçš„å…¨å±€é…ç½®ï¼Œå¯¹å…¨å±€ç”Ÿæ•ˆã€‚ events:é…ç½®å½±å“nginxæœåŠ¡å™¨æˆ–ä¸ç”¨æˆ·çš„ç½‘ç»œè¿æ¥ã€‚ httpï¼šå¯ä»¥åµŒå¥—å¤šä¸ªserverï¼Œé…ç½®ä»£ç†ï¼Œç¼“å­˜ï¼Œæ—¥å¿—å®šä¹‰ç­‰ç»å¤§å¤šæ•°åŠŸèƒ½å’Œç¬¬ä¸‰æ–¹æ¨¡å—çš„é…ç½®ã€‚ serverï¼šé…ç½®è™šæ‹Ÿä¸»æœºçš„ç›¸å…³å‚æ•°ï¼Œä¸€ä¸ªhttpä¸­å¯ä»¥æœ‰å¤šä¸ªserverã€‚ locationï¼šé…ç½®è¯·æ±‚çš„è·¯ç”±ï¼Œä»¥åŠå„ç§é¡µé¢çš„å¤„ç†æƒ…å†µã€‚ upstreamï¼šé…ç½®åç«¯æœåŠ¡å™¨å…·ä½“åœ°å€ï¼Œè´Ÿè½½å‡è¡¡é…ç½®ä¸å¯æˆ–ç¼ºçš„éƒ¨åˆ†ã€‚ å†…ç½®å˜é‡ä¸‹é¢æ˜¯nginxä¸€äº›é…ç½®ä¸­å¸¸ç”¨çš„å†…ç½®å…¨å±€å˜é‡ï¼Œä½ å¯ä»¥åœ¨é…ç½®çš„ä»»ä½•ä½ç½®ä½¿ç”¨å®ƒä»¬ã€‚ å˜é‡å åŠŸèƒ½ $host è¯·æ±‚ä¿¡æ¯ä¸­çš„Hostï¼Œå¦‚æœè¯·æ±‚ä¸­æ²¡æœ‰Hostè¡Œï¼Œåˆ™ç­‰äºè®¾ç½®çš„æœåŠ¡å™¨å $request_method å®¢æˆ·ç«¯è¯·æ±‚ç±»å‹ï¼Œå¦‚GETã€POST $remote_addr å®¢æˆ·ç«¯çš„IPåœ°å€ $args è¯·æ±‚ä¸­çš„å‚æ•° $content_length è¯·æ±‚å¤´ä¸­çš„Content-lengthå­—æ®µ $http_user_agent å®¢æˆ·ç«¯agentä¿¡æ¯ $http_cookie å®¢æˆ·ç«¯cookieä¿¡æ¯ $remote_addr å®¢æˆ·ç«¯çš„IPåœ°å€ $remote_port å®¢æˆ·ç«¯çš„ç«¯å£ $server_protocol è¯·æ±‚ä½¿ç”¨çš„åè®®ï¼Œå¦‚HTTP/1.0ã€Â·HTTP/1.1` $server_addr æœåŠ¡å™¨åœ°å€ $server_name æœåŠ¡å™¨åç§° $server_port æœåŠ¡å™¨çš„ç«¯å£å· è§£å†³è·¨åŸŸå…ˆè¿½æœ¬æº¯æºä»¥ä¸‹ï¼Œè·¨åŸŸç©¶ç«Ÿæ˜¯æ€ä¹ˆå›äº‹ã€‚ è·¨åŸŸçš„å®šä¹‰åŒæºç­–ç•¥é™åˆ¶äº†ä»åŒä¸€ä¸ªæºåŠ è½½çš„æ–‡æ¡£æˆ–è„šæœ¬å¦‚ä½•ä¸æ¥è‡ªå¦ä¸€ä¸ªæºçš„èµ„æºè¿›è¡Œäº¤äº’ã€‚è¿™æ˜¯ä¸€ä¸ªç”¨äºéš”ç¦»æ½œåœ¨æ¶æ„æ–‡ä»¶çš„é‡è¦å®‰å…¨æœºåˆ¶ã€‚é€šå¸¸ä¸å…è®¸ä¸åŒæºé—´çš„è¯»æ“ä½œã€‚ åŒæºçš„å®šä¹‰å¦‚æœä¸¤ä¸ªé¡µé¢çš„åè®®ï¼Œç«¯å£ï¼ˆå¦‚æœæœ‰æŒ‡å®šï¼‰å’ŒåŸŸåéƒ½ç›¸åŒï¼Œåˆ™ä¸¤ä¸ªé¡µé¢å…·æœ‰ç›¸åŒçš„æºã€‚ nginxè§£å†³è·¨åŸŸçš„åŸç†ä¾‹å¦‚ï¼š å‰ç«¯serverçš„åŸŸåä¸ºï¼šfe.server.com åç«¯æœåŠ¡çš„åŸŸåä¸ºï¼šdev.server.com ç°åœ¨æˆ‘åœ¨fe.server.comå¯¹dev.server.comå‘èµ·è¯·æ±‚ä¸€å®šä¼šå‡ºç°è·¨åŸŸã€‚ ç°åœ¨æˆ‘ä»¬åªéœ€è¦å¯åŠ¨ä¸€ä¸ªnginxæœåŠ¡å™¨ï¼Œå°†server_nameè®¾ç½®ä¸ºfe.server.com,ç„¶åè®¾ç½®ç›¸åº”çš„locationä»¥æ‹¦æˆªå‰ç«¯éœ€è¦è·¨åŸŸçš„è¯·æ±‚ï¼Œæœ€åå°†è¯·æ±‚ä»£ç†å›dev.server.comã€‚å¦‚ä¸‹é¢çš„é…ç½®ï¼š 1234567server &#123; listen 80; server_name fe.server.com; location / &#123; proxy_pass dev.server.com; &#125;&#125; è¿™æ ·å¯ä»¥å®Œç¾ç»•è¿‡æµè§ˆå™¨çš„åŒæºç­–ç•¥ï¼šfe.server.comè®¿é—®nginxçš„fe.server.comå±äºåŒæºè®¿é—®ï¼Œè€Œnginxå¯¹æœåŠ¡ç«¯è½¬å‘çš„è¯·æ±‚ä¸ä¼šè§¦å‘æµè§ˆå™¨çš„åŒæºç­–ç•¥ã€‚ è¯·æ±‚è¿‡æ»¤ æ ¹æ®çŠ¶æ€ç è¿‡æ»¤12345error_page 500 501 502 503 504 506 /50x.html; location = /50x.html &#123; #å°†è·Ÿè·¯å¾„æ”¹ç¼–ä¸ºå­˜æ”¾htmlçš„è·¯å¾„ã€‚ root /root/static/html; &#125; æ ¹æ®URLåç§°è¿‡æ»¤ï¼Œç²¾å‡†åŒ¹é…URLï¼Œä¸åŒ¹é…çš„URLå…¨éƒ¨é‡å®šå‘åˆ°ä¸»é¡µã€‚ 123location / &#123; rewrite ^.*$ /index.html redirect;&#125; æ ¹æ®è¯·æ±‚ç±»å‹è¿‡æ»¤ã€‚123if ( $request_method !~ ^(GET|POST|HEAD)$ ) &#123; return 403; &#125; é…ç½®gzip GZIPæ˜¯è§„å®šçš„ä¸‰ç§æ ‡å‡†HTTPå‹ç¼©æ ¼å¼ä¹‹ä¸€ã€‚ç›®å‰ç»å¤§å¤šæ•°çš„ç½‘ç«™éƒ½åœ¨ä½¿ç”¨GZIPä¼ è¾“ HTMLã€CSSã€JavaScript ç­‰èµ„æºæ–‡ä»¶ã€‚ å¯¹äºæ–‡æœ¬æ–‡ä»¶ï¼ŒGZip çš„æ•ˆæœéå¸¸æ˜æ˜¾ï¼Œå¼€å¯åä¼ è¾“æ‰€éœ€æµé‡å¤§çº¦ä¼šé™è‡³ 1/4 ~ 1/3ã€‚ å¹¶ä¸æ˜¯æ¯ä¸ªæµè§ˆå™¨éƒ½æ”¯æŒgzipçš„ï¼Œå¦‚ä½•çŸ¥é“å®¢æˆ·ç«¯æ˜¯å¦æ”¯æŒgzipå‘¢ï¼Œè¯·æ±‚å¤´ä¸­çš„Accept-Encodingæ¥æ ‡è¯†å¯¹å‹ç¼©çš„æ”¯æŒã€‚ å¯ç”¨gzipåŒæ—¶éœ€è¦å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„æ”¯æŒï¼Œå¦‚æœå®¢æˆ·ç«¯æ”¯æŒgzipçš„è§£æï¼Œé‚£ä¹ˆåªè¦æœåŠ¡ç«¯èƒ½å¤Ÿè¿”å›gzipçš„æ–‡ä»¶å°±å¯ä»¥å¯ç”¨gzipäº†,æˆ‘ä»¬å¯ä»¥é€šè¿‡nginxçš„é…ç½®æ¥è®©æœåŠ¡ç«¯æ”¯æŒgzipã€‚ä¸‹é¢çš„responeä¸­content-encoding:gzipï¼ŒæŒ‡æœåŠ¡ç«¯å¼€å¯äº†gzipçš„å‹ç¼©æ–¹å¼ã€‚ 12345gzip on;gzip_http_version 1.1; gzip_comp_level 5;gzip_min_length 1000;gzip_types text/csv text/xml text/css text/plain text/javascript application/javascript application/x-javascript application/json application/xml; gzip å¼€å¯æˆ–è€…å…³é—­gzipæ¨¡å— é»˜è®¤å€¼ä¸ºoff å¯é…ç½®ä¸ºon / off gzip_http_version å¯ç”¨ GZip æ‰€éœ€çš„HTTP æœ€ä½ç‰ˆæœ¬ é»˜è®¤å€¼ä¸ºHTTP/1.1 è¿™é‡Œä¸ºä»€ä¹ˆé»˜è®¤ç‰ˆæœ¬ä¸æ˜¯1.0å‘¢ï¼Ÿ HTTP è¿è¡Œåœ¨TCP è¿æ¥ä¹‹ä¸Šï¼Œè‡ªç„¶ä¹Ÿæœ‰ç€è·ŸTCP ä¸€æ ·çš„ä¸‰æ¬¡æ¡æ‰‹ã€æ…¢å¯åŠ¨ç­‰ç‰¹æ€§ã€‚ å¯ç”¨æŒä¹…è¿æ¥æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨å‘å‡ºå“åº”åè®©TCPè¿æ¥ç»§ç»­æ‰“å¼€ç€ã€‚åŒä¸€å¯¹å®¢æˆ·/æœåŠ¡å™¨ä¹‹é—´çš„åç»­è¯·æ±‚å’Œå“åº”å¯ä»¥é€šè¿‡è¿™ä¸ªè¿æ¥å‘é€ã€‚ ä¸ºäº†å°½å¯èƒ½çš„æé«˜ HTTP æ€§èƒ½ï¼Œä½¿ç”¨æŒä¹…è¿æ¥å°±æ˜¾å¾—å°¤ä¸ºé‡è¦äº†ã€‚ HTTP/1.1é»˜è®¤æ”¯æŒTCPæŒä¹…è¿æ¥ï¼ŒHTTP/1.0 ä¹Ÿå¯ä»¥é€šè¿‡æ˜¾å¼æŒ‡å®š Connection: keep-alive æ¥å¯ç”¨æŒä¹…è¿æ¥ã€‚å¯¹äºTCPæŒä¹…è¿æ¥ä¸Šçš„HTTP æŠ¥æ–‡ï¼Œå®¢æˆ·ç«¯éœ€è¦ä¸€ç§æœºåˆ¶æ¥å‡†ç¡®åˆ¤æ–­ç»“æŸä½ç½®ï¼Œè€Œåœ¨ HTTP/1.0ä¸­ï¼Œè¿™ç§æœºåˆ¶åªæœ‰Content-Lengthã€‚è€Œåœ¨HTTP/1.1ä¸­æ–°å¢çš„ Transfer-Encoding: chunked æ‰€å¯¹åº”çš„åˆ†å—ä¼ è¾“æœºåˆ¶å¯ä»¥å®Œç¾è§£å†³è¿™ç±»é—®é¢˜ã€‚ nginxåŒæ ·æœ‰ç€é…ç½®chunkedçš„å±æ€§chunked_transfer_encodingï¼Œè¿™ä¸ªå±æ€§æ˜¯é»˜è®¤å¼€å¯çš„ã€‚ Nginxåœ¨å¯ç”¨äº†GZipçš„æƒ…å†µä¸‹ï¼Œä¸ä¼šç­‰æ–‡ä»¶ GZip å®Œæˆå†è¿”å›å“åº”ï¼Œè€Œæ˜¯è¾¹å‹ç¼©è¾¹å“åº”ï¼Œè¿™æ ·å¯ä»¥æ˜¾è‘—æé«˜ TTFB(Time To First Byteï¼Œé¦–å­—èŠ‚æ—¶é—´ï¼ŒWEB æ€§èƒ½ä¼˜åŒ–é‡è¦æŒ‡æ ‡)ã€‚è¿™æ ·å”¯ä¸€çš„é—®é¢˜æ˜¯ï¼ŒNginx å¼€å§‹è¿”å›å“åº”æ—¶ï¼Œå®ƒæ— æ³•çŸ¥é“å°†è¦ä¼ è¾“çš„æ–‡ä»¶æœ€ç»ˆæœ‰å¤šå¤§ï¼Œä¹Ÿå°±æ˜¯æ— æ³•ç»™å‡ºContent-Lengthè¿™ä¸ªå“åº”å¤´éƒ¨ã€‚ æ‰€ä»¥ï¼Œåœ¨HTTP1.0ä¸­å¦‚æœåˆ©ç”¨Nginxå¯ç”¨äº†GZipï¼Œæ˜¯æ— æ³•è·å¾—Content-Lengthçš„ï¼Œè¿™å¯¼è‡´HTTP1.0ä¸­å¼€å¯æŒä¹…é“¾æ¥å’Œä½¿ç”¨GZipåªèƒ½äºŒé€‰ä¸€ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œgzip_http_versioné»˜è®¤è®¾ç½®ä¸º1.1ã€‚ gzip_comp_level å‹ç¼©çº§åˆ«ï¼Œçº§åˆ«è¶Šé«˜å‹ç¼©ç‡è¶Šå¤§ï¼Œå½“ç„¶å‹ç¼©æ—¶é—´ä¹Ÿå°±è¶Šé•¿ï¼ˆä¼ è¾“å¿«ä½†æ¯”è¾ƒæ¶ˆè€—cpuï¼‰ã€‚ é»˜è®¤å€¼ä¸º 1 å‹ç¼©çº§åˆ«å–å€¼ä¸º1-9 gzip_min_length è®¾ç½®å…è®¸å‹ç¼©çš„é¡µé¢æœ€å°å­—èŠ‚æ•°ï¼ŒContent-Lengthå°äºè¯¥å€¼çš„è¯·æ±‚å°†ä¸ä¼šè¢«å‹ç¼© é»˜è®¤å€¼:0 å½“è®¾ç½®çš„å€¼è¾ƒå°æ—¶ï¼Œå‹ç¼©åçš„é•¿åº¦å¯èƒ½æ¯”åŸæ–‡ä»¶å¤§ï¼Œå»ºè®®è®¾ç½®1000ä»¥ä¸Š gzip_types è¦é‡‡ç”¨gzipå‹ç¼©çš„æ–‡ä»¶ç±»å‹(MIMEç±»å‹) é»˜è®¤å€¼:text/html(é»˜è®¤ä¸å‹ç¼©js/css) è´Ÿè½½å‡è¡¡ä»€ä¹ˆæ˜¯è´Ÿè½½å‡è¡¡ å¦‚ä¸Šé¢çš„å›¾ï¼Œå‰é¢æ˜¯ä¼—å¤šçš„æœåŠ¡çª—å£ï¼Œä¸‹é¢æœ‰å¾ˆå¤šç”¨æˆ·éœ€è¦æœåŠ¡ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå·¥å…·æˆ–ç­–ç•¥æ¥å¸®åŠ©æˆ‘ä»¬å°†å¦‚æ­¤å¤šçš„ç”¨æˆ·åˆ†é…åˆ°æ¯ä¸ªçª—å£ï¼Œæ¥è¾¾åˆ°èµ„æºçš„å……åˆ†åˆ©ç”¨ä»¥åŠæ›´å°‘çš„æ’é˜Ÿæ—¶é—´ã€‚ æŠŠå‰é¢çš„æœåŠ¡çª—å£æƒ³åƒæˆæˆ‘ä»¬çš„åç«¯æœåŠ¡å™¨ï¼Œè€Œåé¢ç»ˆç«¯çš„äººåˆ™æ˜¯æ— æ•°ä¸ªå®¢æˆ·ç«¯æ­£åœ¨å‘èµ·è¯·æ±‚ã€‚è´Ÿè½½å‡è¡¡å°±æ˜¯ç”¨æ¥å¸®åŠ©æˆ‘ä»¬å°†ä¼—å¤šçš„å®¢æˆ·ç«¯è¯·æ±‚åˆç†çš„åˆ†é…åˆ°å„ä¸ªæœåŠ¡å™¨ï¼Œä»¥è¾¾åˆ°æœåŠ¡ç«¯èµ„æºçš„å……åˆ†åˆ©ç”¨å’Œæ›´å°‘çš„è¯·æ±‚æ—¶é—´ã€‚ nginxå¦‚ä½•å®ç°è´Ÿè½½å‡è¡¡UpstreamæŒ‡å®šåç«¯æœåŠ¡å™¨åœ°å€åˆ—è¡¨ 12345upstream balanceServer &#123; server 10.1.22.33:12345; server 10.1.22.34:12345; server 10.1.22.35:12345;&#125; åœ¨serverä¸­æ‹¦æˆªå“åº”è¯·æ±‚ï¼Œå¹¶å°†è¯·æ±‚è½¬å‘åˆ°Upstreamä¸­é…ç½®çš„æœåŠ¡å™¨åˆ—è¡¨ã€‚ 1234567server &#123; server_name fe.server.com; listen 80; location /api &#123; proxy_pass http://balanceServer; &#125;&#125; ä¸Šé¢çš„é…ç½®åªæ˜¯æŒ‡å®šäº†nginxéœ€è¦è½¬å‘çš„æœåŠ¡ç«¯åˆ—è¡¨ï¼Œå¹¶æ²¡æœ‰æŒ‡å®šåˆ†é…ç­–ç•¥ã€‚ nginxå®ç°è´Ÿè½½å‡è¡¡çš„ç­–ç•¥ è½®è¯¢ç­–ç•¥ é»˜è®¤æƒ…å†µä¸‹é‡‡ç”¨çš„ç­–ç•¥ï¼Œå°†æ‰€æœ‰å®¢æˆ·ç«¯è¯·æ±‚è½®è¯¢åˆ†é…ç»™æœåŠ¡ç«¯ã€‚è¿™ç§ç­–ç•¥æ˜¯å¯ä»¥æ­£å¸¸å·¥ä½œçš„ï¼Œä½†æ˜¯å¦‚æœå…¶ä¸­æŸä¸€å°æœåŠ¡å™¨å‹åŠ›å¤ªå¤§ï¼Œå‡ºç°å»¶è¿Ÿï¼Œä¼šå½±å“æ‰€æœ‰åˆ†é…åœ¨è¿™å°æœåŠ¡å™¨ä¸‹çš„ç”¨æˆ·ã€‚ 12345upstream balanceServer &#123; server 10.1.22.33:12345; server 10.1.22.34:12345; server 10.1.22.35:12345;&#125; æœ€å°è¿æ¥æ•°ç­–ç•¥ å°†è¯·æ±‚ä¼˜å…ˆåˆ†é…ç»™å‹åŠ›è¾ƒå°çš„æœåŠ¡å™¨ï¼Œå®ƒå¯ä»¥å¹³è¡¡æ¯ä¸ªé˜Ÿåˆ—çš„é•¿åº¦ï¼Œå¹¶é¿å…å‘å‹åŠ›å¤§çš„æœåŠ¡å™¨æ·»åŠ æ›´å¤šçš„è¯·æ±‚ã€‚ 123456upstream balanceServer &#123; least_conn; server 10.1.22.33:12345; server 10.1.22.34:12345; server 10.1.22.35:12345;&#125; æœ€å¿«å“åº”æ—¶é—´ç­–ç•¥ ä¾èµ–äºNGINX Plusï¼Œä¼˜å…ˆåˆ†é…ç»™å“åº”æ—¶é—´æœ€çŸ­çš„æœåŠ¡å™¨ã€‚ 123456upstream balanceServer &#123; fair; server 10.1.22.33:12345; server 10.1.22.34:12345; server 10.1.22.35:12345;&#125; å®¢æˆ·ç«¯ipç»‘å®š æ¥è‡ªåŒä¸€ä¸ªipçš„è¯·æ±‚æ°¸è¿œåªåˆ†é…ä¸€å°æœåŠ¡å™¨ï¼Œæœ‰æ•ˆè§£å†³äº†åŠ¨æ€ç½‘é¡µå­˜åœ¨çš„sessionå…±äº«é—®é¢˜ã€‚123456upstream balanceServer &#123; ip_hash; server 10.1.22.33:12345; server 10.1.22.34:12345; server 10.1.22.35:12345;&#125; é™æ€èµ„æºæœåŠ¡å™¨123456location ~* \\.(png|gif|jpg|jpeg)$ &#123; root /root/static/; autoindex on; access_log off; expires 10h;# è®¾ç½®è¿‡æœŸæ—¶é—´ä¸º10å°æ—¶ &#125; åŒ¹é…ä»¥png|gif|jpg|jpegä¸ºç»“å°¾çš„è¯·æ±‚ï¼Œå¹¶å°†è¯·æ±‚è½¬å‘åˆ°æœ¬åœ°è·¯å¾„ï¼Œrootä¸­æŒ‡å®šçš„è·¯å¾„å³nginxæœ¬åœ°è·¯å¾„ã€‚åŒæ—¶ä¹Ÿå¯ä»¥è¿›è¡Œä¸€äº›ç¼“å­˜çš„è®¾ç½®ã€‚ å°ç»“nginxçš„åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œè¿˜æœ‰å¾ˆå¤šéœ€è¦æ¢ç´¢ï¼Œä¸Šé¢çš„ä¸€äº›é…ç½®éƒ½æ˜¯å…¬å¸é…ç½®çš„çœŸå®åº”ç”¨ï¼ˆç²¾ç®€è¿‡äº†ï¼‰ï¼Œå¦‚æœæ‚¨æœ‰ä»€ä¹ˆæ„è§æˆ–è€…å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹ç•™è¨€â€¦","categories":[],"tags":[{"name":"nginx","slug":"nginx","permalink":"https://www.lisq.xyz/tags/nginx/"}]},{"title":"æ·±å…¥åˆ†æå‰ç«¯å°æ•°è®¡ç®—é—®é¢˜","slug":"ã€JavaScriptã€‘æ·±å…¥åˆ†æå‰ç«¯å°æ•°è®¡ç®—é—®é¢˜","date":"2019-03-06T08:22:51.000Z","updated":"2019-04-06T05:28:05.940Z","comments":true,"path":"2019/03/06/ã€JavaScriptã€‘æ·±å…¥åˆ†æå‰ç«¯å°æ•°è®¡ç®—é—®é¢˜/","link":"","permalink":"https://www.lisq.xyz/2019/03/06/ã€JavaScriptã€‘æ·±å…¥åˆ†æå‰ç«¯å°æ•°è®¡ç®—é—®é¢˜/","excerpt":"","text":"è¯ä¸å¤šè¯´ï¼Œå…ˆä¸Šä»£ç 12345678910111213141516171819202122232425262728function judgeFloat(n, m) &#123; const binaryN = n.toString(2); const binaryM = m.toString(2); console.log(`$&#123;n&#125;çš„äºŒè¿›åˆ¶æ˜¯ $&#123;binaryN&#125;`); console.log(`$&#123;m&#125;çš„äºŒè¿›åˆ¶æ˜¯ $&#123;binaryM&#125;`); const MN = m + n; const accuracyMN = (m * 100 + n * 100) / 100; const binaryMN = MN.toString(2); const accuracyBinaryMN = accuracyMN.toString(2); console.log(`$&#123;n&#125;+$&#123;m&#125;çš„äºŒè¿›åˆ¶æ˜¯$&#123;binaryMN&#125;`); console.log(`$&#123;accuracyMN&#125;çš„äºŒè¿›åˆ¶æ˜¯ $&#123;accuracyBinaryMN&#125;`); console.log(`$&#123;n&#125;+$&#123;m&#125;çš„äºŒè¿›åˆ¶å†è½¬æˆåè¿›åˆ¶æ˜¯$&#123;to10(binaryMN)&#125;`); console.log(`$&#123;accuracyMN&#125;çš„äºŒè¿›åˆ¶æ˜¯å†è½¬æˆåè¿›åˆ¶æ˜¯$&#123;to10(accuracyBinaryMN)&#125;`); console.log(`$&#123;n&#125;+$&#123;m&#125;åœ¨jsä¸­è®¡ç®—æ˜¯$&#123;(to10(binaryMN) === to10(accuracyBinaryMN)) ? '' : 'ä¸'&#125;å‡†ç¡®çš„`);&#125;function to10(n) &#123; const pre = (n.split('.')[0] - 0).toString(2); const arr = n.split('.')[1].split(''); let i = 0; let result = 0; while (i &lt; arr.length) &#123; result += arr[i] * Math.pow(2, -(i + 1)); i++; &#125; return result;&#125;judgeFloat(0.1, 0.2);judgeFloat(0.6, 0.7); ç”±äºJavaScriptä¸­æ²¡æœ‰å°†å°æ•°çš„äºŒè¿›åˆ¶è½¬æ¢æˆåè¿›åˆ¶çš„æ–¹æ³•ï¼Œäºæ˜¯æ‰‹åŠ¨å®ç°äº†ä¸€ä¸ªã€‚ å…ˆæ¥ä¸€ä¸ªç®€å•çš„ç»“è®ºè®¡ç®—æœºä¸­æ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯ä»¥äºŒè¿›åˆ¶å­˜å‚¨çš„ï¼Œæ‰€ä»¥åœ¨è®¡ç®—æ—¶è®¡ç®—æœºè¦æŠŠæ•°æ®å…ˆè½¬æ¢æˆäºŒè¿›åˆ¶è¿›è¡Œè®¡ç®—ï¼Œç„¶ååœ¨æŠŠè®¡ç®—ç»“æœè½¬æ¢æˆåè¿›åˆ¶ã€‚ ç”±ä¸Šé¢çš„ä»£ç ä¸éš¾çœ‹å‡ºï¼Œåœ¨è®¡ç®—0.1+0.2æ—¶ï¼ŒäºŒè¿›åˆ¶è®¡ç®—å‘ç”Ÿäº†ç²¾åº¦ä¸¢å¤±ï¼Œå¯¼è‡´å†è½¬æ¢æˆåè¿›åˆ¶åå’Œé¢„è®¡çš„ç»“æœä¸ç¬¦ã€‚ å…¶å®æœ‰äº›æ ‡é¢˜å…šäº†ï¼Œä¸€ä¸ªå‡½æ•°å¹¶ä¸èƒ½è®©ä½ æ·±å…¥ç†è§£ï¼Œè¿˜å¾—ç»§ç»­çœ‹ä¸‹é¢â€¦ å¯¹ç»“æœçš„åˆ†æâ€”æ›´å¤šçš„é—®é¢˜0.1å’Œ0.2çš„äºŒè¿›åˆ¶éƒ½æ˜¯ä»¥1100æ— é™å¾ªç¯çš„å°æ•°ï¼Œä¸‹é¢é€ä¸ªæ¥çœ‹JSå¸®æˆ‘ä»¬è®¡ç®—æ‰€å¾—çš„ç»“æœï¼š 0.1çš„äºŒè¿›åˆ¶ï¼š 10.0001100110011001100110011001100110011001100110011001101 0.2çš„äºŒè¿›åˆ¶ï¼š10.001100110011001100110011001100110011001100110011001101 ç†è®ºä¸Šè®²ï¼Œç”±ä¸Šé¢çš„ç»“æœç›¸åŠ åº”è¯¥ï¼šï¼š 10.0100110011001100110011001100110011001100110011001100111 å®é™…JSè®¡ç®—å¾—åˆ°çš„0.1+0.2çš„äºŒè¿›åˆ¶ 10.0100110011001100110011001100110011001100110011001101 ä½œä¸ºä¸€ä¸ªä»£ç å¼ºè¿«ç—‡çš„æˆ‘åˆäº§ç”Ÿçš„æ–°çš„é—®é¢˜ï¼š Why jsè®¡ç®—å‡ºçš„ 0.1çš„äºŒè¿›åˆ¶ æ˜¯è¿™ä¹ˆå¤šä½è€Œä¸æ˜¯æ›´å¤šä½ï¼Ÿï¼Ÿï¼Ÿ Why jsè®¡ç®—çš„ï¼ˆ0.1+0.2ï¼‰çš„äºŒè¿›åˆ¶å’Œæˆ‘ä»¬è‡ªå·±è®¡ç®—çš„ï¼ˆ0.1+0.2ï¼‰çš„äºŒè¿›åˆ¶ç»“æœä¸ä¸€æ ·å‘¢ï¼Ÿï¼Ÿï¼Ÿ Why 0.1çš„äºŒè¿›åˆ¶ + 0.2çš„äºŒè¿›åˆ¶ != 0.3çš„äºŒè¿›åˆ¶ï¼Ÿï¼Ÿï¼Ÿ jså¯¹äºŒè¿›åˆ¶å°æ•°çš„å­˜å‚¨æ–¹å¼å°æ•°çš„äºŒè¿›åˆ¶å¤§å¤šæ•°éƒ½æ˜¯æ— é™å¾ªç¯çš„ï¼ŒJavaScriptæ˜¯æ€ä¹ˆæ¥å­˜å‚¨ä»–ä»¬çš„å‘¢ï¼Ÿ åœ¨ECMAScriptÂ®è¯­è¨€è§„èŒƒä¸­å¯ä»¥çœ‹åˆ°ï¼ŒECMAScriptä¸­çš„Numberç±»å‹éµå¾ªIEEE 754æ ‡å‡†ã€‚ä½¿ç”¨64ä½å›ºå®šé•¿åº¦æ¥è¡¨ç¤ºã€‚ äº‹å®ä¸Šæœ‰å¾ˆå¤šè¯­è¨€çš„æ•°å­—ç±»å‹éƒ½éµå¾ªè¿™ä¸ªæ ‡å‡†ï¼Œä¾‹å¦‚JAVA,æ‰€ä»¥å¾ˆå¤šè¯­è¨€åŒæ ·æœ‰ç€ä¸Šé¢åŒæ ·çš„é—®é¢˜ã€‚ æ‰€ä»¥ä¸‹æ¬¡é‡åˆ°è¿™ç§é—®é¢˜ä¸è¦ä¸Šæ¥å°±å–·JavaScriptâ€¦ æœ‰å…´è¶£å¯ä»¥çœ‹çœ‹ä¸‹è¿™ä¸ªç½‘ç«™http://0.30000000000000004.com/ï¼Œæ˜¯çš„ï¼Œä½ æ²¡çœ‹é”™ï¼Œå°±æ˜¯http://0.30000000000000004.com/ï¼ï¼ï¼ IEEE 754IEEE754æ ‡å‡†åŒ…å«ä¸€ç»„å®æ•°çš„äºŒè¿›åˆ¶è¡¨ç¤ºæ³•ã€‚å®ƒæœ‰ä¸‰éƒ¨åˆ†ç»„æˆï¼š ç¬¦å·ä½ æŒ‡æ•°ä½ å°¾æ•°ä½ ä¸‰ç§ç²¾åº¦çš„æµ®ç‚¹æ•°å„ä¸ªéƒ¨åˆ†ä½æ•°å¦‚ä¸‹ï¼š JavaScriptä½¿ç”¨çš„æ˜¯64ä½åŒç²¾åº¦æµ®ç‚¹æ•°ç¼–ç ï¼Œæ‰€ä»¥å®ƒçš„ç¬¦å·ä½å 1ä½ï¼ŒæŒ‡æ•°ä½å 11ä½ï¼Œå°¾æ•°ä½å 52ä½ã€‚ ä¸‹é¢æˆ‘ä»¬åœ¨ç†è§£ä¸‹ä»€ä¹ˆæ˜¯ç¬¦å·ä½ã€æŒ‡æ•°ä½ã€å°¾æ•°ä½ï¼Œä»¥0.1ä¸ºä¾‹ï¼š å®ƒçš„äºŒè¿›åˆ¶ä¸ºï¼š0.0001100110011001100... ä¸ºäº†èŠ‚çœå­˜å‚¨ç©ºé—´ï¼Œåœ¨è®¡ç®—æœºä¸­å®ƒæ˜¯ä»¥ç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºçš„ï¼Œä¹Ÿå°±æ˜¯ 1.100110011001100... X 2-4 å¦‚æœè¿™é‡Œä¸å¥½ç†è§£å¯ä»¥æƒ³ä¸€ä¸‹åè¿›åˆ¶çš„æ•°ï¼š 1100çš„ç§‘å­¦è®¡æ•°æ³•ä¸º11 X 102 æ‰€ä»¥ï¼š ç¬¦å·ä½å°±æ˜¯æ ‡è¯†æ­£è´Ÿçš„ï¼Œ1è¡¨ç¤ºè´Ÿï¼Œ0è¡¨ç¤ºæ­£ï¼› æŒ‡æ•°ä½å­˜å‚¨ç§‘å­¦è®¡æ•°æ³•çš„æŒ‡æ•°ï¼› å°¾æ•°ä½å­˜å‚¨ç§‘å­¦è®¡æ•°æ³•åçš„æœ‰æ•ˆæ•°å­—ï¼› æ‰€ä»¥æˆ‘ä»¬é€šå¸¸çœ‹åˆ°çš„äºŒè¿›åˆ¶ï¼Œå…¶å®æ˜¯è®¡ç®—æœºå®é™…å­˜å‚¨çš„å°¾æ•°ä½ã€‚ jsä¸­çš„toString(2)ç”±äºå°¾æ•°ä½åªèƒ½å­˜å‚¨52ä¸ªæ•°å­—ï¼Œè¿™å°±èƒ½è§£é‡ŠtoString(2)çš„æ‰§è¡Œç»“æœäº†ï¼š å¦‚æœè®¡ç®—æœºæ²¡æœ‰å­˜å‚¨ç©ºé—´çš„é™åˆ¶ï¼Œé‚£ä¹ˆ0.1çš„äºŒè¿›åˆ¶åº”è¯¥æ˜¯ï¼š10.00011001100110011001100110011001100110011001100110011001... ç§‘å­¦è®¡æ•°æ³•å°¾æ•°ä½ 11.1001100110011001100110011001100110011001100110011001... ä½†æ˜¯ç”±äºé™åˆ¶ï¼Œæœ‰æ•ˆæ•°å­—ç¬¬53ä½åŠä»¥åçš„æ•°å­—æ˜¯ä¸èƒ½å­˜å‚¨çš„ï¼Œå®ƒéµå¾ªï¼Œå¦‚æœæ˜¯1å°±å‘å‰ä¸€ä½è¿›1ï¼Œå¦‚æœæ˜¯0å°±èˆå¼ƒçš„åŸåˆ™ã€‚ 0.1çš„äºŒè¿›åˆ¶ç§‘å­¦è®¡æ•°æ³•ç¬¬53ä½æ˜¯1ï¼Œæ‰€ä»¥å°±æœ‰äº†ä¸‹é¢çš„ç»“æœï¼š 10.0001100110011001100110011001100110011001100110011001101 0.2æœ‰ç€åŒæ ·çš„é—®é¢˜ï¼Œå…¶å®æ­£æ˜¯ç”±äºè¿™æ ·çš„å­˜å‚¨ï¼Œåœ¨è¿™é‡Œæœ‰äº†ç²¾åº¦ä¸¢å¤±ï¼Œå¯¼è‡´äº†0.1+0.2!=0.3ã€‚ äº‹å®ä¸Šæœ‰ç€åŒæ ·ç²¾åº¦é—®é¢˜çš„è®¡ç®—è¿˜æœ‰å¾ˆå¤šï¼Œæˆ‘ä»¬æ— æ³•æŠŠä»–ä»¬éƒ½è®°ä¸‹æ¥ï¼Œæ‰€ä»¥å½“ç¨‹åºä¸­æœ‰æ•°å­—è®¡ç®—æ—¶ï¼Œæˆ‘ä»¬æœ€å¥½ç”¨å·¥å…·åº“æ¥å¸®åŠ©æˆ‘ä»¬è§£å†³ï¼Œä¸‹é¢æ˜¯ä¸¤ä¸ªæ¨èä½¿ç”¨çš„å¼€æºåº“ï¼š number-precision mathjs/ ä¸‹é¢æˆ‘ä»¬å†æ¥çœ‹ä¸Šé¢çš„å…¶ä»–ä¸¤ä¸ªé—®é¢˜ã€‚ Why JavaScriptè®¡ç®—å‡ºçš„ 0.1çš„äºŒè¿›åˆ¶ æ˜¯è¿™ä¹ˆå¤šä½è€Œä¸æ˜¯æ›´å¤šä½ï¼Ÿï¼Ÿï¼Ÿä¸Šé¢çš„toStringåŸç†å¸®æˆ‘ä»¬è§£ç­”äº†è¿™ä¸ªé—®é¢˜ï¼Œåœ¨æœ‰æ•ˆæ•°å­—ç¬¬53ä½ä»¥åçš„æ•°å­—å°†éµå¾ª1è¿›0èˆçš„åŸåˆ™ï¼Œå†…å­˜ä¸­åªå…è®¸å­˜å‚¨52ä½æœ‰æ•ˆæ•°å­—ã€‚ Why JavaScriptè®¡ç®—çš„ï¼ˆ0.1+0.2ï¼‰çš„äºŒè¿›åˆ¶å’Œæˆ‘ä»¬è‡ªå·±è®¡ç®—çš„ï¼ˆ0.1+0.2ï¼‰çš„äºŒè¿›åˆ¶ç»“æœä¸ä¸€æ ·å‘¢ï¼Ÿï¼Ÿï¼Ÿæˆ‘ä»¬è‡ªå·±è®¡ç®—çš„0.1+0.2ï¼šï¼š 10.0100110011001100110011001100110011001100110011001100111 å®é™…ä¸Šè¿™ä¸ªç»“æœçš„æœ‰æ•ˆæ•°å­—å·²ç»è¶…è¿‡äº†52ä½ï¼Œæˆ‘ä»¬è¦ä»æœ«å°¾è¿›è¡Œ1è¿›0èˆå¾—åˆ°ä¸‹é¢çš„ç»“æœ 10.0100110011001100110011001100110011001100110011001101 JavaScriptèƒ½è¡¨ç¤ºçš„æœ€å¤§æ•°å­—ç”±ä¸IEEE 754åŒç²¾åº¦64ä½è§„èŒƒçš„é™åˆ¶ï¼š æŒ‡æ•°ä½èƒ½è¡¨ç¤ºçš„æœ€å¤§æ•°å­—ï¼š1023(åè¿›åˆ¶) å°¾æ•°ä½èƒ½è¡¨è¾¾çš„æœ€å¤§æ•°å­—å³å°¾æ•°ä½éƒ½ä½1çš„æƒ…å†µ æ‰€ä»¥JavaScriptèƒ½è¡¨ç¤ºçš„æœ€å¤§æ•°å­—å³ä½ 1.111...X 21023 è¿™ä¸ªç»“æœè½¬æ¢æˆåè¿›åˆ¶æ˜¯1.7976931348623157e+308,è¿™ä¸ªç»“æœå³ä¸ºNumber.MAX_VALUEã€‚ æœ€å¤§å®‰å…¨æ•°å­—JavaScriptä¸­Number.MAX_SAFE_INTEGERè¡¨ç¤ºæœ€å¤§å®‰å…¨æ•°å­—,è®¡ç®—ç»“æœæ˜¯9007199254740991ï¼Œå³åœ¨è¿™ä¸ªæ•°èŒƒå›´å†…ä¸ä¼šå‡ºç°ç²¾åº¦ä¸¢å¤±ï¼ˆå°æ•°é™¤å¤–ï¼‰,è¿™ä¸ªæ•°å®é™…ä¸Šæ˜¯1.111...X 252ã€‚ æˆ‘ä»¬åŒæ ·å¯ä»¥ç”¨ä¸€äº›å¼€æºåº“æ¥å¤„ç†å¤§æ•´æ•°ï¼š node-bignum node-bigint å…¶å®å®˜æ–¹ä¹Ÿè€ƒè™‘åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼ŒbigIntç±»å‹åœ¨es10ä¸­è¢«æå‡ºï¼Œç°åœ¨Chromeä¸­å·²ç»å¯ä»¥ä½¿ç”¨ã€‚ bigIntç±»å‹BigInt æ˜¯ç¬¬ä¸ƒç§åŸå§‹ç±»å‹ã€‚ BigInt æ˜¯ä¸€ä¸ªä»»æ„ç²¾åº¦çš„æ•´æ•°ã€‚è¿™æ„å‘³ç€å˜é‡ç°åœ¨å¯ä»¥è®¡ç®—9007199254740991å³æœ€å¤§å®‰å…¨æ•´æ•°ä»¥ä¸Šçš„æ•°å­—ã€‚ 1const b = 1n; // è¿½åŠ  n ä»¥åˆ›å»º BigInt åœ¨è¿‡å»ï¼Œä¸æ”¯æŒå¤§äº 9007199254740992 çš„æ•´æ•°å€¼ã€‚å¦‚æœè¶…è¿‡ï¼Œè¯¥å€¼å°†é”å®šä¸ºMAX_SAFE_INTEGER + 1: 123456789101112const limit = Number.MAX_SAFE_INTEGER;â‡¨ 9007199254740991limit + 1;â‡¨ 9007199254740992limit + 2;â‡¨ 9007199254740992 &lt;--- MAX_SAFE_INTEGER + 1 exceededconst larger = 9007199254740991n;â‡¨ 9007199254740991nconst integer = BigInt(9007199254740991); // initialize with numberâ‡¨ 9007199254740991nconst same = BigInt(&quot;9007199254740991&quot;); // initialize with &quot;string&quot;â‡¨ 9007199254740991n typeof1234typeof 10;â‡¨ &apos;number&apos;typeof 10n;â‡¨ &apos;bigint&apos;","categories":[],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"https://www.lisq.xyz/tags/JavaScript/"}]},{"title":"ã€Reactæ·±å…¥ã€‘Reactäº‹ä»¶æœºåˆ¶","slug":"ã€Reactæ·±å…¥ã€‘Reactäº‹ä»¶æœºåˆ¶","date":"2019-03-06T08:19:35.000Z","updated":"2019-04-06T05:13:09.693Z","comments":true,"path":"2019/03/06/ã€Reactæ·±å…¥ã€‘Reactäº‹ä»¶æœºåˆ¶/","link":"","permalink":"https://www.lisq.xyz/2019/03/06/ã€Reactæ·±å…¥ã€‘Reactäº‹ä»¶æœºåˆ¶/","excerpt":"","text":"å…³äºReactäº‹ä»¶çš„ç–‘é—® 1.ä¸ºä»€ä¹ˆè¦æ‰‹åŠ¨ç»‘å®šthis 2.Reactäº‹ä»¶å’ŒåŸç”Ÿäº‹ä»¶æœ‰ä»€ä¹ˆåŒºåˆ« 3.Reactäº‹ä»¶å’ŒåŸç”Ÿäº‹ä»¶çš„æ‰§è¡Œé¡ºåºï¼Œå¯ä»¥æ··ç”¨å— 4.Reactäº‹ä»¶å¦‚ä½•è§£å†³è·¨æµè§ˆå™¨å…¼å®¹ 5.ä»€ä¹ˆæ˜¯åˆæˆäº‹ä»¶ ä¸‹é¢æ˜¯æˆ‘é˜…è¯»è¿‡æºç åï¼Œå°†æ‰€æœ‰çš„æ‰§è¡Œæµç¨‹æ€»ç»“å‡ºæ¥çš„æµç¨‹å›¾ï¼Œä¸ä¼šè´´ä»£ç ï¼Œå¦‚æœä½ æƒ³é˜…è¯»ä»£ç çœ‹çœ‹å…·ä½“æ˜¯å¦‚ä½•å®ç°çš„ï¼Œå¯ä»¥æ ¹æ®æµç¨‹å›¾å»æºç é‡Œå¯»æ‰¾ã€‚ äº‹ä»¶æ³¨å†Œ ç»„ä»¶è£…è½½ / æ›´æ–°ã€‚ é€šè¿‡lastPropsã€nextPropsåˆ¤æ–­æ˜¯å¦æ–°å¢ã€åˆ é™¤äº‹ä»¶åˆ†åˆ«è°ƒç”¨äº‹ä»¶æ³¨å†Œã€å¸è½½æ–¹æ³•ã€‚ è°ƒç”¨EventPluginHubçš„enqueuePutListenerè¿›è¡Œäº‹ä»¶å­˜å‚¨ è·å–documentå¯¹è±¡ã€‚ æ ¹æ®äº‹ä»¶åç§°ï¼ˆå¦‚onClickã€onCaptureClickï¼‰åˆ¤æ–­æ˜¯è¿›è¡Œå†’æ³¡è¿˜æ˜¯æ•è·ã€‚ åˆ¤æ–­æ˜¯å¦å­˜åœ¨addEventListeneræ–¹æ³•ï¼Œå¦åˆ™ä½¿ç”¨attachEventï¼ˆå…¼å®¹IEï¼‰ã€‚ ç»™documentæ³¨å†ŒåŸç”Ÿäº‹ä»¶å›è°ƒä¸ºdispatchEventï¼ˆç»Ÿä¸€çš„äº‹ä»¶åˆ†å‘æœºåˆ¶ï¼‰ã€‚ äº‹ä»¶å­˜å‚¨ EventPluginHubè´Ÿè´£ç®¡ç†Reactåˆæˆäº‹ä»¶çš„callbackï¼Œå®ƒå°†callbackå­˜å‚¨åœ¨listenerBankä¸­ï¼Œå¦å¤–è¿˜å­˜å‚¨äº†è´Ÿè´£åˆæˆäº‹ä»¶çš„Pluginã€‚ EventPluginHubçš„putListeneræ–¹æ³•æ˜¯å‘å­˜å‚¨å®¹å™¨ä¸­å¢åŠ ä¸€ä¸ªlistenerã€‚ è·å–ç»‘å®šäº‹ä»¶çš„å…ƒç´ çš„å”¯ä¸€æ ‡è¯†keyã€‚ å°†callbackæ ¹æ®äº‹ä»¶ç±»å‹ï¼Œå…ƒç´ çš„å”¯ä¸€æ ‡è¯†keyå­˜å‚¨åœ¨listenerBankä¸­ã€‚ listenerBankçš„ç»“æ„æ˜¯ï¼šlistenerBank[registrationName][key]ã€‚ ä¾‹å¦‚ï¼š 12345678910&#123; onClick:&#123; nodeid1:()=&gt;&#123;...&#125; nodeid2:()=&gt;&#123;...&#125; &#125;, onChange:&#123; nodeid3:()=&gt;&#123;...&#125; nodeid4:()=&gt;&#123;...&#125; &#125;&#125; äº‹ä»¶è§¦å‘ / æ‰§è¡Œ è¿™é‡Œçš„äº‹ä»¶æ‰§è¡Œåˆ©ç”¨äº†Reactçš„æ‰¹å¤„ç†æœºåˆ¶ï¼Œåœ¨å‰ä¸€ç¯‡çš„ã€Reactæ·±å…¥ã€‘setStateæ‰§è¡Œæœºåˆ¶ä¸­å·²ç»åˆ†æè¿‡ï¼Œè¿™é‡Œä¸å†å¤šåŠ åˆ†æã€‚ è§¦å‘documentæ³¨å†ŒåŸç”Ÿäº‹ä»¶çš„å›è°ƒdispatchEvent è·å–åˆ°è§¦å‘è¿™ä¸ªäº‹ä»¶æœ€æ·±ä¸€çº§çš„å…ƒç´  ä¾‹å¦‚ä¸‹é¢çš„ä»£ç ï¼šé¦–å…ˆä¼šè·å–åˆ°this.child 12345&lt;div onClick=&#123;this.parentClick&#125; ref=&#123;ref =&gt; this.parent = ref&#125;&gt; &lt;div onClick=&#123;this.childClick&#125; ref=&#123;ref =&gt; this.child = ref&#125;&gt; test &lt;/div&gt;&lt;/div&gt; éå†è¿™ä¸ªå…ƒç´ çš„æ‰€æœ‰çˆ¶å…ƒç´ ï¼Œä¾æ¬¡å¯¹æ¯ä¸€çº§å…ƒç´ è¿›è¡Œå¤„ç†ã€‚ æ„é€ åˆæˆäº‹ä»¶ã€‚ å°†æ¯ä¸€çº§çš„åˆæˆäº‹ä»¶å­˜å‚¨åœ¨eventQueueäº‹ä»¶é˜Ÿåˆ—ä¸­ã€‚ éå†eventQueueã€‚ é€šè¿‡isPropagationStoppedåˆ¤æ–­å½“å‰äº‹ä»¶æ˜¯å¦æ‰§è¡Œäº†é˜»æ­¢å†’æ³¡æ–¹æ³•ã€‚ å¦‚æœé˜»æ­¢äº†å†’æ³¡ï¼Œåœæ­¢éå†ï¼Œå¦åˆ™é€šè¿‡executeDispatchæ‰§è¡Œåˆæˆäº‹ä»¶ã€‚ é‡Šæ”¾å¤„ç†å®Œæˆçš„äº‹ä»¶ã€‚ reactåœ¨è‡ªå·±çš„åˆæˆäº‹ä»¶ä¸­é‡å†™äº†stopPropagationæ–¹æ³•ï¼Œå°†isPropagationStoppedè®¾ç½®ä¸ºtrueï¼Œç„¶ååœ¨éå†æ¯ä¸€çº§äº‹ä»¶çš„è¿‡ç¨‹ä¸­æ ¹æ®æ­¤éå†åˆ¤æ–­æ˜¯å¦ç»§ç»­æ‰§è¡Œã€‚è¿™å°±æ˜¯reactè‡ªå·±å®ç°çš„å†’æ³¡æœºåˆ¶ã€‚ åˆæˆäº‹ä»¶ è°ƒç”¨EventPluginHubçš„extractEventsæ–¹æ³•ã€‚ å¾ªç¯æ‰€æœ‰ç±»å‹çš„EventPluginï¼ˆç”¨æ¥å¤„ç†ä¸åŒäº‹ä»¶çš„å·¥å…·æ–¹æ³•ï¼‰ã€‚ åœ¨æ¯ä¸ªEventPluginä¸­æ ¹æ®ä¸åŒçš„äº‹ä»¶ç±»å‹ï¼Œè¿”å›ä¸åŒçš„äº‹ä»¶æ± ã€‚ åœ¨äº‹ä»¶æ± ä¸­å–å‡ºåˆæˆäº‹ä»¶ï¼Œå¦‚æœäº‹ä»¶æ± æ˜¯ç©ºçš„ï¼Œé‚£ä¹ˆåˆ›å»ºä¸€ä¸ªæ–°çš„ã€‚ æ ¹æ®å…ƒç´ nodeid(å”¯ä¸€æ ‡è¯†key)å’Œäº‹ä»¶ç±»å‹ä»listenerBinkä¸­å–å‡ºå›è°ƒå‡½æ•° è¿”å›å¸¦æœ‰åˆæˆäº‹ä»¶å‚æ•°çš„å›è°ƒå‡½æ•° æ€»æµç¨‹å°†ä¸Šé¢çš„å››ä¸ªæµç¨‹ä¸²è”èµ·æ¥ã€‚ ä¸ºä»€ä¹ˆè¦æ‰‹åŠ¨ç»‘å®šthisé€šè¿‡äº‹ä»¶è§¦å‘è¿‡ç¨‹çš„åˆ†æï¼ŒdispatchEventè°ƒç”¨äº†invokeGuardedCallbackæ–¹æ³•ã€‚ 123456789function invokeGuardedCallback(name, func, a) &#123; try &#123; func(a); &#125; catch (x) &#123; if (caughtError === null) &#123; caughtError = x; &#125; &#125;&#125; å¯è§ï¼Œå›è°ƒå‡½æ•°æ˜¯ç›´æ¥è°ƒç”¨è°ƒç”¨çš„ï¼Œå¹¶æ²¡æœ‰æŒ‡å®šè°ƒç”¨çš„ç»„ä»¶ï¼Œæ‰€ä»¥ä¸è¿›è¡Œæ‰‹åŠ¨ç»‘å®šçš„æƒ…å†µä¸‹ç›´æ¥è·å–åˆ°çš„thisæ˜¯undefinedã€‚ è¿™é‡Œå¯ä»¥ä½¿ç”¨å®éªŒæ€§çš„å±æ€§åˆå§‹åŒ–è¯­æ³• ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥åœ¨ç»„ä»¶å£°æ˜ç®­å¤´å‡½æ•°ã€‚ç®­å¤´å‡½æ•°ä¸ä¼šåˆ›å»ºè‡ªå·±çš„thisï¼Œå®ƒåªä¼šä»è‡ªå·±çš„ä½œç”¨åŸŸé“¾çš„ä¸Šä¸€å±‚ç»§æ‰¿thisã€‚å› æ­¤è¿™æ ·æˆ‘ä»¬åœ¨Reactäº‹ä»¶ä¸­è·å–åˆ°çš„å°±æ˜¯ç»„ä»¶æœ¬èº«äº†ã€‚ å’ŒåŸç”Ÿäº‹ä»¶æœ‰ä»€ä¹ˆåŒºåˆ« React äº‹ä»¶ä½¿ç”¨é©¼å³°å‘½åï¼Œè€Œä¸æ˜¯å…¨éƒ¨å°å†™ã€‚ é€šè¿‡ JSX , ä½ ä¼ é€’ä¸€ä¸ªå‡½æ•°ä½œä¸ºäº‹ä»¶å¤„ç†ç¨‹åºï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ ä¾‹å¦‚ï¼ŒHTMLï¼š123&lt;button onclick=&quot;activateLasers()&quot;&gt; Activate Lasers&lt;/button&gt; åœ¨ React ä¸­ç•¥æœ‰ä¸åŒï¼š123&lt;button onClick=&#123;activateLasers&#125;&gt; Activate Lasers&lt;/button&gt; å¦ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼Œåœ¨ React ä¸­ä½ ä¸èƒ½é€šè¿‡è¿”å›false æ¥é˜»æ­¢é»˜è®¤è¡Œä¸ºã€‚å¿…é¡»æ˜ç¡®è°ƒç”¨ preventDefaultã€‚ ç”±ä¸Šé¢æ‰§è¡Œæœºåˆ¶æˆ‘ä»¬å¯ä»¥å¾—å‡ºï¼šReactè‡ªå·±å®ç°äº†ä¸€å¥—äº‹ä»¶æœºåˆ¶ï¼Œè‡ªå·±æ¨¡æ‹Ÿäº†äº‹ä»¶å†’æ³¡å’Œæ•è·çš„è¿‡ç¨‹ï¼Œé‡‡ç”¨äº†äº‹ä»¶ä»£ç†ï¼Œæ‰¹é‡æ›´æ–°ç­‰æ–¹æ³•ï¼Œå¹¶ä¸”æŠ¹å¹³äº†å„ä¸ªæµè§ˆå™¨çš„å…¼å®¹æ€§é—®é¢˜ã€‚ Reactäº‹ä»¶å’ŒåŸç”Ÿäº‹ä»¶çš„æ‰§è¡Œé¡ºåº12345678910111213141516171819202122232425262728componentDidMount() &#123; this.parent.addEventListener(&apos;click&apos;, (e) =&gt; &#123; console.log(&apos;dom parent&apos;); &#125;) this.child.addEventListener(&apos;click&apos;, (e) =&gt; &#123; console.log(&apos;dom child&apos;); &#125;) document.addEventListener(&apos;click&apos;, (e) =&gt; &#123; console.log(&apos;document&apos;); &#125;)&#125;childClick = (e) =&gt; &#123; console.log(&apos;react child&apos;);&#125;parentClick = (e) =&gt; &#123; console.log(&apos;react parent&apos;);&#125;render() &#123; return ( &lt;div onClick=&#123;this.parentClick&#125; ref=&#123;ref =&gt; this.parent = ref&#125;&gt; &lt;div onClick=&#123;this.childClick&#125; ref=&#123;ref =&gt; this.child = ref&#125;&gt; test &lt;/div&gt; &lt;/div&gt;)&#125; æ‰§è¡Œç»“æœï¼š ç”±ä¸Šé¢çš„æµç¨‹æˆ‘ä»¬å¯ä»¥ç†è§£ï¼š reactçš„æ‰€æœ‰äº‹ä»¶éƒ½æŒ‚è½½åœ¨documentä¸­ å½“çœŸå®domè§¦å‘åå†’æ³¡åˆ°documentåæ‰ä¼šå¯¹reactäº‹ä»¶è¿›è¡Œå¤„ç† æ‰€ä»¥åŸç”Ÿçš„äº‹ä»¶ä¼šå…ˆæ‰§è¡Œ ç„¶åæ‰§è¡Œreactåˆæˆäº‹ä»¶ æœ€åæ‰§è¡ŒçœŸæ­£åœ¨documentä¸ŠæŒ‚è½½çš„äº‹ä»¶ reactäº‹ä»¶å’ŒåŸç”Ÿäº‹ä»¶å¯ä»¥æ··ç”¨å—ï¼Ÿreactäº‹ä»¶å’ŒåŸç”Ÿäº‹ä»¶æœ€å¥½ä¸è¦æ··ç”¨ã€‚ åŸç”Ÿäº‹ä»¶ä¸­å¦‚æœæ‰§è¡Œäº†stopPropagationæ–¹æ³•ï¼Œåˆ™ä¼šå¯¼è‡´å…¶ä»–reactäº‹ä»¶å¤±æ•ˆã€‚å› ä¸ºæ‰€æœ‰å…ƒç´ çš„äº‹ä»¶å°†æ— æ³•å†’æ³¡åˆ°documentä¸Šã€‚ ç”±ä¸Šé¢çš„æ‰§è¡Œæœºåˆ¶ä¸éš¾å¾—å‡ºï¼Œæ‰€æœ‰çš„reactäº‹ä»¶éƒ½å°†æ— æ³•è¢«æ³¨å†Œã€‚ åˆæˆäº‹ä»¶ã€æµè§ˆå™¨å…¼å®¹1234function handleClick(e) &#123; e.preventDefault(); console.log(&apos;The link was clicked.&apos;);&#125; è¿™é‡Œï¼Œ e æ˜¯ä¸€ä¸ªåˆæˆçš„äº‹ä»¶ã€‚ React æ ¹æ® W3C è§„èŒƒ å®šä¹‰äº†è¿™ä¸ªåˆæˆäº‹ä»¶ï¼Œæ‰€ä»¥ä½ ä¸éœ€è¦æ‹…å¿ƒè·¨æµè§ˆå™¨çš„å…¼å®¹æ€§é—®é¢˜ã€‚ äº‹ä»¶å¤„ç†ç¨‹åºå°†ä¼ é€’ SyntheticEvent çš„å®ä¾‹ï¼Œè¿™æ˜¯ä¸€ä¸ªè·¨æµè§ˆå™¨åŸç”Ÿäº‹ä»¶åŒ…è£…å™¨ã€‚ å®ƒå…·æœ‰ä¸æµè§ˆå™¨åŸç”Ÿäº‹ä»¶ç›¸åŒçš„æ¥å£ï¼ŒåŒ…æ‹¬stopPropagation() å’Œ preventDefault() ï¼Œåœ¨æ‰€æœ‰æµè§ˆå™¨ä¸­ä»–ä»¬å·¥ä½œæ–¹å¼éƒ½ç›¸åŒã€‚ æ¯ä¸ªSyntheticEventå¯¹è±¡éƒ½å…·æœ‰ä»¥ä¸‹å±æ€§ï¼š 1234567891011121314boolean bubblesboolean cancelableDOMEventTarget currentTargetboolean defaultPreventednumber eventPhaseboolean isTrustedDOMEvent nativeEventvoid preventDefault()boolean isDefaultPrevented()void stopPropagation()boolean isPropagationStopped()DOMEventTarget targetnumber timeStampstring type Reactåˆæˆçš„SyntheticEventé‡‡ç”¨äº†äº‹ä»¶æ± ï¼Œè¿™æ ·åšå¯ä»¥å¤§å¤§èŠ‚çœå†…å­˜ï¼Œè€Œä¸ä¼šé¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯äº‹ä»¶å¯¹è±¡ã€‚ å¦å¤–ï¼Œä¸ç®¡åœ¨ä»€ä¹ˆæµè§ˆå™¨ç¯å¢ƒä¸‹ï¼Œæµè§ˆå™¨ä¼šå°†è¯¥äº‹ä»¶ç±»å‹ç»Ÿä¸€åˆ›å»ºä¸ºåˆæˆäº‹ä»¶ï¼Œä»è€Œè¾¾åˆ°äº†æµè§ˆå™¨å…¼å®¹çš„ç›®çš„ã€‚ æ¨èé˜…è¯»ã€Reactæ·±å…¥ã€‘setStateçš„æ‰§è¡Œæœºåˆ¶","categories":[],"tags":[{"name":"React","slug":"React","permalink":"https://www.lisq.xyz/tags/React/"}]},{"title":"ã€Reactæ·±å…¥ã€‘setStateçš„æ‰§è¡Œæœºåˆ¶","slug":"ã€Reactæ·±å…¥ã€‘setStateçš„æ‰§è¡Œæœºåˆ¶","date":"2019-03-06T08:12:35.000Z","updated":"2019-04-06T05:27:16.846Z","comments":true,"path":"2019/03/06/ã€Reactæ·±å…¥ã€‘setStateçš„æ‰§è¡Œæœºåˆ¶/","link":"","permalink":"https://www.lisq.xyz/2019/03/06/ã€Reactæ·±å…¥ã€‘setStateçš„æ‰§è¡Œæœºåˆ¶/","excerpt":"","text":"ä¸€.å‡ ä¸ªå¼€å‘ä¸­ç»å¸¸ä¼šé‡åˆ°çš„é—®é¢˜ä»¥ä¸‹å‡ ä¸ªé—®é¢˜æ˜¯æˆ‘ä»¬åœ¨å®é™…å¼€å‘ä¸­ç»å¸¸ä¼šé‡åˆ°çš„åœºæ™¯ï¼Œä¸‹é¢ç”¨å‡ ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç æ¥è¿˜åŸä¸€ä¸‹ã€‚ 1.setStateæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥çš„ï¼Œä¸ºä»€ä¹ˆæœ‰çš„æ—¶å€™ä¸èƒ½ç«‹å³æ‹¿åˆ°æ›´æ–°ç»“æœè€Œæœ‰çš„æ—¶å€™å¯ä»¥?1.1 é’©å­å‡½æ•°å’ŒReactåˆæˆäº‹ä»¶ä¸­çš„setStateç°åœ¨æœ‰ä¸¤ä¸ªç»„ä»¶ 123456789101112componentDidMount() &#123; console.log('parent componentDidMount');&#125;render() &#123; return ( &lt;div&gt; &lt;SetState2&gt;&lt;/SetState2&gt; &lt;SetState&gt;&lt;/SetState&gt; &lt;/div&gt; );&#125; ç»„ä»¶å†…éƒ¨æ”¾å…¥åŒæ ·çš„ä»£ç ï¼Œå¹¶åœ¨Setstate1ä¸­çš„componentDidMountä¸­æ”¾å…¥ä¸€æ®µåŒæ­¥å»¶æ—¶ä»£ç ï¼Œæ‰“å°å»¶æ—¶æ—¶é—´ï¼š 123456789101112131415161718192021componentWillUpdate() &#123; console.log('componentWillUpdate');&#125;componentDidUpdate() &#123; console.log('componentDidUpdate');&#125;componentDidMount() &#123; console.log('SetStateè°ƒç”¨setState'); this.setState(&#123; index: this.state.index + 1 &#125;) console.log('state', this.state.index); console.log('SetStateè°ƒç”¨setState'); this.setState(&#123; index: this.state.index + 1 &#125;) console.log('state', this.state.index);&#125; ä¸‹é¢æ˜¯æ‰§è¡Œç»“æœï¼š è¯´æ˜ï¼š 1.è°ƒç”¨setStateä¸ä¼šç«‹å³æ›´æ–° 2.æ‰€æœ‰ç»„ä»¶ä½¿ç”¨çš„æ˜¯åŒä¸€å¥—æ›´æ–°æœºåˆ¶ï¼Œå½“æ‰€æœ‰ç»„ä»¶didmountåï¼Œçˆ¶ç»„ä»¶didmountï¼Œç„¶åæ‰§è¡Œæ›´æ–° 3.æ›´æ–°æ—¶ä¼šæŠŠæ¯ä¸ªç»„ä»¶çš„æ›´æ–°åˆå¹¶ï¼Œæ¯ä¸ªç»„ä»¶åªä¼šè§¦å‘ä¸€æ¬¡æ›´æ–°çš„ç”Ÿå‘½å‘¨æœŸã€‚ 1.2 å¼‚æ­¥å‡½æ•°å’ŒåŸç”Ÿäº‹ä»¶ä¸­çš„setstateï¼Ÿåœ¨setTimeoutä¸­è°ƒç”¨setStateï¼ˆä¾‹å­å’Œåœ¨æµè§ˆå™¨åŸç”Ÿäº‹ä»¶ä»¥åŠæ¥å£å›è°ƒä¸­æ‰§è¡Œæ•ˆæœç›¸åŒï¼‰1234567891011121314componentDidMount() &#123; setTimeout(() =&gt; &#123; console.log(&apos;è°ƒç”¨setState&apos;); this.setState(&#123; index: this.state.index + 1 &#125;) console.log(&apos;state&apos;, this.state.index); console.log(&apos;è°ƒç”¨setState&apos;); this.setState(&#123; index: this.state.index + 1 &#125;) console.log(&apos;state&apos;, this.state.index); &#125;, 0);&#125; æ‰§è¡Œç»“æœï¼š è¯´æ˜ï¼š 1.åœ¨çˆ¶ç»„ä»¶didmountåæ‰§è¡Œ 2.è°ƒç”¨setStateåŒæ­¥æ›´æ–° 2.ä¸ºä»€ä¹ˆæœ‰æ—¶è¿ç»­ä¸¤æ¬¡setStateåªæœ‰ä¸€æ¬¡ç”Ÿæ•ˆï¼Ÿåˆ†åˆ«æ‰§è¡Œä»¥ä¸‹ä»£ç ï¼š 12345678componentDidMount() &#123; this.setState(&#123; index: this.state.index + 1 &#125;, () =&gt; &#123; console.log(this.state.index); &#125;) this.setState(&#123; index: this.state.index + 1 &#125;, () =&gt; &#123; console.log(this.state.index); &#125;)&#125; 12345678componentDidMount() &#123; this.setState((preState) =&gt; (&#123; index: preState.index + 1 &#125;), () =&gt; &#123; console.log(this.state.index); &#125;) this.setState(preState =&gt; (&#123; index: preState.index + 1 &#125;), () =&gt; &#123; console.log(this.state.index); &#125;)&#125; æ‰§è¡Œç»“æœï¼š 1211 1222 è¯´æ˜ï¼š 1.ç›´æ¥ä¼ é€’å¯¹è±¡çš„setstateä¼šè¢«åˆå¹¶æˆä¸€æ¬¡ 2.ä½¿ç”¨å‡½æ•°ä¼ é€’stateä¸ä¼šè¢«åˆå¹¶ äºŒ.setStateæ‰§è¡Œè¿‡ç¨‹ç”±äºæºç æ¯”è¾ƒå¤æ‚ï¼Œå°±ä¸è´´åœ¨è¿™é‡Œäº†ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å»githubä¸Šcloneä¸€ä»½ç„¶åæŒ‰ç…§ä¸‹é¢çš„æµç¨‹å›¾å»èµ°ä¸€éã€‚ 1.æµç¨‹å›¾ partialStateï¼šsetStateä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå¯¹è±¡æˆ–å‡½æ•° _pendingStateQueueï¼šå½“å‰ç»„ä»¶ç­‰å¾…æ‰§è¡Œæ›´æ–°çš„stateé˜Ÿåˆ— isBatchingUpdatesï¼šreactç”¨äºæ ‡è¯†å½“å‰æ˜¯å¦å¤„äºæ‰¹é‡æ›´æ–°çŠ¶æ€ï¼Œæ‰€æœ‰ç»„ä»¶å…¬ç”¨ dirtyComponentï¼šå½“å‰æ‰€æœ‰å¤„äºå¾…æ›´æ–°çŠ¶æ€çš„ç»„ä»¶é˜Ÿåˆ— transcationï¼šreactçš„äº‹åŠ¡æœºåˆ¶ï¼Œåœ¨è¢«äº‹åŠ¡è°ƒç”¨çš„æ–¹æ³•å¤–åŒ…è£…nä¸ªwaperå¯¹è±¡ï¼Œå¹¶ä¸€æ¬¡æ‰§è¡Œï¼šwaper.initã€è¢«è°ƒç”¨æ–¹æ³•ã€waper.close FLUSH_BATCHED_UPDATESï¼šç”¨äºæ‰§è¡Œæ›´æ–°çš„waperï¼Œåªæœ‰ä¸€ä¸ªcloseæ–¹æ³• 2.æ‰§è¡Œè¿‡ç¨‹å¯¹ç…§ä¸Šé¢æµç¨‹å›¾çš„æ–‡å­—è¯´æ˜ï¼Œå¤§æ¦‚å¯åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š 1.å°†setStateä¼ å…¥çš„partialStateå‚æ•°å­˜å‚¨åœ¨å½“å‰ç»„ä»¶å®ä¾‹çš„stateæš‚å­˜é˜Ÿåˆ—ä¸­ã€‚ 2.åˆ¤æ–­å½“å‰Reactæ˜¯å¦å¤„äºæ‰¹é‡æ›´æ–°çŠ¶æ€ï¼Œå¦‚æœæ˜¯ï¼Œå°†å½“å‰ç»„ä»¶åŠ å…¥å¾…æ›´æ–°çš„ç»„ä»¶é˜Ÿåˆ—ä¸­ã€‚ 3.å¦‚æœæœªå¤„äºæ‰¹é‡æ›´æ–°çŠ¶æ€ï¼Œå°†æ‰¹é‡æ›´æ–°çŠ¶æ€æ ‡è¯†è®¾ç½®ä¸ºtrueï¼Œç”¨äº‹åŠ¡å†æ¬¡è°ƒç”¨å‰ä¸€æ­¥æ–¹æ³•ï¼Œä¿è¯å½“å‰ç»„ä»¶åŠ å…¥åˆ°äº†å¾…æ›´æ–°ç»„ä»¶é˜Ÿåˆ—ä¸­ã€‚ 4.è°ƒç”¨äº‹åŠ¡çš„waperæ–¹æ³•ï¼Œéå†å¾…æ›´æ–°ç»„ä»¶é˜Ÿåˆ—ä¾æ¬¡æ‰§è¡Œæ›´æ–°ã€‚ 5.æ‰§è¡Œç”Ÿå‘½å‘¨æœŸcomponentWillReceivePropsã€‚ 6.å°†ç»„ä»¶çš„stateæš‚å­˜é˜Ÿåˆ—ä¸­çš„stateè¿›è¡Œåˆå¹¶ï¼Œè·å¾—æœ€ç»ˆè¦æ›´æ–°çš„stateå¯¹è±¡ï¼Œå¹¶å°†é˜Ÿåˆ—ç½®ä¸ºç©ºã€‚ 7.æ‰§è¡Œç”Ÿå‘½å‘¨æœŸcomponentShouldUpdateï¼Œæ ¹æ®è¿”å›å€¼åˆ¤æ–­æ˜¯å¦è¦ç»§ç»­æ›´æ–°ã€‚ 8.æ‰§è¡Œç”Ÿå‘½å‘¨æœŸcomponentWillUpdateã€‚ 9.æ‰§è¡ŒçœŸæ­£çš„æ›´æ–°ï¼Œrenderã€‚ 10.æ‰§è¡Œç”Ÿå‘½å‘¨æœŸcomponentDidUpdateã€‚ ä¸‰.æ€»ç»“1.é’©å­å‡½æ•°å’Œåˆæˆäº‹ä»¶ä¸­ï¼šåœ¨reactçš„ç”Ÿå‘½å‘¨æœŸå’Œåˆæˆäº‹ä»¶ä¸­ï¼Œreactä»ç„¶å¤„äºä»–çš„æ›´æ–°æœºåˆ¶ä¸­ï¼Œè¿™æ—¶isBranchUpdateä¸ºtrueã€‚ æŒ‰ç…§ä¸Šè¿°è¿‡ç¨‹ï¼Œè¿™æ—¶æ— è®ºè°ƒç”¨å¤šå°‘æ¬¡setStateï¼Œéƒ½ä¼šä¸ä¼šæ‰§è¡Œæ›´æ–°ï¼Œè€Œæ˜¯å°†è¦æ›´æ–°çš„stateå­˜å…¥_pendingStateQueueï¼Œå°†è¦æ›´æ–°çš„ç»„ä»¶å­˜å…¥dirtyComponentã€‚ å½“ä¸Šä¸€æ¬¡æ›´æ–°æœºåˆ¶æ‰§è¡Œå®Œæ¯•ï¼Œä»¥ç”Ÿå‘½å‘¨æœŸä¸ºä¾‹ï¼Œæ‰€æœ‰ç»„ä»¶ï¼Œå³æœ€é¡¶å±‚ç»„ä»¶didmountåä¼šå°†isBranchUpdateè®¾ç½®ä¸ºfalseã€‚è¿™æ—¶å°†æ‰§è¡Œä¹‹å‰ç´¯ç§¯çš„setStateã€‚ 2.å¼‚æ­¥å‡½æ•°å’ŒåŸç”Ÿäº‹ä»¶ä¸­ç”±æ‰§è¡Œæœºåˆ¶çœ‹ï¼ŒsetStateæœ¬èº«å¹¶ä¸æ˜¯å¼‚æ­¥çš„ï¼Œè€Œæ˜¯å¦‚æœåœ¨è°ƒç”¨setStateæ—¶ï¼Œå¦‚æœreactæ­£å¤„äºæ›´æ–°è¿‡ç¨‹ï¼Œå½“å‰æ›´æ–°ä¼šè¢«æš‚å­˜ï¼Œç­‰ä¸Šä¸€æ¬¡æ›´æ–°æ‰§è¡Œååœ¨æ‰§è¡Œï¼Œè¿™ä¸ªè¿‡ç¨‹ç»™äººä¸€ç§å¼‚æ­¥çš„å‡è±¡ã€‚ åœ¨ç”Ÿå‘½å‘¨æœŸï¼Œæ ¹æ®JSçš„å¼‚æ­¥æœºåˆ¶ï¼Œä¼šå°†å¼‚æ­¥å‡½æ•°å…ˆæš‚å­˜ï¼Œç­‰æ‰€æœ‰åŒæ­¥ä»£ç æ‰§è¡Œå®Œæ¯•ååœ¨æ‰§è¡Œï¼Œè¿™æ—¶ä¸Šä¸€æ¬¡æ›´æ–°è¿‡ç¨‹å·²ç»æ‰§è¡Œå®Œæ¯•ï¼ŒisBranchUpdateè¢«è®¾ç½®ä¸ºfalseï¼Œæ ¹æ®ä¸Šé¢çš„æµç¨‹ï¼Œè¿™æ—¶å†è°ƒç”¨setStateå³å¯ç«‹å³æ‰§è¡Œæ›´æ–°ï¼Œæ‹¿åˆ°æ›´æ–°ç»“æœã€‚ 3.partialStateåˆå¹¶æœºåˆ¶æˆ‘ä»¬çœ‹ä¸‹æµç¨‹ä¸­_processPendingStateçš„ä»£ç ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ç”¨æ¥åˆå¹¶stateæš‚å­˜é˜Ÿåˆ—çš„ï¼Œæœ€åè¿”å›ä¸€ä¸ªåˆå¹¶åçš„stateã€‚ 123456789101112131415161718192021222324_processPendingState: function (props, context) &#123; var inst = this._instance; var queue = this._pendingStateQueue; var replace = this._pendingReplaceState; this._pendingReplaceState = false; this._pendingStateQueue = null; if (!queue) &#123; return inst.state; &#125; if (replace &amp;&amp; queue.length === 1) &#123; return queue[0]; &#125; var nextState = _assign(&#123;&#125;, replace ? queue[0] : inst.state); for (var i = replace ? 1 : 0; i &lt; queue.length; i++) &#123; var partial = queue[i]; _assign(nextState, typeof partial === 'function' ? partial.call(inst, nextState, props, context) : partial); &#125; return nextState;&#125;, æˆ‘ä»¬åªéœ€è¦å…³æ³¨ä¸‹é¢\bè¿™æ®µä»£ç ï¼š 1_assign(nextState, typeof partial === 'function' ? partial.call(inst, nextState, props, context) : partial); å¦‚æœä¼ å…¥çš„æ˜¯å¯¹è±¡ï¼Œå¾ˆæ˜æ˜¾ä¼šè¢«åˆå¹¶æˆä¸€æ¬¡ï¼š 12345Object.assign( nextState, &#123;index: state.index+ 1&#125;, &#123;index: state.index+ 1&#125;) å¦‚æœä¼ å…¥çš„æ˜¯å‡½æ•°ï¼Œå‡½æ•°çš„å‚æ•°preStateæ˜¯å‰ä¸€æ¬¡åˆå¹¶åçš„ç»“æœï¼Œæ‰€ä»¥è®¡ç®—ç»“æœæ˜¯å‡†ç¡®çš„ã€‚ 4.componentDidMountè°ƒç”¨setstate åœ¨componentDidMount()ä¸­ï¼Œä½  å¯ä»¥ç«‹å³è°ƒç”¨setState()ã€‚å®ƒå°†ä¼šè§¦å‘ä¸€æ¬¡é¢å¤–çš„æ¸²æŸ“ï¼Œä½†æ˜¯å®ƒå°†åœ¨æµè§ˆå™¨åˆ·æ–°å±å¹•ä¹‹å‰å‘ç”Ÿã€‚è¿™ä¿è¯äº†åœ¨æ­¤æƒ…å†µä¸‹å³ä½¿render()å°†ä¼šè°ƒç”¨ä¸¤æ¬¡ï¼Œç”¨æˆ·ä¹Ÿä¸ä¼šçœ‹åˆ°ä¸­é—´çŠ¶æ€ã€‚è°¨æ…ä½¿ç”¨è¿™ä¸€æ¨¡å¼ï¼Œå› ä¸ºå®ƒå¸¸å¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ åœ¨constructor()ä¸­ä½¿ç”¨èµ‹å€¼åˆå§‹çŠ¶æ€æ¥ä»£æ›¿ã€‚ç„¶è€Œï¼Œæœ‰äº›æƒ…å†µä¸‹å¿…é¡»è¿™æ ·ï¼Œæ¯”å¦‚åƒæ¨¡æ€æ¡†å’Œå·¥å…·æç¤ºæ¡†ã€‚è¿™æ—¶ï¼Œä½ éœ€è¦å…ˆæµ‹é‡è¿™äº›DOMèŠ‚ç‚¹ï¼Œæ‰èƒ½æ¸²æŸ“ä¾èµ–å°ºå¯¸æˆ–è€…ä½ç½®çš„æŸäº›ä¸œè¥¿ã€‚ ä»¥ä¸Šæ˜¯å®˜æ–¹æ–‡æ¡£çš„è¯´æ˜ï¼Œä¸æ¨èç›´æ¥åœ¨componentDidMountç›´æ¥è°ƒç”¨setStateï¼Œç”±ä¸Šé¢çš„åˆ†æï¼šcomponentDidMountæœ¬èº«å¤„äºä¸€æ¬¡æ›´æ–°ä¸­ï¼Œæˆ‘ä»¬åˆè°ƒç”¨äº†ä¸€æ¬¡setStateï¼Œå°±ä¼šåœ¨æœªæ¥å†è¿›è¡Œä¸€æ¬¡renderï¼Œé€ æˆä¸å¿…è¦çš„æ€§èƒ½æµªè´¹ï¼Œå¤§å¤šæ•°æƒ…å†µå¯ä»¥è®¾ç½®åˆå§‹å€¼æ¥æå®šã€‚ å½“ç„¶åœ¨componentDidMountæˆ‘ä»¬å¯ä»¥è°ƒç”¨æ¥å£ï¼Œå†å›è°ƒä¸­å»ä¿®æ”¹stateï¼Œè¿™æ˜¯æ­£ç¡®çš„åšæ³•ã€‚ å½“stateåˆå§‹å€¼ä¾èµ–domå±æ€§æ—¶ï¼Œåœ¨componentDidMountä¸­setStateæ˜¯æ— æ³•é¿å…çš„ã€‚ 5.componentWillUpdate componentDidUpdateè¿™ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ä¸èƒ½è°ƒç”¨setStateã€‚ ç”±ä¸Šé¢çš„æµç¨‹å›¾å¾ˆå®¹æ˜“å‘ç°ï¼Œåœ¨å®ƒä»¬é‡Œé¢è°ƒç”¨setStateä¼šé€ æˆæ­»å¾ªç¯ï¼Œå¯¼è‡´ç¨‹åºå´©æºƒã€‚ 6.æ¨èä½¿ç”¨æ–¹å¼åœ¨è°ƒç”¨setStateæ—¶ä½¿ç”¨å‡½æ•°ä¼ é€’stateå€¼ï¼Œåœ¨å›è°ƒå‡½æ•°ä¸­è·å–æœ€æ–°æ›´æ–°åçš„stateã€‚","categories":[],"tags":[{"name":"React","slug":"React","permalink":"https://www.lisq.xyz/tags/React/"}]},{"title":"å‰ç«¯æ€§èƒ½ä¼˜åŒ–æ€»ç»“","slug":"ã€æ€§èƒ½ä¼˜åŒ–ã€‘å‰ç«¯æ€§èƒ½ä¼˜åŒ–æ€»ç»“","date":"2018-12-28T14:33:19.000Z","updated":"2019-03-28T13:03:55.501Z","comments":true,"path":"2018/12/28/ã€æ€§èƒ½ä¼˜åŒ–ã€‘å‰ç«¯æ€§èƒ½ä¼˜åŒ–æ€»ç»“/","link":"","permalink":"https://www.lisq.xyz/2018/12/28/ã€æ€§èƒ½ä¼˜åŒ–ã€‘å‰ç«¯æ€§èƒ½ä¼˜åŒ–æ€»ç»“/","excerpt":"","text":"1.åŸåˆ™å¤šä½¿ç”¨å†…å­˜ï¼Œç¼“å­˜æˆ–è€…å…¶ä»–æ–¹æ³• å‡å°‘CPUè®¡ç®—ï¼Œå‡å°‘ç½‘ç»œè¯·æ±‚ å‡å°‘IOæ“ä½œï¼ˆç¡¬ç›˜è¯»å†™ï¼‰ 2.åŠ è½½èµ„æºä¼˜åŒ–é™æ€èµ„æºçš„åˆå¹¶å’Œå‹ç¼©ã€‚ é™æ€èµ„æºç¼“å­˜ï¼ˆæµè§ˆå™¨ç¼“å­˜ç­–ç•¥ï¼‰ã€‚ ä½¿ç”¨CDNè®©é™æ€èµ„æºåŠ è½½æ›´å¿«ã€‚ 3. æ¸²æŸ“ä¼˜åŒ–CSSæ”¾headä¸­ï¼ŒJSæ”¾bodyå å›¾ç‰‡æ‡’åŠ è½½ å‡å°‘DOMæ“ä½œï¼Œå¯¹DOMæ“ä½œåšç¼“å­˜ å‡å°‘DOMæ“ä½œï¼Œå¤šä¸ªæ“ä½œå°½é‡åˆå¹¶åœ¨ä¸€èµ·æ‰§è¡Œ äº‹ä»¶èŠ‚æµ å°½æ—©æ‰§è¡Œæ“ä½œ DOMContentLoaded 4. ç¤ºä¾‹4.1 èµ„æºåˆå¹¶1a.js b.js c.js --- abc.js 4.2 ç¼“å­˜é€šè¿‡è¿æ¥åç§°æ§åˆ¶ç¼“å­˜ 1&lt;script src=\"abc_1.js\" &gt;&lt;/script&gt; åªæœ‰æ”¹å˜å†…å®¹çš„æ—¶å€™ï¼Œé“¾æ¥åç§°æ‰ä¼šæ”¹å˜ã€‚ 4.3 æ‡’åŠ è½½12345&lt;img src=\"preview.png\" realsrc=\"abc.png\" id=\"img1\" /&gt;&lt;script&gt; var i = document.getElementById('img1'); i.src = i.getAttribute('realsrc');&lt;/script&gt; 4.4 ç¼“å­˜domæŸ¥è¯¢12345678910//æ²¡æœ‰ç¼“å­˜domfor (let i = 0; i &lt; document.getElementsByTagName('p').length; i++) &#123;&#125;//ç¼“å­˜domvar p = document.getElementsByTagName('p');for (let i = 0; i &lt; p.length; i++) &#123;&#125; 4.5 åˆå¹¶domæ’å…¥123456789var listNode = document.getElementById('list');var flag = document.createDocumentFragment();var li;for (let i = 0; i &lt; 10; i++) &#123; li = document.createElement('li'); li.innerHTML = i; flag.appendChild(li);&#125;listNode.appendChild(flag); 10æ¬¡domæ’å…¥ â€”&gt; 1æ¬¡domæ’å…¥ 4.6 äº‹ä»¶èŠ‚æµç›‘å¬æ–‡å­—æ”¹å˜äº‹ä»¶ï¼Œæ— æ“ä½œ100æ¯«ç§’åæ‰§è¡Œæ“ä½œï¼Œä¸ç”¨æ¯æ¬¡è§¦å‘ã€‚12345678910var textarea = document.getElementById('ta');var timeoutId;textarea.addEventListener('keyup',function()&#123; if(i)&#123; clearTimeout(i); &#125; timeoutId = setTimeout(() =&gt; &#123; //æ“ä½œ &#125;, 100);&#125;); äº‹ä»¶èŠ‚æµä¸»è¦ç”¨äºè§¦å‘é¢‘ç‡è¾ƒé«˜çš„äº‹ä»¶ï¼Œè®¾å®šä¸€ä¸ªç¼“å†²è§¦å‘äº‹ä»¶ã€‚ è¡¥å……å¼‚æ­¥åŠ è½½éæ ¸å¿ƒä»£ç å¼‚æ­¥åŠ è½½ â€“ å¼‚æ­¥åŠ è½½çš„æ–¹å¼ â€“ åŒºåˆ« 1.åŠ¨æ€è„šæœ¬åŠ è½½ ç”¨jsåˆ›å»º 2.defer 3.async 123456&lt;script src=\"script.js\"&gt;&lt;/script&gt;æ²¡æœ‰ defer æˆ– asyncï¼Œæµè§ˆå™¨ä¼šç«‹å³åŠ è½½å¹¶æ‰§è¡ŒæŒ‡å®šçš„è„šæœ¬ï¼Œâ€œç«‹å³â€æŒ‡çš„æ˜¯åœ¨æ¸²æŸ“è¯¥ script æ ‡ç­¾ä¹‹ä¸‹çš„æ–‡æ¡£å…ƒç´ ä¹‹å‰ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ç­‰å¾…åç»­è½½å…¥çš„æ–‡æ¡£å…ƒç´ ï¼Œè¯»åˆ°å°±åŠ è½½å¹¶æ‰§è¡Œã€‚&lt;script async src=\"script.js\"&gt;&lt;/script&gt;æœ‰ asyncï¼ŒåŠ è½½å’Œæ¸²æŸ“åç»­æ–‡æ¡£å…ƒç´ çš„è¿‡ç¨‹å°†å’Œ script.js çš„åŠ è½½ä¸æ‰§è¡Œå¹¶è¡Œè¿›è¡Œï¼ˆå¼‚æ­¥ï¼‰ã€‚&lt;script defer src=\"myscript.js\"&gt;&lt;/script&gt;æœ‰ deferï¼ŒåŠ è½½åç»­æ–‡æ¡£å…ƒç´ çš„è¿‡ç¨‹å°†å’Œ script.js çš„åŠ è½½å¹¶è¡Œè¿›è¡Œï¼ˆå¼‚æ­¥ï¼‰ï¼Œä½†æ˜¯ script.js çš„æ‰§è¡Œè¦åœ¨æ‰€æœ‰å…ƒç´ è§£æå®Œæˆä¹‹åï¼ŒDOMContentLoaded äº‹ä»¶è§¦å‘ä¹‹å‰å®Œæˆã€‚ å…³äº deferï¼Œæˆ‘ä»¬è¿˜è¦è®°ä½çš„æ˜¯å®ƒæ˜¯æŒ‰ç…§åŠ è½½é¡ºåºæ‰§è¡Œè„šæœ¬çš„ æ ‡è®°ä¸ºasyncçš„è„šæœ¬å¹¶ä¸ä¿è¯æŒ‰ç…§æŒ‡å®šå®ƒä»¬çš„å…ˆåé¡ºåºæ‰§è¡Œã€‚å¯¹å®ƒæ¥è¯´è„šæœ¬çš„åŠ è½½å’Œæ‰§è¡Œæ˜¯ç´§ç´§æŒ¨ç€çš„ï¼Œæ‰€ä»¥ä¸ç®¡ä½ å£°æ˜çš„é¡ºåºå¦‚ä½•ï¼Œåªè¦å®ƒåŠ è½½å®Œäº†å°±ä¼šç«‹åˆ»æ‰§è¡Œã€‚ æµè§ˆå™¨ç¼“å­˜æ€»ç»“çš„éå¸¸å¥½ æµè§ˆå™¨ç¼“å­˜ â€“ ç¼“å­˜çš„åˆ†ç±» â€“ ç¼“å­˜çš„åŸç† ç¼“å­˜å°±æ˜¯htmlæ–‡ä»¶åœ¨æœ¬åœ°å­˜åœ¨çš„å‰¯æœ¬ï¼Œ å¼ºç¼“å­˜ å‘ç°æœ‰ç¼“å­˜ç›´æ¥ç”¨ã€‚ 12345Expires: ç»å¯¹æ—¶é—´ï¼Œåˆ¤æ–­å®¢æˆ·ç«¯æ—¥æœŸæ˜¯å¦è¶…è¿‡è¿™ä¸ªæ—¶é—´Cache-Controlï¼šç›¸å¯¹æ—¶é—´ï¼Œåˆ¤æ–­è®¿é—®é—´éš”æ˜¯å¦å¤§äº3600ç§’//åœ¨è®¾å®šæ—¶é—´ä¹‹å‰ä¸ä¼šå’ŒæœåŠ¡ç«¯è¿›è¡Œé€šä¿¡äº†//å¦‚æœä¸¤ä¸ªéƒ½ä¸‹å‘ä»¥åè€…ä¸ºå‡† åå•†ç¼“å­˜ è¯¢é—®æœåŠ¡å™¨ç¼“å­˜æ˜¯å¦å¯ä»¥ç”¨ï¼Œåœ¨è¿›è¡Œåˆ¤æ–­æ˜¯å¦ç”¨ã€‚ Last-Modified/If-Modified-Since 123456789ç¬¬ä¸€æ¬¡è¯·æ±‚ï¼Œresponeçš„headeråŠ ä¸ŠLast-Modifiedï¼ˆæœ€åä¿®æ”¹æ—¶é—´ï¼‰å†æ¬¡è¯·æ±‚ï¼Œåœ¨requestçš„headerä¸ŠåŠ ä¸ŠIf-Modified-Since å’ŒæœåŠ¡ç«¯çš„æœ€åä¿®æ”¹æ—¶é—´å¯¹æ¯”ï¼Œå¦‚æœæ²¡æœ‰å˜åŒ–åˆ™è¿”å›304 Not Modifiedï¼Œä½†æ˜¯ä¸ä¼šè¿”å›èµ„æºå†…å®¹ï¼›å¦‚æœæœ‰å˜åŒ–ï¼Œå°±æ­£å¸¸è¿”å›èµ„æºå†…å®¹ã€‚æµè§ˆå™¨æ”¶åˆ°304çš„å“åº”åï¼Œå°±ä¼šä»ç¼“å­˜ä¸­åŠ è½½èµ„æºå¦‚æœåå•†ç¼“å­˜æ²¡æœ‰å‘½ä¸­ï¼Œæµè§ˆå™¨ç›´æ¥ä»æœåŠ¡å™¨åŠ è½½èµ„æºæ—¶ï¼ŒLast-Modifiedçš„Headeråœ¨é‡æ–°åŠ è½½çš„æ—¶å€™ä¼šè¢«æ›´æ–° Etag/If-None-Match è¿™ä¸¤ä¸ªå€¼æ˜¯ç”±æœåŠ¡å™¨ç”Ÿæˆçš„æ¯ä¸ªèµ„æºçš„å”¯ä¸€æ ‡è¯†å­—ç¬¦ä¸²ï¼Œåªè¦èµ„æºæœ‰å˜åŒ–å°±è¿™ä¸ªå€¼å°±ä¼šæ”¹å˜ï¼›å…¶åˆ¤æ–­è¿‡ç¨‹ä¸Last-Modified/If-Modified-Sinceç±»ä¼¼ï¼Œä»–å¯ä»¥ç²¾ç¡®åˆ°ç§’çš„æ›´é«˜çº§åˆ«ã€‚ DNSé¢„è§£æ12&lt;meta http-equiv=\"x-dns-prefetch-control\" content=\"on\"&gt;&lt;link rel=\"dns-prefetch\" href=\"//www.zhix.net\"&gt; åœ¨ä¸€äº›æµè§ˆå™¨çš„aæ ‡ç­¾æ˜¯é»˜è®¤æ‰“å¼€dnsé¢„è§£æçš„ï¼Œåœ¨httpsåè®®ä¸‹dnsé¢„è§£ææ˜¯å…³é—­çš„ï¼ŒåŠ å…¥mateåä¼šæ‰“å¼€ã€‚","categories":[],"tags":[{"name":"æ€§èƒ½ä¼˜åŒ–","slug":"æ€§èƒ½ä¼˜åŒ–","permalink":"https://www.lisq.xyz/tags/æ€§èƒ½ä¼˜åŒ–/"}]},{"title":"æŒ‡ä»¤æ§åˆ¶ windows ç”µæºé€‰é¡¹","slug":"ã€electronã€‘æŒ‡ä»¤æ§åˆ¶-windows-ç”µæºé€‰é¡¹","date":"2018-12-17T10:07:12.000Z","updated":"2019-04-06T05:28:00.004Z","comments":true,"path":"2018/12/17/ã€electronã€‘æŒ‡ä»¤æ§åˆ¶-windows-ç”µæºé€‰é¡¹/","link":"","permalink":"https://www.lisq.xyz/2018/12/17/ã€electronã€‘æŒ‡ä»¤æ§åˆ¶-windows-ç”µæºé€‰é¡¹/","excerpt":"","text":"1.powercfgå‘½ä»¤ã€‚ä½¿ç”¨powercfg.exeæ§åˆ¶ç”µæºè®¡åˆ’ï¼ˆä¹Ÿç§°ä¸ºç”µæºä½¿ç”¨æ–¹æ¡ˆï¼‰ã€‚ 2.acå’Œdcä¸€èˆ¬ç”µæºæœ‰ä¸¤ç§ä¾›ç”µæ¨¡å¼ï¼š acä»£è¡¨äº¤æµç”µæº dcä»£è¡¨ç›´æµç”µæº ä¸€èˆ¬æƒ…å†µä¸‹acå°±æ˜¯ç›´æ¥æ¥é€šç”µæºï¼Œdcæ˜¯ä½¿ç”¨ç”µæ± ä¾›ç”µã€‚ ä¸€èˆ¬ç”µæºå‘½ä»¤éƒ½éœ€è¦åˆ†åˆ«è®¾ç½®åœ¨acå’Œdcä¸‹çš„æ¨¡å¼ã€‚ 3.ç”µæºé€‰é¡¹çš„å”¯ä¸€æ ‡è¯†æ¯ä¸ªç”µæºé€‰é¡¹éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„guidæ ‡è¯†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æŸäº›å‘½ä»¤é€šè¿‡è¿™ä¸ªå”¯ä¸€æ ‡è¯†æ¥è®¾å®šè¿™ä¸ªç”µæºé€‰é¡¹ã€‚ ä¾‹å¦‚å®˜æ–¹æ–‡æ¡£ä¸­çš„ç”µæºè®¡åˆ’ï¼š å¦‚å›¾ï¼šç”µæºè®¡åˆ’ èŠ‚ç”µï¼Œå¹³è¡¡ï¼Œé«˜æ€§èƒ½åˆ†åˆ«å¯¹åº”äº†ä¸€ä¸ªguidã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥é˜…windowsæ–‡æ¡£æˆ–è€…ä½¿ç”¨ 1powercfg /query å‘½ä»¤æ¥æŸ¥è¯¢æ¯ä¸ªé€‰é¡¹å¯¹åº”çš„guidã€‚ 4.è®¾ç½®ç”µæºè®¡åˆ’1powercfg -setactive guid å¯ä»¥é€šè¿‡-setactiveæ¥è®¾ç½®å½“å‰ç”µæºè®¡åˆ’ã€‚ ä¾‹å¦‚ä¸‹é¢çš„ä»£ç å°†ç”µæºè®¾ç½®ä¸ºå¹³è¡¡æ¨¡å¼ 1powercfg -setactive 381b4222-f694-41f0-9685-ff5bb260df2e 5.ä¿®æ”¹ç”µæºè®¡åˆ’ä¸­çš„ç”µæºé€‰é¡¹ç›´æ¥æŸ¥çœ‹æ§åˆ¶é¢æ¿ä¸­çš„ç”µæºé€‰é¡¹å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ç•Œé¢ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥ä¿®æ”¹1powercfg -change value åé¢çš„valueæœ‰å¦‚ä¸‹å‡ ä¸ªé€‰é¡¹ 12345678monitor-timeout-ac &lt;åˆ†é’Ÿ&gt;monitor-timeout-dc &lt;åˆ†é’Ÿ&gt;disk-timeout-ac &lt;åˆ†é’Ÿ&gt;disk-timeout-dc &lt;åˆ†é’Ÿ&gt;standby-timeout-ac &lt;åˆ†é’Ÿ&gt;standby-timeout-dc &lt;åˆ†é’Ÿ&gt;hibernate-timeout-ac &lt;åˆ†é’Ÿ&gt;hibernate-timeout-dc &lt;åˆ†é’Ÿ&gt; monitor:å±å¹•disk:ç£ç›˜standby:å¾…æœºhibernate:ä¼‘çœ  å®ä¾‹ï¼š 1powercfg /change monitor-timeout-ac 5 è¡¨ç¤ºï¼šåœ¨æ¥é€šç”µæºæ¨¡å¼ä¸‹è®¾ç½®å±å¹•5åˆ†é’Ÿåå…³é—­ã€‚ 1powercfg /change monitor-hibernate-dc 0 è¡¨ç¤ºï¼šåœ¨ä¸æ¥é€šç”µæºæ¨¡å¼ä¸‹æ°¸ä¸ä¼‘çœ  6.é«˜çº§é€‰é¡¹è¿˜æœ‰ä¸€äº›å…¶ä»–é€‰é¡¹ï¼Œä¾‹å¦‚æŒ‰ä¸‹ç”µæºæŒ‰é’®ï¼Œç¡çœ æŒ‰é’®ï¼Œå…³é—­ç›–å­ç­‰å‘ç”Ÿçš„æ“ä½œã€‚ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è®¾ç½®ï¼š 123powercfg /setacvalueindex scheme_GUID sub_GUID setting_GUID setting_indexpowercfg /setdcvalueindex scheme_GUID sub_GUID setting_GUID setting_index scheme_GUID : ç”µæºè®¡åˆ’guidï¼Œå¯ä»¥é€šè¿‡powercfg /listæŸ¥è¯¢ sub_GUIDï¼šå­ç»„guidï¼Œå¯ä»¥è§£é‡Šæˆåœ¨ä¼—å¤šçš„ç”µæºé€‰é¡¹ä¸Šåˆåˆ†çš„ä¸€å±‚ç»„ï¼Œå¯ä»¥é€šè¿‡è¿‡powercfg /queryæŸ¥è¯¢ setting_GUIDï¼šé€‰é¡¹guidï¼Œå…·ä½“çš„ç”µæºé€‰é¡¹ã€‚ setting_indexï¼šå…·ä½“è®¾ç½®çš„ç´¢å¼•ï¼Œå¦‚ä¸‹å›¾ï¼š ä¸é‡‡å–ä»»ä½•æ“ä½œï¼Œç¡çœ ï¼Œä¼‘çœ ï¼Œå…³æœº ä¾‹å¦‚ï¼š 1powercfg -SetAcValueIndex 381b4222-f694-41f0-9685-ff5bb260df2e 4f971e89-eebd-4455-a8de-9e59040e7347 5ca83367-6e45-459f-a27b-476b1d01c936 0 è¡¨ç¤ºï¼šè®¾ç½®æ¥é€šç”µæºçš„æƒ…å†µä¸‹ï¼Œç”µæºå…³ç›–åä¸é‡‡å–ä»»ä½•æ“ä½œã€‚ 1powercfg -SetDcValueIndex 381b4222-f694-41f0-9685-ff5bb260df2e 4f971e89-eebd-4455-a8de-9e59040e7347 7648efa3-dd9c-4e3e-b566-50f929386280 1 è¡¨ç¤ºï¼šè®¾ç½®æœªæ¥é€šç”µæºçš„æƒ…å†µä¸‹ï¼ŒæŒ‰ä¸‹ç”µæºé”®ä½¿ç”µè„‘è¿›å…¥ç¡çœ ã€‚ 7.æ€»ç»“æœ‰äº†è¿™äº›æ“ä½œï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æŸäº›è¯­è¨€æ¯”å¦‚nodeï¼Œæ¥æ‰¹å¤„ç†windowsç”µæºé€‰é¡¹äº†ã€‚ æ›´è¯¦ç»†çš„é€‰é¡¹å¯ä»¥æŸ¥è¯¢windowså®˜æ–¹æ–‡æ¡£ï¼š https://docs.microsoft.com/en-us/windows-hardware/design/device-experiences/powercfg-command-line-options#option_getactivescheme","categories":[],"tags":[{"name":"electron","slug":"electron","permalink":"https://www.lisq.xyz/tags/electron/"}]},{"title":"reactä¸­keyçš„æ­£ç¡®ä½¿ç”¨æ–¹å¼","slug":"ã€Reactæ·±å…¥ã€‘reactä¸­keyçš„æ­£ç¡®ä½¿ç”¨æ–¹å¼","date":"2018-11-26T17:50:45.000Z","updated":"2019-03-28T13:03:38.972Z","comments":true,"path":"2018/11/27/ã€Reactæ·±å…¥ã€‘reactä¸­keyçš„æ­£ç¡®ä½¿ç”¨æ–¹å¼/","link":"","permalink":"https://www.lisq.xyz/2018/11/27/ã€Reactæ·±å…¥ã€‘reactä¸­keyçš„æ­£ç¡®ä½¿ç”¨æ–¹å¼/","excerpt":"","text":"åœ¨å¼€å‘reactç¨‹åºæ—¶æˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„è­¦å‘Šï¼Œç„¶åå°±ä¼šæƒ³åˆ°ï¼šå“¦ï¼å¾ªç¯å­ç»„ä»¶å¿˜è®°åŠ keyäº†ï½ å‡ºäºæ–¹ä¾¿ï¼Œæœ‰æ—¶å€™ä¼šä¸å‡æ€ç´¢çš„ä½¿ç”¨å¾ªç¯çš„ç´¢å¼•ä½œä¸ºkeyï¼Œä½†æ˜¯è¿™æ ·çœŸçš„å¥½å—ï¼Ÿä»€ä¹ˆæ ·çš„å€¼æ‰æ˜¯keyçš„æœ€ä½³é€‰æ‹©ï¼Ÿ ä¸ºäº†å¼„æ˜ç™½ï¼Œæœ¬æ–‡å°†ä»ä¸‰ä¸ªæ–¹é¢æ¥åˆ†æâ€keyâ€ï¼š 1.ä¸ºä»€ä¹ˆè¦ä½¿ç”¨key 2.ä½¿ç”¨indexåškeyå­˜åœ¨çš„é—®é¢˜ 3.æ­£ç¡®çš„é€‰æ‹©key 1.ä¸ºä»€ä¹ˆè¦ä½¿ç”¨keyreactå®˜æ–¹æ–‡æ¡£æ˜¯è¿™æ ·æè¿°keyçš„ï¼š Keyså¯ä»¥åœ¨DOMä¸­çš„æŸäº›å…ƒç´ è¢«å¢åŠ æˆ–åˆ é™¤çš„æ—¶å€™å¸®åŠ©Reactè¯†åˆ«å“ªäº›å…ƒç´ å‘ç”Ÿäº†å˜åŒ–ã€‚å› æ­¤ä½ åº”å½“ç»™æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ èµ‹äºˆä¸€ä¸ªç¡®å®šçš„æ ‡è¯†ã€‚ reactçš„diffç®—æ³•æ˜¯æŠŠkeyå½“æˆå”¯ä¸€idç„¶åæ¯”å¯¹ç»„ä»¶çš„valueæ¥ç¡®å®šæ˜¯å¦éœ€è¦æ›´æ–°çš„ï¼Œæ‰€ä»¥å¦‚æœæ²¡æœ‰keyï¼Œreactå°†ä¸ä¼šçŸ¥é“è¯¥å¦‚ä½•æ›´æ–°ç»„ä»¶ã€‚ ä½ ä¸ä¼ keyä¹Ÿèƒ½ç”¨æ˜¯å› ä¸ºreactæ£€æµ‹åˆ°å­ç»„ä»¶æ²¡æœ‰keyåï¼Œä¼šé»˜è®¤å°†æ•°ç»„çš„ç´¢å¼•ä½œä¸ºkeyã€‚ reactæ ¹æ®keyæ¥å†³å®šæ˜¯é”€æ¯é‡æ–°åˆ›å»ºç»„ä»¶è¿˜æ˜¯æ›´æ–°ç»„ä»¶ï¼ŒåŸåˆ™æ˜¯ï¼š keyç›¸åŒï¼Œç»„ä»¶æœ‰æ‰€å˜åŒ–ï¼Œreactä¼šåªæ›´æ–°ç»„ä»¶å¯¹åº”å˜åŒ–çš„å±æ€§ã€‚ keyä¸åŒï¼Œç»„ä»¶ä¼šé”€æ¯ä¹‹å‰çš„ç»„ä»¶ï¼Œå°†æ•´ä¸ªç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚ 2.ä½¿ç”¨indexåškeyå­˜åœ¨çš„é—®é¢˜2.1 å—æ§ç»„ä»¶å•çº¯çš„å±•ç¤ºç»„ä»¶æ¯”å¦‚spanï¼Œè¿™äº›ç»„ä»¶æ˜¯å—æ§ç»„ä»¶ï¼Œæ„å‘³ç€ä»–ä»¬çš„å€¼å°†æ˜¯æˆ‘ä»¬ç»™å®šå¥½çš„ã€‚ å¦‚æœå­ç»„ä»¶åªæ˜¯å—æ§ç»„ä»¶ï¼Œä½¿ç”¨indexä½œä¸ºkeyï¼Œå¯èƒ½è¡¨é¢ä¸Šä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå®é™…ä¸Šæ€§èƒ½ä¼šå—å¾ˆå¤§çš„å½±å“ã€‚ä¾‹å¦‚ä¸‹é¢çš„ä»£ç ï¼š 123456789101112// [&apos;å¼ ä¸‰&apos;,&apos;æå››&apos;,&apos;ç‹äº”&apos;]=&gt;&lt;ul&gt; &lt;li key=&quot;0&quot;&gt;å¼ ä¸‰&lt;/li&gt; &lt;li key=&quot;1&quot;&gt;æå››&lt;/li&gt; &lt;li key=&quot;2&quot;&gt;ç‹äº”&lt;/li&gt;&lt;/ul&gt;// æ•°ç»„é‡æ’ -&gt; [&apos;ç‹äº”&apos;,&apos;å¼ ä¸‰&apos;,&apos;æå››&apos;] =&gt;&lt;ul&gt; &lt;li key=&quot;0&quot;&gt;ç‹äº”&lt;/li&gt; &lt;li key=&quot;1&quot;&gt;å¼ ä¸‰&lt;/li&gt; &lt;li key=&quot;2&quot;&gt;æå››&lt;/li&gt;&lt;/ul&gt; å½“å…ƒç´ æ•°æ®æºçš„é¡ºåºå‘ç”Ÿæ”¹å˜æ—¶ï¼Œå¯¹åº”çš„ï¼š keyä¸º0ï¼Œ1ï¼Œ2çš„ç»„ä»¶éƒ½å‘ç”Ÿäº†å˜åŒ–ï¼Œä¸‰ä¸ªå­ç»„ä»¶éƒ½ä¼šè¢«é‡æ–°æ¸²æŸ“ã€‚ï¼ˆè¿™é‡Œçš„é‡æ–°æ¸²æŸ“ä¸æ˜¯é”€æ¯ï¼Œå› ä¸ºkeyè¿˜åœ¨ï¼‰ ç›¸åï¼Œæˆ‘ä»¬ä½¿ç”¨å”¯ä¸€idä½œä¸ºkeyï¼š 123456789101112// [&apos;å¼ ä¸‰&apos;,&apos;æå››&apos;,&apos;ç‹äº”&apos;]=&gt;&lt;ul&gt; &lt;li key=&quot;000&quot;&gt;å¼ ä¸‰&lt;/li&gt; &lt;li key=&quot;111&quot;&gt;æå››&lt;/li&gt; &lt;li key=&quot;222&quot;&gt;ç‹äº”&lt;/li&gt;&lt;/ul&gt;// æ•°ç»„é‡æ’ -&gt; [&apos;ç‹äº”&apos;,&apos;å¼ ä¸‰&apos;,&apos;æå››&apos;] =&gt;&lt;ul&gt; &lt;li key=&quot;222&quot;&gt;ç‹äº”&lt;/li&gt; &lt;li key=&quot;000&quot;&gt;å¼ ä¸‰&lt;/li&gt; &lt;li key=&quot;111&quot;&gt;æå››&lt;/li&gt;&lt;/ul&gt; æ ¹æ®ä¸Šé¢çš„æ›´æ–°åŸåˆ™ï¼Œå­ç»„ä»¶çš„å€¼å’Œkeyå‡æœªå‘ç”Ÿå˜åŒ–ï¼Œåªæ˜¯é¡ºåºå‘ç”Ÿæ”¹å˜ï¼Œå› æ­¤reactåªæ˜¯å°†ä»–ä»¬åšäº†ç§»åŠ¨ï¼Œå¹¶æœªé‡æ–°æ¸²æŸ“ã€‚ 2.2 éå—æ§ç»„ä»¶åƒinputè¿™æ ·å¯ä»¥ç”±ç”¨æˆ·ä»»æ„æ”¹å˜å€¼ï¼Œä¸å—æˆ‘ä»¬æ§åˆ¶çš„ç»„ä»¶ï¼Œåœ¨ä½¿ç”¨äº†indexä½œä¸ºkeyæ—¶å¯èƒ½ä¼šå‘ç”Ÿé—®é¢˜ï¼Œçœ‹å¦‚ä¸‹çš„æ —å­ï¼š å­ç»„ä»¶ï¼š 123456789 render() &#123; return ( &lt;div&gt; &lt;p &gt;å€¼ï¼š&#123;this.props.value&#125;&lt;/p&gt; &lt;input /&gt; &lt;/div&gt; ); &#125;&#125; çˆ¶ç»„ä»¶12345&#123;this.state.data.map((element, index) =&gt; &#123; return &lt;Child value=&#123;element&#125; key=&#123;index&#125; /&gt; &#125;)&#125; æˆ‘ä»¬åœ¨å‰ä¸¤ä¸ªè¾“å…¥æ¡†åˆ†åˆ«è¾“å…¥å¯¹åº”çš„å€¼ï¼š ç„¶ååœ¨å¤´éƒ¨æ·»åŠ ä¸€ä¸ªå…ƒç´ ï¼š å¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªç»“æœå¹¶ä¸ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹å‘ç”Ÿäº†ä»€ä¹ˆï¼š 123456789101112&lt;div key=&quot;0&quot;&gt; &lt;p &gt;å€¼ï¼š0&lt;/p&gt; &lt;input /&gt;&lt;/div&gt;&lt;div key=&quot;1&quot;&gt; &lt;p &gt;å€¼ï¼š1&lt;/p&gt; &lt;input /&gt;&lt;/div&gt;&lt;div key=&quot;2&quot;&gt; &lt;p &gt;å€¼ï¼š2&lt;/p&gt; &lt;input /&gt;&lt;/div&gt; å˜åŒ–åï¼š 12345678910111213141516&lt;div key=&quot;0&quot;&gt; &lt;p &gt;å€¼ï¼š5&lt;/p&gt; &lt;input /&gt;&lt;/div&gt;&lt;div key=&quot;1&quot;&gt; &lt;p &gt;å€¼ï¼š0&lt;/p&gt; &lt;input /&gt;&lt;/div&gt;&lt;div key=&quot;2&quot;&gt; &lt;p &gt;å€¼ï¼š1&lt;/p&gt; &lt;input /&gt;&lt;/div&gt;&lt;div key=&quot;3&quot;&gt; &lt;p &gt;å€¼ï¼š2&lt;/p&gt; &lt;input /&gt;&lt;/div&gt; å¯ä»¥å‘ç°ï¼škey 0ï¼Œ1ï¼Œ2å¹¶æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œæ ¹æ®è§„åˆ™ï¼Œä¸ä¼šå¸è½½ç»„ä»¶ï¼Œåªä¼šæ›´æ–°æ”¹å˜çš„å±æ€§ã€‚ reactåªdiffåˆ°äº†pæ ‡ç­¾å†…å€¼çš„å˜åŒ–ï¼Œè€Œinputæ¡†ä¸­çš„å€¼å¹¶æœªå‘ç”Ÿæ”¹å˜ï¼Œå› æ­¤ä¸ä¼šé‡æ–°æ¸²æŸ“ï¼Œåªæ›´æ–°çš„pæ ‡ç­¾çš„å€¼ã€‚ å½“ä½¿ç”¨å”¯ä¸€idä½œä¸ºkeyåï¼š 123456789101112&lt;div key=&quot;000&quot;&gt; &lt;p &gt;å€¼ï¼š0&lt;/p&gt; &lt;input /&gt;&lt;/div&gt;&lt;div key=&quot;111&quot;&gt; &lt;p &gt;å€¼ï¼š1&lt;/p&gt; &lt;input /&gt;&lt;/div&gt;&lt;div key=&quot;222&quot;&gt; &lt;p &gt;å€¼ï¼š2&lt;/p&gt; &lt;input /&gt;&lt;/div&gt; å˜åŒ–åï¼š 12345678910111213141516&lt;div key=&quot;555&quot;&gt; &lt;p &gt;å€¼ï¼š5&lt;/p&gt; &lt;input /&gt;&lt;/div&gt;&lt;div key=&quot;000&quot;&gt; &lt;p &gt;å€¼ï¼š0&lt;/p&gt; &lt;input /&gt;&lt;/div&gt;&lt;div key=&quot;111&quot;&gt; &lt;p &gt;å€¼ï¼š1&lt;/p&gt; &lt;input /&gt;&lt;/div&gt;&lt;div key=&quot;222&quot;&gt; &lt;p &gt;å€¼ï¼š2&lt;/p&gt; &lt;input /&gt;&lt;/div&gt; å¯ä»¥å¾ˆæ˜æ˜¾çš„å‘ç°ï¼škeyä¸º 111ï¼Œ222ï¼Œ333çš„ç»„ä»¶æ²¡æœ‰å‘ç”Ÿä»»ä½•æ”¹å˜ï¼Œreactä¸ä¼šæ›´æ–°ä»–ä»¬ï¼Œåªæ˜¯æ–°æ’å…¥äº†å­ç»„ä»¶555ï¼Œå¹¶æ”¹å˜äº†å…¶ä»–ç»„ä»¶çš„ä½ç½®ã€‚ 3.æ­£ç¡®çš„é€‰æ‹©key3.1 çº¯å±•ç¤ºå¦‚æœç»„ä»¶å•çº¯çš„ç”¨äºå±•ç¤ºï¼Œä¸ä¼šå‘ç”Ÿå…¶ä»–å˜æ›´ï¼Œé‚£ä¹ˆä½¿ç”¨indexæˆ–è€…å…¶ä»–ä»»ä½•ä¸ç›¸åŒçš„å€¼ä½œä¸ºkeyæ˜¯æ²¡æœ‰ä»»ä½•é—®é¢˜çš„ï¼Œå› ä¸ºä¸ä¼šå‘ç”Ÿdiffï¼Œå°±ä¸ä¼šç”¨åˆ°keyã€‚ 3.2 æ¨èä½¿ç”¨indexçš„æƒ…å†µå¹¶ä¸æ˜¯ä»»ä½•æƒ…å†µä½¿ç”¨indexä½œä¸ºkeyä¼šæœ‰ç¼ºé™·ï¼Œæ¯”å¦‚å¦‚ä¸‹æƒ…å†µï¼š ä½ è¦åˆ†é¡µæ¸²æŸ“ä¸€ä¸ªåˆ—è¡¨ï¼Œæ¯æ¬¡ç‚¹å‡»ç¿»é¡µä¼šé‡æ–°æ¸²æŸ“ï¼š ä½¿ç”¨å”¯ä¸€idï¼š 123456789101112ç¬¬ä¸€é¡µ&lt;ul&gt; &lt;li key=&quot;000&quot;&gt;å¼ ä¸‰&lt;/li&gt; &lt;li key=&quot;111&quot;&gt;æå››&lt;/li&gt; &lt;li key=&quot;222&quot;&gt;ç‹äº”&lt;/li&gt;&lt;/ul&gt;ç¬¬äºŒé¡µ&lt;ul&gt; &lt;li key=&quot;333&quot;&gt;å¼ ä¸‰ä¸‰&lt;/li&gt; &lt;li key=&quot;444&quot;&gt;æå››å››&lt;/li&gt; &lt;li key=&quot;555&quot;&gt;ç‹äº”äº”&lt;/li&gt;&lt;/ul&gt; ç¿»é¡µåï¼Œä¸‰æ¡è®°å½•çš„keyå’Œç»„ä»¶éƒ½å‘ç”Ÿäº†æ”¹å˜ï¼Œå› æ­¤ä¸‰ä¸ªå­ç»„ä»¶éƒ½ä¼šè¢«å¸è½½ç„¶åé‡æ–°æ¸²æŸ“ã€‚ ä½¿ç”¨indexï¼š 123456789101112ç¬¬ä¸€é¡µ&lt;ul&gt; &lt;li key=&quot;0&quot;&gt;å¼ ä¸‰&lt;/li&gt; &lt;li key=&quot;1&quot;&gt;æå››&lt;/li&gt; &lt;li key=&quot;2&quot;&gt;ç‹äº”&lt;/li&gt;&lt;/ul&gt;ç¬¬äºŒé¡µ&lt;ul&gt; &lt;li key=&quot;0&quot;&gt;å¼ ä¸‰ä¸‰&lt;/li&gt; &lt;li key=&quot;1&quot;&gt;æå››å››&lt;/li&gt; &lt;li key=&quot;2&quot;&gt;ç‹äº”äº”&lt;/li&gt;&lt;/ul&gt; ç¿»é¡µåï¼Œkeyä¸å˜ï¼Œå­ç»„ä»¶å€¼å‘ç”Ÿæ”¹å˜ï¼Œç»„ä»¶å¹¶ä¸ä¼šè¢«å¸è½½ï¼Œåªå‘ç”Ÿæ›´æ–°ã€‚ 3.3 å­ç»„ä»¶å¯èƒ½å‘ç”Ÿå˜æ›´/ä½¿ç”¨äº†éå—æ§ç»„ä»¶å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½¿ç”¨å”¯ä¸€idä½œä¸ºå­ç»„ä»¶çš„keyæ˜¯ä¸ä¼šæœ‰ä»»ä½•é—®é¢˜çš„ã€‚ è¿™ä¸ªidä¸€å®šè¦æ˜¯å”¯ä¸€ï¼Œå¹¶ä¸”ç¨³å®šçš„ï¼Œæ„æ€æ˜¯è¿™æ¡è®°å½•å¯¹åº”çš„idä¸€å®šæ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œå¹¶ä¸”æ°¸è¿œä¸ä¼šå‘ç”Ÿæ”¹å˜ã€‚ ä¸æ¨èä½¿ç”¨math.randomæˆ–è€…å…¶ä»–çš„ç¬¬ä¸‰æ–¹åº“æ¥ç”Ÿæˆå”¯ä¸€å€¼ä½œä¸ºkeyã€‚ å› ä¸ºå½“æ•°æ®å˜æ›´åï¼Œç›¸åŒçš„æ•°æ®çš„keyä¹Ÿæœ‰å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œä»è€Œé‡æ–°æ¸²æŸ“ï¼Œå¼•èµ·ä¸å¿…è¦çš„æ€§èƒ½æµªè´¹ã€‚ å¦‚æœæ•°æ®æºä¸æ»¡è¶³æˆ‘ä»¬è¿™æ ·çš„éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¸²æŸ“ä¹‹å‰ä¸ºæ•°æ®æºæ‰‹åŠ¨æ·»åŠ å”¯ä¸€idï¼Œè€Œä¸æ˜¯åœ¨æ¸²æŸ“æ—¶æ·»åŠ ã€‚","categories":[],"tags":[{"name":"React","slug":"React","permalink":"https://www.lisq.xyz/tags/React/"}]},{"title":"electronç¨‹åºä¿æŠ¤æªæ–½ï¼ˆå´©æºƒç›‘æ§ï¼Œå¼€æœºè‡ªå¯ï¼Œæ‰˜ç›˜å…³é—­ï¼‰","slug":"ã€electronã€‘electronç¨‹åºä¿æŠ¤æªæ–½ï¼ˆå´©æºƒç›‘æ§ï¼Œå¼€æœºè‡ªå¯ï¼Œæ‰˜ç›˜å…³é—­ï¼‰","date":"2018-11-07T12:11:41.000Z","updated":"2019-04-06T05:27:51.873Z","comments":true,"path":"2018/11/07/ã€electronã€‘electronç¨‹åºä¿æŠ¤æªæ–½ï¼ˆå´©æºƒç›‘æ§ï¼Œå¼€æœºè‡ªå¯ï¼Œæ‰˜ç›˜å…³é—­ï¼‰/","link":"","permalink":"https://www.lisq.xyz/2018/11/07/ã€electronã€‘electronç¨‹åºä¿æŠ¤æªæ–½ï¼ˆå´©æºƒç›‘æ§ï¼Œå¼€æœºè‡ªå¯ï¼Œæ‰˜ç›˜å…³é—­ï¼‰/","excerpt":"","text":"åœ¨æŸç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›æˆ‘ä»¬çš„å®¢æˆ·ç«¯ç¨‹åºå°½å¯èƒ½è¿ç»­ä¸æ–­çš„è¿è¡Œåœ¨æˆ‘ä»¬çš„ç³»ç»Ÿä¸­ï¼Œå¹¶ä¿æŒç¨³å®šã€‚ ä»¥ä¸‹å‡ ç§æ–¹å¼å¯ä»¥å¸®åŠ©æˆ‘ä»¬åšåˆ°è¿™ä¸€ç‚¹ï¼š 1.å´©æºƒç›‘æ§electronä¸ºæˆ‘ä»¬æä¾›äº†ç›‘å¬ç¨‹åºå´©æºƒçš„äº‹ä»¶ï¼š 123456Event: &apos;crashed&apos;è¿”å›:event Eventkilled Booleanå½“æ¸²æŸ“è¿›ç¨‹å´©æºƒæˆ–è¢«ç»“æŸæ—¶è§¦å‘ æ­¤äº‹ä»¶æ˜¯ç”¨æ¥å®¶åº­æ¸²æŸ“è¿›ç¨‹å´©æºƒçš„ï¼Œä½†æ˜¯å½“ä¸»è¿›ç¨‹æ„å¤–å´©æºƒæ—¶ä¹Ÿä¼šè§¦å‘è¯¥äº‹ä»¶ã€‚ åœ¨ç›‘æµ‹åˆ°ç¨‹åºå´©æºƒåï¼Œæˆ‘ä»¬è¦è®©ç¨‹åºé‡æ–°å¯åŠ¨ï¼Œæ­¤æ—¶æˆ‘ä»¬è¦é¦–å…ˆåˆ¤æ–­windowå¯¹è±¡æ˜¯å¦è¢«é”€æ¯ï¼Œä¹Ÿå°±æ˜¯ä¸»è¿›ç¨‹æ˜¯å¦è¢«æ€æ­»ï¼Œè¿˜æ˜¯æ¸²æŸ“è¿›ç¨‹å´©æºƒï¼ŒåŒæ—¶ä½œå‡ºä¸åŒçš„å¤„ç†ã€‚ å½“mainWinè¢«é”€æ¯æ—¶æˆ‘ä»¬ç›´æ¥é‡å¯æ•´ä¸ªåº”ç”¨ï¼Œä½¿ç”¨å¦‚ä¸‹apiï¼š 12345678910app.relaunch([options])options Object (å¯é€‰)args StringexecPath String (å¯é€‰)ä»å½“å‰å®ä¾‹é€€å‡ºï¼Œé‡å¯åº”ç”¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ–°çš„å®ä¾‹ä¼šå’Œå½“å‰å®ä¾‹ä½¿ç”¨ç›¸åŒçš„å·¥ä½œç›®å½•ä»¥åŠå‘½ä»¤è¡Œå‚æ•°ã€‚ å½“è®¾ç½®äº† args å‚æ•°æ—¶ï¼Œ args å°†ä½œä¸ºå‘½ä»¤è¡Œå‚æ•°ä¼ é€’ã€‚ å½“è®¾ç½®äº† execPath ï¼ŒexecPath å°†è¢«æ‰§è¡Œä»¥é‡æ–°å¯åŠ¨ï¼Œè€Œä¸æ˜¯å½“å‰çš„åº”ç”¨ç¨‹åºã€‚è¯·æ³¨æ„, æ­¤æ–¹æ³•åœ¨æ‰§è¡Œæ—¶ä¸ä¼šé€€å‡ºå½“å‰çš„åº”ç”¨ç¨‹åº, ä½ éœ€è¦åœ¨è°ƒç”¨ app.relaunch æ–¹æ³•åå†æ‰§è¡Œ app. quit æˆ–è€… app.exit æ¥è®©åº”ç”¨é‡å¯ã€‚ åªæ˜¯æ¸²æŸ“è¿›ç¨‹å´©æºƒï¼Œæˆ‘ä»¬åªéœ€å°†å…¶ä»–çª—ä½“é”€æ¯ï¼Œç„¶åé‡æ–°loadæˆ‘ä»¬çš„ä¸»çª—å£ã€‚ å´©æºƒé‡å¯é€»è¾‘ï¼š 123456789if (mainWin.isDestroyed()) &#123; app.relaunch(); app.exit(0);&#125; else &#123; BrowserWindow.getAllWindows().forEach((w) =&gt; &#123; if (w.id !== mainWin.id) w.destroy(); &#125;); mainWin.reload();&#125; å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜è¦è®°å½•ä¸€ä¸‹ç¨‹åºçš„å´©æºƒæ—¥å¿—ï¼Œæˆ‘ä»¬è¦ç¡®ä¿æ—¥å¿—æ¥å£å‘å‡ºæˆåŠŸåå†é‡å¯æˆ‘ä»¬çš„ç¨‹åºï¼š ä¸‹é¢æ˜¯ç¨‹åºå´©æºƒåçš„å®Œæ•´é€»è¾‘ï¼š 123456789101112131415161718192021222324252627282930313233343536373839import &#123; BrowserWindow, app, dialog&#125; from &apos;electron&apos;; const mainWindow = BrowserWindow.fromId(global.mainId);mainWindow.webContents.on(&apos;crashed&apos;, () =&gt; &#123; const options = &#123; type: &apos;error&apos;, title: &apos;è¿›ç¨‹å´©æºƒäº†&apos;, message: &apos;è¿™ä¸ªè¿›ç¨‹å·²ç»å´©æºƒ.&apos;, buttons: [&apos;é‡è½½&apos;, &apos;é€€å‡º&apos;], &#125;; recordCrash().then(() =&gt; &#123; dialog.showMessageBox(options, (index) =&gt; &#123; if (index === 0) reloadWindow(mainWindow); else app.quit(); &#125;); &#125;).catch((e) =&gt; &#123; console.log(&apos;err&apos;, e); &#125;);&#125;)function recordCrash() &#123; return new Promise(resolve =&gt; &#123; // å´©æºƒæ—¥å¿—è¯·æ±‚æˆåŠŸ.... resolve(); &#125;)&#125; function reloadWindow(mainWin) &#123; if (mainWin.isDestroyed()) &#123; app.relaunch(); app.exit(0); &#125; else &#123; BrowserWindow.getAllWindows().forEach((w) =&gt; &#123; if (w.id !== mainWin.id) w.destroy(); &#125;); mainWin.reload(); &#125;&#125; å†™å¥½ä»£ç ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨æ§åˆ¶å°è¾“å…¥ 123456789101112# 2.å¼€æœºè‡ªå¯å¼€æœºè‡ªå¯æ˜¯ä¿è¯æˆ‘ä»¬çš„ç¨‹åºèƒ½é•¿æ—¶é—´åœ¨æœºå™¨ä¸Šè¿è¡Œå¾ˆé‡è¦çš„ä¸€ç‚¹ã€‚ç”µè„‘ä¸Šæœ‰å¾ˆå¤šç¨‹åºéƒ½è®¾ç½®äº†å¼€æœºè‡ªå¯åŠ¨ï¼Œæ¯”å¦‚qqï¼Œå¾®ä¿¡ï¼Œè¿…é›·ç­‰ï¼Œä»–ä»¬éƒ½æ˜¯é€šè¿‡ä¿®æ”¹æ³¨å†Œè¡¨æ¥å®ç°çš„ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹æ³¨å†Œè¡¨``` \\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run```:![image](https://lsqimg-1257917459.cos-website.ap-beijing.myqcloud.com/blog/zhucebiao1.bmp)æ‰€ä»¥æˆ‘ä»¬ä¹Ÿè¦å°†æˆ‘ä»¬ç¨‹åºçš„è·¯å¾„å†™åˆ°è¿™é‡Œã€‚å‘ç°äº†ä¸€ä¸ªéå¸¸å¥½çš„å†™æ³¨å†Œè¡¨çš„æ¨¡å—ï¼Œ```winreg æ³¨æ„macä¸èƒ½ä½¿ç”¨è¿™ä¸ªæ¨¡å—ï¼Œæ‰€ä»¥é¦–å…ˆè¦åˆ¤æ–­æ˜¯å¦ä¸ºwindowå†å¼•ç”¨è¿™ä¸ªæ¨¡å—ã€‚ å€ŸåŠ©è¿™ä¸ªæ¨¡å—æˆ‘ä»¬å¯ä»¥éå¸¸ç®€å•çš„ä¿®æ”¹æ³¨å†Œè¡¨ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041const WinReg = require(&apos;winreg&apos;);const startOnBoot = &#123; enableAutoStart: function (name, file, callback) &#123; var key = getKey(); key.set(name, WinReg.REG_SZ, file, callback || noop); &#125;, disableAutoStart: function (name, callback) &#123; var key = getKey(); key.remove(name, callback || noop); &#125;, getAutoStartValue: function (name, callback) &#123; var key = getKey(); key.get(name, function (error, result) &#123; if (result) &#123; callback(result.value); &#125; else &#123; callback(null, error); &#125; &#125;); &#125;&#125;;function noop() &#123; &#125;const RUN_LOCATION = &apos;\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run&apos;;function getKey() &#123; return new WinReg(&#123; hive: WinReg.HKCU, //CurrentUser, key: RUN_LOCATION &#125;);&#125;export default function autoStart() &#123; startOnBoot.getAutoStartValue(&apos;MY_CLIENT_AUTOSTART&apos;, function (value) &#123; if (!value) &#123; startOnBoot.enableAutoStart(&apos;MY_CLIENT_AUTOSTART&apos;, process.execPath, function () &#123; console.log(&apos;å¼€æœºè‡ªåŠ¨å¯è®¾ç½®&apos;); &#125;); &#125; &#125;);&#125; æ‰§è¡Œå®Œç¨‹åºä¹‹åï¼Œå†çœ‹æ³¨å†Œè¡¨ï¼Œå‘ç°æˆ‘ä»¬ç¨‹åºçš„è·¯å¾„å·²ç»å†™è¿›å»äº†ï¼š ç„¶åç”µè„‘é‡å¯åä½ çš„ç¨‹åºå°±è‡ªåŠ¨å¯åŠ¨äº†ã€‚ 3.æ‰˜ç›˜å…³é—­å‘qqå’Œå¾®ä¿¡ä¸€æ ·ï¼Œæœ‰çš„æ—¶å€™æˆ‘ä»¬å¹¶ä¸æƒ³è®©ç”¨æˆ·é€šè¿‡ç‚¹å…³é—­æŒ‰é’®çš„æ—¶å€™å°±å…³é—­ç¨‹åºï¼Œè€Œæ˜¯æŠŠç¨‹åºæœ€å°åŒ–åˆ°æ‰˜ç›˜ï¼Œåœ¨æ‰˜ç›˜ä¸ŠåšçœŸæ­£çš„é€€å‡ºæ“ä½œã€‚ é¦–å…ˆè¦ç›‘å¬çª—å£çš„å…³é—­äº‹ä»¶ï¼Œé˜»æ­¢ç”¨æˆ·å…³é—­æ“ä½œçš„é»˜è®¤è¡Œä¸ºã€‚ 1234mainWindow.on(&apos;close&apos;, (event) =&gt; &#123; mainWindow.hide(); event.preventDefault();&#125;); ç„¶è€Œè¿™æ—¶ä½ å‘ç°ï¼Œè¿™åªæ˜¯æœ€å°åŒ–äº†ç¨‹åºï¼Œä»»åŠ¡æ é‡Œç¨‹åºä¾ç„¶å­˜åœ¨ï¼Œæˆ‘ä»¬éœ€è¦è®©ç¨‹åºåœ¨ä»»åŠ¡æ é‡Œä¹Ÿæ¶ˆå¤±ï¼š 12345mainWindow.on(&apos;close&apos;, (event) =&gt; &#123; mainWindow.hide(); mainWindow.setSkipTaskbar(true); event.preventDefault();&#125;); è¿™æ—¶ç¨‹åºå°±å†ä¹Ÿæ‰¾ä¸åˆ°äº†ï¼Œä»»åŠ¡æ‰˜ç›˜ä¸­ä¹Ÿæ²¡æœ‰æˆ‘ä»¬çš„ç¨‹åºï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å…ˆåˆ›å»ºå¥½ä»»åŠ¡æ‰˜ç›˜ï¼Œå¹¶åšå¥½äº‹ä»¶ç›‘å¬ï¼š 123456789101112131415161718function createTray() &#123; const mainWindow = BrowserWindow.fromId(global.mainId); tray = new Tray(path.join(global.__dirname, &apos;icon.ico&apos;)); const contextMenu = Menu.buildFromTemplate([ &#123; label: &apos;é€€å‡º&apos;, click: () =&gt; &#123; mainWindow.destroy(); app.quit(); &#125; &#125;, ]) tray.setToolTip(&apos;æˆ‘çš„å®¢æˆ·ç«¯&apos;) tray.setContextMenu(contextMenu) tray.on(&apos;click&apos;, () =&gt; &#123; if (mainWindow.isVisible()) &#123; mainWindow.hide(); mainWindow.setSkipTaskbar(false); &#125; else &#123; mainWindow.show(); mainWindow.setSkipTaskbar(true); &#125; &#125;) &#125; ä»¥ä¸Šè¿™äº›æ“ä½œä¸ºæˆ‘ä»¬çš„ç¨‹åºåˆå¢åŠ äº†å¥½å‡ å±‚çš„é˜²æŠ¤æªæ–½ï¼Œæˆ‘ä»¬çš„ç¨‹åºå°±ä¸ä¼šé‚£ä¹ˆè½»è€Œæ˜“ä¸¾çš„æŒ‚æ‰å•¦ï¼","categories":[],"tags":[{"name":"electron","slug":"electron","permalink":"https://www.lisq.xyz/tags/electron/"}]},{"title":"ä½¿ç”¨electroné™é»˜æ‰“å°","slug":"ã€electronã€‘ä½¿ç”¨electroné™é»˜æ‰“å°","date":"2018-11-01T10:30:14.000Z","updated":"2019-04-06T05:27:56.036Z","comments":true,"path":"2018/11/01/ã€electronã€‘ä½¿ç”¨electroné™é»˜æ‰“å°/","link":"","permalink":"https://www.lisq.xyz/2018/11/01/ã€electronã€‘ä½¿ç”¨electroné™é»˜æ‰“å°/","excerpt":"","text":"1.ä½¿ç”¨electronæ‰“å°çš„ç†ç”±å¾ˆå¤šæƒ…å†µä¸‹ç¨‹åºä¸­ä½¿ç”¨çš„æ‰“å°éƒ½æ˜¯ç”¨æˆ·æ— æ„ŸçŸ¥çš„ã€‚å¹¶ä¸”æƒ³è¦çµæ´»çš„æ§åˆ¶æ‰“å°å†…å®¹ï¼Œå¾€å¾€éœ€è¦å€ŸåŠ©æ‰“å°æœºç»™æˆ‘ä»¬æä¾›çš„apiå†è¿›è¡Œå¼€å‘ï¼Œè¿™ç§å¼€å‘æ–¹å¼éå¸¸ç¹çï¼Œå¹¶ä¸”å¼€å‘éš¾åº¦è¾ƒå¤§ã€‚ electronæä¾›çš„æ‰“å°apiå¯ä»¥éå¸¸çµæ´»çš„æ§åˆ¶æ‰“å°è®¾ç½®çš„æ˜¾ç¤ºï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡htmlæ¥ä¹¦å†™æ‰“å°å†…å®¹ã€‚ 2.apielectronæä¾›äº†ä¸¤ç§æ–¹å¼è¿›è¡Œæ‰“å°ï¼Œä¸€ç§æ˜¯ç›´æ¥è°ƒç”¨æ‰“å°æœºæ‰“å°ï¼Œä¸€ç§æ˜¯æ‰“å°åˆ°pdfã€‚ å¹¶ä¸”æœ‰ä¸¤ç§å¯¹è±¡å¯ä»¥è°ƒç”¨æ‰“å°ï¼š ç¬¬ä¸€æ˜¯é€šè¿‡windowçš„webcontentå¯¹è±¡ï¼Œä½¿ç”¨æ­¤ç§æ–¹å¼éœ€è¦å•ç‹¬å¼€å‡ºä¸€ä¸ªæ‰“å°çš„çª—å£ï¼Œå¯ä»¥å°†è¯¥çª—å£éšè—ï¼Œä½†æ˜¯é€šä¿¡è°ƒç”¨ç›¸å¯¹å¤æ‚ã€‚ å¦ä¸€ç§æ˜¯ä½¿ç”¨é¡µé¢çš„webviewå…ƒç´ è°ƒç”¨æ‰“å°ï¼Œå¯ä»¥å°†webviewéšè—åœ¨è°ƒç”¨çš„é¡µé¢ä¸­ï¼Œé€šä¿¡æ–¹å¼æ¯”è¾ƒç®€å•ã€‚ ä¸¤ä¸ªå¯¹è±¡è°ƒç”¨æ‰“å°æ–¹æ³•çš„ä½¿ç”¨æ–¹å¼éƒ½ä¸€æ ·ã€‚ 2.1 printå®˜ç½‘apiå¦‚ä¸‹ 123456789contents.print([options], [callback])é€‰é¡¹ Object (å¯é€‰)silent Boolean (å¯é€‰) - ä¸è¯¢é—®ç”¨æˆ·æ‰“å°ä¿¡æ¯ï¼Œé»˜è®¤ä¸º falseã€‚printBackground Boolean (optional) - Also prints the background color and image of the web page. Default is false.deviceName String (optional) - Set the printer device name to use. Default is &apos;&apos;.callback Function (å¯é€‰)success Boolean - Indicates success of the print call. æ‰“å°é…ç½®(options)ä¸­åªæœ‰ç®€å•çš„ä¸‰ä¸ªé…ç½®ï¼š silentï¼šæ‰“å°æ—¶æ˜¯å¦ä¸å±•ç¤ºæ‰“å°é…ç½®ï¼ˆæ˜¯å¦é™é»˜æ‰“å°ï¼‰ printBackgroundï¼šæ˜¯å¦æ‰“å°èƒŒæ™¯ deviceNameï¼šæ‰“å°æœºè®¾å¤‡åç§° é¦–å…ˆè¦å°†æˆ‘ä»¬ä½¿ç”¨çš„æ‰“å°æœºåç§°é…ç½®å¥½ï¼Œå¹¶ä¸”è¦åœ¨è°ƒç”¨æ‰“å°å‰é¦–å…ˆè¦åˆ¤æ–­æ‰“å°æœºæ˜¯å¦å¯ç”¨ã€‚ ä½¿ç”¨getPrintersæ–¹æ³•å¯è·å–å½“å‰è®¾å¤‡å·²ç»é…ç½®çš„æ‰“å°æœºåˆ—è¡¨ï¼Œæ³¨æ„é…ç½®è¿‡ä¸æ˜¯å¯ç”¨ï¼Œåªæ˜¯åœ¨æ­¤è®¾å¤‡ä¸Šå®‰è£…è¿‡é©±åŠ¨ã€‚ é€šè¿‡getprinterè·å–åˆ°çš„æ‰“å°æœºå¯¹è±¡ï¼šhttps://electronjs.org/docs/api/structures/printer-info æˆ‘ä»¬è¿™é‡Œåªç®¡å…³å¿ƒä¸¤ä¸ªï¼Œnameå’Œstatusï¼Œstatusä¸º0æ—¶è¡¨ç¤ºæ‰“å°æœºå¯ç”¨ã€‚ è¿™é‡Œçš„statuså¿…é¡»ç»å†ä¸€æ¬¡æ‰“å°å¤±è´¥æ‰èƒ½è¿”å›é0å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ç¬¬ä¸€æ¬¡è·å–æ‰“å°æœºçŠ¶æ€ä¸€å®šæ˜¯0ã€‚ä½†æ˜¯è¿™ä¸€æ¬¡çš„æ‰“å°è™½ç„¶ä¸èƒ½åˆ¤æ–­å‡ºé”™è¯¯ï¼Œæ‰“å°çš„ä»»åŠ¡å·²ç»é¢„å­˜åœ¨é˜Ÿåˆ—ä¸­äº†ï¼Œå½“ä¸‹ä¸€æ¬¡æ‰“å°æœºçŠ¶æ€å˜ä¸ºå¯ç”¨æ—¶ï¼Œå°†ä¼šæ‰“å°æš‚å­˜çš„ä»»åŠ¡ã€‚ å½“æ‰“å°æœºçº¸å¼ ç”¨å®Œæ—¶ä¹Ÿæ˜¯è¿™ç§æƒ…å†µï¼Œå‰©ä½™ä»»åŠ¡ä¼šæš‚å­˜èµ·æ¥ï¼Œä¸‹æ¬¡æ‰“å°æœºå¯ç”¨æ—¶å³å¯ä»¥æ‰“å°äº†ã€‚ printçš„ç¬¬äºŒä¸ªå‚æ•°callbackæ˜¯ç”¨äºåˆ¤æ–­æ‰“å°ä»»åŠ¡æ˜¯å¦å‘å‡ºçš„å›è°ƒï¼Œè€Œä¸æ˜¯æ‰“å°ä»»åŠ¡å®Œæˆåçš„å›è°ƒã€‚æ‰€ä»¥ä¸€èˆ¬æ‰“å°ä»»åŠ¡å‘å‡ºï¼Œå›è°ƒå‡½æ•°å³ä¼šè°ƒç”¨å¹¶è¿”å›å‚æ•°trueã€‚è¿™ä¸ªå›è°ƒå¹¶ä¸èƒ½åˆ¤æ–­æ‰“å°æ˜¯å¦çœŸçš„æˆåŠŸäº†ã€‚ 2.2 printToPdf123456789101112contents.printToPDF(options, callback)é€‰é¡¹ ObjectmarginsType Integer (optional) - Specifies the type of margins to use. Uses 0 for default margin, 1 for no margin, and 2 for minimum margin.pageSize String (optional) - Specify page size of the generated PDF. Can be A3, A4, A5, Legal, Letter, Tabloid or an Object containing height and width in microns.printBackground Boolean (optional) - Whether to print CSS backgrounds.printSelectionOnly Boolean (optional) - Whether to print selection only.landscape Boolean (optional) - true for landscape, false for portrait.callback Function - å›è°ƒå‡½æ•°error Errordata Buffer printToPdfçš„ç”¨æ³•åŸºæœ¬å’Œprintç›¸åŒï¼Œä½†æ˜¯ç”±äºprintæ˜¯native codeæä¾›çš„æ–¹æ³•ï¼Œé…ç½®é¡¹éå¸¸å°‘ï¼Œè€ŒprintToPdfåˆ™æ‰©å±•äº†å¾ˆå¤šå±æ€§ã€‚ åŒ…æ‹¬å¯ä»¥å¯¹æ‰“å°çš„marginï¼Œæ‰“å°é¡µçœ‰é¡µè„šç­‰è¿›è¡Œé…ç½®ã€‚ é…ç½®é¡¹å¾ˆå¤šï¼Œç¿»äº†ä¸€ä¸‹æºç å‘ç°è¿˜æœ‰å¾ˆå¤šæ²¡æœ‰è¢«è´´è¿›apiçš„ï¼š 123456789101112131415161718192021222324252627const defaultPrintingSetting = &#123; pageRage: [], mediaSize: &#123;&#125;, landscape: false, color: 2, headerFooterEnabled: false, marginsType: 0, isFirstRequest: false, requestID: getNextId(), previewModifiable: true, printToPDF: true, printWithCloudPrint: false, printWithPrivet: false, printWithExtension: false, deviceName: &apos;Save as PDF&apos;, generateDraftData: true, fitToPageEnabled: false, scaleFactor: 1, dpiHorizontal: 72, dpiVertical: 72, rasterizePDF: false, duplex: 0, copies: 1, collate: true, shouldPrintBackgrounds: false, shouldPrintSelectionOnly: false&#125; 3.æ‰“å°è¾¹è·é—®é¢˜æ‰“å°çš„æ—¶å€™æ‰“å°æœºä¼šç»™çº¸å¼ ç•™ä¸€ä¸ªé»˜è®¤è¾¹è·ï¼Œå¦‚æœæ˜¯A4è¿™æ ·çš„çº¸å¼ å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡äº†ï¼Œä½†æ˜¯æ‰“å°å°è§„æ ¼çº¸å¼ å¦‚50mm*50mmï¼Œè¿™ä¸ªè¾¹è·å°±ååˆ†æ˜æ˜¾äº†ï¼Œä¸¥é‡å½±å“äº†æ•´ä½“å¸ƒå±€ã€‚ printToPdfæ–¹æ³•æä¾›äº†éå¸¸å¤šçš„é…ç½®é¡¹ï¼Œå…¶ä¸­åŒ…æ‹¬äº†é…ç½®æ‰“å°è¾¹è·çš„å‚æ•°ï¼Œä½†æ˜¯printæ–¹æ³•å´æ²¡æœ‰è¯¥é…ç½®é¡¹ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€é¡¹cssé…ç½®æ¥è§£å†³è¿™ä¸ªé—®é¢˜,å³12 @page { margin: 0px; } 12345678910111213141516171819é€šè¿‡æ­¤é…ç½®å¯çµæ´»é…ç½®æ‰“å°è¾¹è·ã€‚è¿˜æœ‰ä¸€ä¸ªcsså±æ€§``` @media print &#123;&#125;``` æ­¤é…ç½®æ˜¯åªæœ‰åœ¨æ‰“å°æ—¶æ‰ç”Ÿæ•ˆçš„cssï¼Œæ§åˆ¶çš„æ˜¯æ‰“å°è¾¹è·ä»¥å†…çš„cssï¼Œå¹¶ä¸èƒ½æ§åˆ¶æ‰“å°è¾¹è·ã€‚# 4.æ‰“å°æ–¹æ¡ˆä½¿ç”¨webcontentæ‰“å°ï¼Œé¦–å…ˆè¦æœ‰ä¸€ä¸ªæ‰“å°çª—å£ï¼Œè¿™ä¸ªçª—å£ä¸èƒ½éšæ—¶æ‰“å°éšæ—¶åˆ›å»ºï¼Œæ¯”è¾ƒè€—è´¹æ€§èƒ½ã€‚å¯ä»¥å°†å®ƒåœ¨ç¨‹åºè¿è¡Œæ—¶å¯åŠ¨å¥½ï¼Œå¹¶åšå¥½äº‹ä»¶ç›‘å¬ã€‚æ­¤è¿‡ç¨‹éœ€å’Œè°ƒç”¨æ‰“å°çš„è¿›è¡Œåšå¥½é€šä¿¡ï¼šå¤§è‡´è¿‡ç¨‹å¦‚ä¸‹ï¼š![image](http://on-img.com/chart_image/5badf135e4b0fe81b64ad7b9.png)å¯è§é€šä¿¡éå¸¸ç¹çä½¿ç”¨webviewè¿›è¡Œæ‰“å°å¯å®ç°åŒæ ·çš„æ•ˆæœä½†æ˜¯é€šä¿¡æ–¹å¼ä¼šå˜å¾—ç®€å•ï¼Œå› ä¸ºæ¸²æŸ“è¿›ç¨‹å’Œwebviewé€šä¿¡ä¸éœ€è¦ç»è¿‡ä¸»è¿›ç¨‹ï¼Œé€šè¿‡å¦‚ä¸‹æ–¹å¼å³å¯ï¼š // In embedder page. const webview = document.querySelector(â€˜webviewâ€™) webview.addEventListener(â€˜ipc-messageâ€™, (event) =&gt; { console.log(event.channel) // Prints â€œpongâ€ }) webview.send(â€˜pingâ€™)Copy123456```// åœ¨è®¿å®¢é¡µã€‚ const &#123;ipcRenderer&#125; = require(&apos;electron&apos;) ipcRenderer.on(&apos;ping&apos;, () =&gt; &#123; ipcRenderer.sendToHost(&apos;pong&apos;) &#125;) 5.ç¤ºä¾‹ç¨‹åºç¤ºä¾‹demoï¼šhttps://github.com/ConardLi/electron-print-demo","categories":[],"tags":[{"name":"electron","slug":"electron","permalink":"https://www.lisq.xyz/tags/electron/"}]},{"title":"ä¸ªäººåšå®¢æ­å»ºåŠé…ç½®","slug":"ã€åšå®¢æ­å»ºã€‘ä¸ªäººåšå®¢æ­å»ºåŠé…ç½®","date":"2018-01-01T12:13:20.000Z","updated":"2019-04-06T05:24:53.435Z","comments":true,"path":"2018/01/01/ã€åšå®¢æ­å»ºã€‘ä¸ªäººåšå®¢æ­å»ºåŠé…ç½®/","link":"","permalink":"https://www.lisq.xyz/2018/01/01/ã€åšå®¢æ­å»ºã€‘ä¸ªäººåšå®¢æ­å»ºåŠé…ç½®/","excerpt":"","text":"ä¸€ã€åŸºç¡€é…ç½® 1.1.æœ¬åœ°å®‰è£…hexoé¦–å…ˆä¿è¯ä½ ç”µè„‘ä¸Šæœ‰nodeç¯å¢ƒï¼Œè¿™ä¸ªä¸æ‡‚çš„å¯ä»¥è‡ªå®šç™¾åº¦ã€‚ æ§åˆ¶å°è¾“å…¥node -vå‡ºç°ç‰ˆæœ¬å·è¯´æ˜å®‰è£…æˆåŠŸã€‚ æœ‰äº†nodeå°±å¯ä»¥å®‰è£…hexoäº†ï¼Œæ§åˆ¶å°è¾“å…¥å¦‚ä¸‹å‘½ä»¤ 1npm i -g hexo åŒæ ·æ§åˆ¶å°è¾“å…¥hexo -vå‡ºç°ç‰ˆæœ¬å·è¯´æ˜å®‰è£…æˆåŠŸã€‚ ç„¶åå¼€å§‹åˆå§‹åŒ–é¡¹ç›®ï¼Œæ§åˆ¶å°è¾“å…¥ï¼š 1hexo init å¾—åˆ°å¦‚ä¸‹é¡¹ç›®ç›®å½•ï¼š 12345678node_modulesï¼šæ˜¯ä¾èµ–åŒ…publicï¼šå­˜æ”¾çš„æ˜¯ç”Ÿæˆçš„é¡µé¢scaffoldsï¼šå‘½ä»¤ç”Ÿæˆæ–‡ç« ç­‰çš„æ¨¡æ¿sourceï¼šç”¨å‘½ä»¤åˆ›å»ºçš„å„ç§æ–‡ç« themesï¼šä¸»é¢˜_config.ymlï¼šæ•´ä¸ªåšå®¢çš„é…ç½®db.jsonï¼šsourceè§£ææ‰€å¾—åˆ°çš„package.jsonï¼šé¡¹ç›®æ‰€éœ€æ¨¡å—é¡¹ç›®çš„é…ç½®ä¿¡æ¯ 1.2.æœ¬åœ°è¿è¡Œé¦–å…ˆåœ¨æœ¬åœ°è·‘èµ·æ¥ä½ çš„ä»£ç  æ§åˆ¶å°å®‰è£…hexo-server 1npm i hexo-server ç„¶åè¿è¡Œ hexo-server åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼šhttp://localhost:4000å°±å¯ä»¥çœ‹åˆ°ä½ æœ¬å®šè¿è¡Œçš„é¡µé¢äº† è¿™æ—¶ä½ å¯ä»¥åœ¨æœ¬åœ°è°ƒè¯•ä¸€ä¸‹ä½ çš„blogã€‚ 1.3.githubé…ç½®é¦–å…ˆè¦åˆ›å»ºä¸€ä¸ªgithubè´¦å· å¹¶é…ç½®å¥½ssh è¿™äº›ä¸æ‡‚çš„å¯ä»¥è‡ªè¡Œç™¾åº¦ã€‚ åˆ›å»ºä¸€ä¸ªrepoï¼Œåç§°ä¸ºyourname.github.io, å…¶ä¸­yournameæ˜¯ä½ çš„githubåç§°ï¼ŒæŒ‰ç…§è¿™ä¸ªè§„åˆ™åˆ›å»ºgithub pageæ‰ä¼šç”Ÿæ•ˆã€‚ ä¿®æ”¹_config.ymlä¸­çš„gité…ç½® 1234deploy: type: git repo: https://github.com/xxxx.git branch: master 1.4.éƒ¨ç½²ä¸Šä¼ åœ¨æœ¬åœ°å®‰è£…ä¸Šä¼ å·¥å…· 1npm install hexo-deployer-git --save ä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ 123hexo clean //åˆ é™¤ä¸Šæ¬¡æ‰“åŒ…hexo generate //æ‰“åŒ…hexo deploy /ä¸Šä¼  è¿™é‡Œæˆ‘å•ç‹¬å†™äº†shæ‰§è¡Œè¿™ä¸‰æ®µè„šæœ¬ï¼Œè¿™æ ·æ¯æ¬¡åªéœ€è¦æ‰§è¡Œè¿™ä¸ªshå³å¯ã€‚ åœ¨æµè§ˆå™¨ä¸­è¾“å…¥http://yourgithubname.github.ioå°±å¯ä»¥çœ‹åˆ°ä½ çš„ä¸ªäººåšå®¢äº†ï¼ 1.5ä¸€äº›å…¶ä»–é…ç½®æœç´¢åŠŸèƒ½ä½¿ç”¨æœç´¢åŠŸèƒ½é¦–å…ˆéœ€è¦ï¼š 1npm install -S hexo-generator-json-content ç„¶åï¼š 12search: insight: true readme1.é¦–å…ˆåœ¨sourceæ–‡ä»¶å¤¹ä¸‹å»ºç«‹ä¸€ä¸ªREADME.md 2.ä¿®æ”¹_config.yml 1skip_render: README.md äºŒã€ç»‘å®šäºŒäººåŸŸå2.1è´­ä¹°ä¸€ä¸ªåŸŸåè¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯é˜¿é‡Œäº‘ï¼ŒæŒ‘é€‰ä¸€ä¸ªè‡ªå·±å–œæ¬¢çš„åŸŸåè´­ä¹°ã€‚ 2.2åŸŸåè§£æè¿›å…¥æ§åˆ¶å°æ·»åŠ åŸŸåè§£æã€‚ æŒ‰ç…§å¦‚ä¸‹è§„åˆ™æ·»åŠ ä¸¤æ¡è®°å½•ã€‚ è¿™æ—¶å»è®¿é—®è§£æå¥½çš„åŸŸåä¼šå‡ºç°å¦‚ä¸‹é¡µé¢ã€‚ è¿™è¯´æ˜åŸŸåè§£ææ²¡æœ‰é—®é¢˜ï¼Œæ¥ä¸‹æ¥è¿›å…¥githubè¿›è¡Œé…ç½® 2.3 hexoé…ç½®åœ¨æœ¬åœ°çš„åšå®¢ç›®å½•ä¸­æ‰¾åˆ°sourceæ–‡ä»¶å¤¹ã€‚ æ–°å»ºä¸€ä¸ªæ²¡æœ‰åç¼€åçš„æ–‡ä»¶GNAME åœ¨æ–‡ä»¶ä¸­æ·»åŠ ä½ çš„åŸŸåï¼Œå¦‚ï¼š 1lisq.xyz ä¿å­˜åé‡æ–°ç”Ÿæˆï¼Œå¹¶æäº¤ä½ çš„åšå®¢ã€‚ 2.4 githubé…ç½®åœ¨githubä¸­æ‰¾åˆ°ä½ çš„åšå®¢ä»“åº“ã€‚ ç‚¹å‡»12æ‰¾åˆ°```Custom domain è¾“å…¥ä½ çš„åŸŸåç‚¹å‡»save ç„¶åä½ å°±å¯ä»¥åœ¨æµè§ˆå™¨ç”¨ä½ çš„åŸŸåæ„‰å¿«çš„è®¿é—®å•¦ï¼ ä¸‰ã€åŒæ—¶æ‰˜ç®¡åˆ°githubå’Œcodingä¸Šgithub pageæ¯•ç«Ÿæ˜¯å›½å¤–ç«™ç‚¹ï¼Œè®¿é—®é€Ÿåº¦ç›¸å¯¹æ¥è¯´æ¯”è¾ƒæ…¢ï¼Œä½†æ˜¯åŒæ—¶ä½ åˆæƒ³åœ¨gihubä¸Šä¿å­˜ä¸€ä¸‹ä»£ç ï¼Œå¯ä»¥å°è¯•åŒæ—¶æ‰˜ç®¡ä¸¤ä¸ªä»“åº“ã€‚ åšè§£æçš„æ—¶å€™æµ·å¤–çš„ip æŒ‡å‘åˆ°githubï¼Œå›½å†…çš„æˆ–è€…è¯´ç™¾åº¦çš„ç›´æ¥æŒ‡å‘codingã€‚ 3.1.åœ¨codingä¸Šæäº¤ä»£ç é¦–å…ˆåšçš„æ“ä½œå’Œgithubæ˜¯ä¸€æ ·çš„ï¼Œå°±æ˜¯åˆ›å»ºä¸€ä¸ªsshã€‚ è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œä½ çš„ç”µè„‘ä¸Šå·²ç»æœ‰äº†gihubçš„sshï¼Œå¦‚æœè¿˜åƒgithubä¸€æ ·ä¸€è·¯å›è½¦ä¼šæŠŠgihubçš„sshç»™è¦†ç›–æ‰ã€‚ æ‰€ä»¥è¿™é‡Œåœ¨æ‰§è¡Œ 1$ ssh-keygen -t rsa -C &quot;youremail@example.com&quot; æ—¶è¦æ³¨æ„ï¼Œç»™ç”Ÿæˆçš„æ–‡ä»¶é…ç½®ä¸€ä¸ªæ–°è·¯å¾„ï¼š ç„¶åé…ç½®ç”Ÿæˆçš„ssh åœ¨codingä¸­åˆ›å»ºä¸€ä¸ªä»“åº“ï¼Œè¿™é‡Œæ³¨æ„ä»“åº“çš„åå­—å¯ä»¥éšæ„å–ï¼Œä¸åƒgihubä¸€æ ·å¯ä»¥éšæ„ç»™å®šã€‚ å°†åˆ›å»ºä»“åº“çš„gitåœ°å€æ·»åŠ åˆ°_config.ymlä¸­ï¼š 123456deploy: type: git repo: github: https://github.com/ConardLi/ConardLi.github.io.git coding: https://git.dev.tencent.com/ConardLi/lisqBlog.git branch: master ç„¶åé‡æ–°éƒ¨ç½²å¹¶ä¸Šä¼ åšå®¢ï¼Œå»ä»“åº“æŸ¥çœ‹ä»£ç è¯æ˜ä¸Šä¼ æˆåŠŸï¼š 3.2.å¼€å¯coding pageç‚¹å‡»codingçš„pagesæœåŠ¡ï¼Œç›´æ¥ç‚¹å‡»ä¸€é”®å¼€å¯å³å¯ã€‚ å¼€å¯åå³å¯é€šè¿‡ç»™å®šåŸŸåç›´æ¥è®¿é—®äº†ï¼š http://conardli.coding.me/ 3.3.åŸŸåè§£æå°†æ–°ç”Ÿæˆçš„codingåŸŸåè¿›è¡Œè§£æï¼Œè¿™æ ·å›½å†…å°±é»˜è®¤è®¿é—®codingçš„é¡µé¢ï¼Œæ¯”githubè¦å¿«ä¸å°‘ã€‚ å¦å¤–è¿˜å¯ä»¥å°†githubçš„ipè¿›è¡Œå›½å¤–ç«™ç‚¹é…ç½®ã€‚ åœ¨coding pageä¸­å°†è‡ªå·±çš„åŸŸåè¿›è¡Œç»‘å®šã€‚ é…ç½®å®Œæˆåå‘ç°é€Ÿåº¦å¿«äº†ä¸å°‘ï¼Œæœ‰æœ¨æœ‰â€¦ å››ã€ç«™é•¿ç»Ÿè®¡ ä½¿ç”¨ä¸€ä¸ªç«™é•¿ç»Ÿè®¡å·¥å…·ï¼Œå¯ä»¥ä¸ºåšå®¢æ·»åŠ ä¸€ä¸ªå¦‚ä¸Šé¢ä¼¼çš„è¯¦ç»†çš„è®¿é—®æŠ¥è¡¨ã€‚ ç«™é•¿ç»Ÿè®¡å·¥å…·æœ‰å¾ˆå¤šï¼Œæ¯ä¸ªå·¥å…·å¤§åŒå°å¼‚ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©äº†CNZZã€‚ 4.1.CNZZé…ç½®1.æ³¨å†Œä¸€ä¸ªè´¦å·ã€‚ 2.æ·»åŠ ç½‘ç«™ã€‚ æŒ‰ç…§å¦‚ä¸‹è¦æ±‚æ·»åŠ ç½‘ç«™ 3.é€‰æ‹©ç»Ÿè®¡ä»£ç  æ·»åŠ å®Œç½‘ç«™åå°±å¯ä»¥é€‰æ‹©ä¸€æ®µä»£ç æ’å…¥ä½ çš„åšå®¢é‡Œäº†ï¼ŒCNZZæä¾›äº†å‡ ç§æ ·å¼ï¼Œä½ å¯ä»¥é€‰æ‹©å±•ç¤ºçœŸå®çš„ç»Ÿè®¡æ•°é‡ï¼Œä¸€ä¸ªcnzzå›¾æ ‡æˆ–è€…ä»€ä¹ˆéƒ½ä¸æ˜¾ç¤ºã€‚ 4.2.ä»£ç é…ç½®å°†ä¸Šé¢å¤åˆ¶çš„ä»£ç æ’å…¥åˆ°ä½ ä¸»é¢˜ä»£ç çš„å…¬å…±åŒºåŸŸä¸­ã€‚ æ¯ä¸ªä¸»é¢˜çš„ä»£ç éƒ½ä¸ä¸€æ ·ï¼Œä½†æ˜¯å¤§ä½“ç»“æ„æ˜¯ç›¸åŒçš„ï¼Œéƒ½ä¼šå°†é€šç”¨çš„ç»„ä»¶æŠ½å–å‡ºæ¥ã€‚ è¿™é‡Œæˆ‘æ‰¾åˆ°äº†æ¯ä¸ªé¡µé¢éƒ½ä½¿ç”¨çš„footerç»„ä»¶ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯huemanä¸»é¢˜ï¼Œä»£ç åœ¨themes/hueman/common/footer.ejs åœ¨æ­¤æ–‡ä»¶ä¸­æ‰¾åˆ°åˆé€‚çš„ä½ç½®æ’å…¥ä½ çš„ç»Ÿè®¡ä»£ç ã€‚ æ¯”å¦‚æˆ‘çš„ï¼ˆscriptå†…çš„éƒ¨åˆ†ï¼‰ï¼š äº”ã€é˜…è¯»ç»Ÿè®¡è¿™é‡Œçš„ç»Ÿè®¡æ˜¯ç”¨æ¥å±•ç¤ºåœ¨é¡µé¢ä¸Šçš„ï¼Œå¯ä»¥æ ‡ç¤ºæ–‡ç« ä»¥åŠåšå®¢çš„çƒ­åº¦ã€‚ ä½¿ç”¨ä¸è’œå­æ¥å±•ç¤ºæ–‡ç« è®¿é—®ç»Ÿè®¡å’Œé¡µé¢è®¿é—®ç»Ÿè®¡ã€‚ 5.1.å¼•å…¥ä¸è’œå­å°†ä¸è’œå­jsæ–‡ä»¶å¼•å…¥åšå®¢ä¸»é¢˜å…¬å…±ç»„ä»¶ä¸­ã€‚ 1&lt;script async src=\"//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js\"&gt;&lt;/script&gt; è¿™é‡Œæˆ‘åŒç«™é•¿ç»Ÿè®¡ä¸€æ ·æ”¾åœ¨themes/hueman/common/footer.ejs 5.2.æ–‡ç« è®¿é—®ç»Ÿè®¡è¦æ˜¾ç¤ºæ¯ç¯‡æ–‡ç« çš„è®¿é—®é‡ï¼Œå¤åˆ¶ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°ä½ éœ€è¦æ˜¾ç¤ºçš„ä½ç½®ã€‚ å¯ä»¥åœ¨æ ‡ç­¾ä¸Šè‡ªå®šä¹‰ä¸€äº›æ ·å¼ã€‚ ç®—æ³•ï¼špvçš„æ–¹å¼ï¼Œå•ä¸ªç”¨æˆ·ç‚¹å‡»1ç¯‡æ–‡ç« ï¼Œæœ¬ç¯‡æ–‡ç« è®°å½•1æ¬¡é˜…è¯»é‡ã€‚ 123&lt;span id=\"busuanzi_container_page_pv\"&gt; æœ¬æ–‡æ€»é˜…è¯»é‡&lt;span id=\"busuanzi_value_page_pv\"&gt;&lt;/span&gt;æ¬¡&lt;/span&gt; 5.3.æ•´ç«™è®¿é—®ç»Ÿè®¡ç®—æ³•aï¼špvçš„æ–¹å¼ï¼Œå•ä¸ªç”¨æˆ·è¿ç»­ç‚¹å‡»nç¯‡æ–‡ç« ï¼Œè®°å½•næ¬¡è®¿é—®é‡ã€‚ 123&lt;span id=\"busuanzi_container_site_pv\"&gt; æœ¬ç«™æ€»è®¿é—®é‡&lt;span id=\"busuanzi_value_site_pv\"&gt;&lt;/span&gt;æ¬¡&lt;/span&gt; ç®—æ³•bï¼šuvçš„æ–¹å¼ï¼Œå•ä¸ªç”¨æˆ·è¿ç»­ç‚¹å‡»nç¯‡æ–‡ç« ï¼Œåªè®°å½•1æ¬¡è®¿å®¢æ•°ã€‚123&lt;span id=\"busuanzi_container_site_uv\"&gt; æœ¬ç«™è®¿å®¢æ•°&lt;span id=\"busuanzi_value_site_uv\"&gt;&lt;/span&gt;äººæ¬¡&lt;/span&gt; å…­ã€è¯„è®ºç³»ç»Ÿåšå®¢ä½¿ç”¨valineä½œä¸ºè¯„è®ºå·¥å…·ï¼ŒåŸå› æ˜¯ä»–ä½¿ç”¨ç®€ä»‹ï¼Œä½“ç§¯è½»é‡ï¼Œçµæ´»é…ç½®ï¼Œé€Ÿåº¦å¾ˆå¿«ï¼ 6.1 æ³¨å†ŒLeanCloudvalineæ¥ä½äº†LeanCloudçš„åŠ›é‡ï¼Œæ‰€ä»¥éœ€è¦LeanCloudçš„APP ID å’Œ APP Key é¦–å…ˆæ³¨å†Œå’Œç™»å½•LeanCloud åˆ›å»ºä¸€ä¸ªåº”ç”¨ï¼š åº”ç”¨åˆ›å»ºå¥½ä»¥åï¼Œè¿›å…¥åˆšåˆšåˆ›å»ºçš„åº”ç”¨ï¼Œé€‰æ‹©å·¦ä¸‹è§’çš„è®¾ç½®&gt;åº”ç”¨Keyï¼Œç„¶åå°±èƒ½çœ‹åˆ°ä½ çš„APP IDå’ŒAPP Keyäº†ï¼š 6.2 ä»£ç å°†å¦‚ä¸‹ä»£ç æ’å…¥ä½ çš„æ–‡ç« æ¨¡æ¿ä¸­ 1234567891011121314151617&lt;head&gt; ... &lt;script src=&quot;//cdn1.lncld.net/static/js/3.0.4/av-min.js&quot;&gt;&lt;/script&gt; &lt;script src=&apos;//unpkg.com/valine/dist/Valine.min.js&apos;&gt;&lt;/script&gt; ...&lt;/head&gt;&lt;body&gt; ... &lt;div id=&quot;vcomments&quot;&gt;&lt;/div&gt; &lt;script&gt; new Valine(&#123; el: &apos;#vcomments&apos;, appId: &apos;&lt;API_ID&gt;&apos;, appKey: &apos;&lt;API_Key&gt;&apos; &#125;) &lt;/script&gt;&lt;/body&gt; é…ç½®å¥½è¿™äº›ï¼Œç­‰å¾…ä¸¤åˆ†é’Ÿï¼Œå°±å¯ä»¥åœ¨æ–‡ç« é‡Œä½¿ç”¨ä½ çš„è¯„è®ºå•¦ã€‚ 6.3 æ•°æ®ç®¡ç†ç”±äºValine æ˜¯æ— åç«¯è¯„è®ºç³»ç»Ÿï¼Œæ‰€ä»¥ä¹Ÿå°±æ²¡æœ‰å¼€å‘è¯„è®ºæ•°æ®ç®¡ç†åŠŸèƒ½ã€‚ å¯ä»¥åœ¨leanCloudä¸­ç®¡ç†è¯„è®º 1ç™»å½•&gt;é€‰æ‹©ä½ åˆ›å»ºçš„åº”ç”¨&gt;å­˜å‚¨&gt;é€‰æ‹©Class Comment 6.4 å®‰å…¨åŸŸåä¸ºäº†æ•°æ®å®‰å…¨ï¼Œåœ¨leanCloudä¸­é…ç½®ä½ çš„å®‰å…¨åŸŸå 6.5 é…ç½®é¡¹Valineè¿˜æœ‰ä¸€äº›å…¶ä»–çš„é…ç½®é¡¹ 123456789new Valine(&#123; el: &apos;#vcomments&apos; , appId: &apos;&lt;APP_ID&gt;&apos;, appKey: &apos;&lt;APP_KEY&gt;&apos;, notify:false, verify:false, avatar:&apos;mm&apos;, placeholder: &apos;just go go&apos; &#125;); 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788placeholderç±»å‹:Stringé»˜è®¤å€¼:Just go goå¿…è¦æ€§:falseè¯„è®ºæ¡†å ä½æç¤ºç¬¦ã€‚notifyç±»å‹:Booleané»˜è®¤å€¼:falseå¿…è¦æ€§:falseè¯„è®ºå›å¤é‚®ä»¶æé†’ï¼Œè¯·å‚è€ƒé…ç½®ã€‚verifyç±»å‹:Booleané»˜è®¤å€¼:falseå¿…è¦æ€§:falseéªŒè¯ç æœåŠ¡ã€‚pathç±»å‹:Stringé»˜è®¤å€¼:window.location.pathnameå¿…è¦æ€§:falseå½“å‰æ–‡ç« é¡µè·¯å¾„ï¼Œç”¨äºåŒºåˆ†ä¸åŒçš„æ–‡ç« é¡µï¼Œä»¥ä¿è¯æ­£ç¡®è¯»å–è¯¥æ–‡ç« é¡µä¸‹çš„è¯„è®ºåˆ—è¡¨ã€‚å¯é€‰å€¼ï¼šwindow.location.pathname (é»˜è®¤å€¼ï¼Œæ¨è)window.location.hrefè‡ªå®šä¹‰I. è¯·ä¿è¯æ¯ä¸ªæ–‡ç« é¡µè·¯å¾„çš„å”¯ä¸€æ€§ï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°ä¸åŒæ–‡ç« é¡µä¸‹åŠ è½½ç›¸åŒè¯„è®ºåˆ—è¡¨çš„æƒ…å†µã€‚II. å¦‚æœå€¼ä¸ºwindow.location.hrefï¼Œå¯èƒ½ä¼šå‡ºç°éšä¾¿åŠ ä¸åŒå‚æ•°è¿›å…¥è¯¥é¡µé¢ï¼Œè€Œè¢«åˆ¤æ–­æˆæ–°é¡µé¢çš„æƒ…å†µã€‚avatarç±»å‹:Stringé»˜è®¤å€¼:mmå¿…è¦æ€§:falseGravatar å¤´åƒå±•ç¤ºæ–¹å¼ã€‚å¯é€‰å€¼ï¼š&apos;&apos;(ç©ºå­—ç¬¦ä¸²)mpidenticonmonsteridwavatarretrorobohashhideæ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹å¤´åƒé…ç½®ã€‚metaç±»å‹:Arrayé»˜è®¤å€¼:[&apos;nick&apos;,&apos;mail&apos;,&apos;link&apos;]å¿…è¦æ€§:falseè¯„è®ºè€…ç›¸å…³å±æ€§ã€‚pageSizeç±»å‹:Numberé»˜è®¤å€¼:10å¿…è¦æ€§:falseè¯„è®ºåˆ—è¡¨åˆ†é¡µï¼Œæ¯é¡µæ¡æ•°ã€‚langç±»å‹:Stringé»˜è®¤å€¼:zh-cnå¿…è¦æ€§:falseå¤šè¯­è¨€æ”¯æŒã€‚å¯é€‰å€¼ï¼šzh-cnenå¦‚éœ€è‡ªå®šä¹‰è¯­è¨€ï¼Œè¯·å‚è€ƒi18nã€‚visitorç±»å‹:Booleané»˜è®¤å€¼:falseå¿…è¦æ€§:falseæ–‡ç« è®¿é—®é‡ç»Ÿè®¡ã€‚highlightç±»å‹ï¼šBooleané»˜è®¤å€¼: trueå¿…è¦æ€§: falseä»£ç é«˜äº®ï¼Œé»˜è®¤å¼€å¯ï¼Œè‹¥ä¸éœ€è¦ï¼Œè¯·æ‰‹åŠ¨å…³é—­avatarForceç±»å‹: Booleané»˜è®¤å€¼: falseå¿…è¦æ€§: false ä¸ƒã€SEOä¼˜åŒ–SEOæ˜¯ç”±è‹±æ–‡Search Engine Optimizationç¼©å†™è€Œæ¥ï¼Œ ä¸­æ–‡æ„è¯‘ä¸ºâ€œæœç´¢å¼•æ“ä¼˜åŒ–â€ã€‚SEOæ˜¯æŒ‡é€šè¿‡ç«™å†…ä¼˜åŒ–æ¯”å¦‚ç½‘ç«™ç»“æ„è°ƒæ•´ã€ç½‘ç«™å†…å®¹å»ºè®¾ã€ç½‘ç«™ä»£ç ä¼˜åŒ–ç­‰ä»¥åŠç«™å¤–ä¼˜åŒ–ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯è®©äººä»¬æ›´å®¹æ˜“æœç´¢åˆ°ä½ çš„ç«™ç‚¹ã€‚ é¦–å…ˆè¦åšçš„å°±æ˜¯è®©æœç´¢å¼•æ“æ”¶å½•æˆ‘ä»¬çš„ç«™ç‚¹ã€‚ 7.1.ç™¾åº¦7.1.1 æäº¤ç½‘å€åœ¨æœç´¢å¼•æ“ä¸­è¾“å…¥site:&lt;åŸŸå&gt;,å¦‚æœå¦‚ä¸‹å›¾æ‰€ç¤ºå°±æ˜¯è¯´æ˜æˆ‘ä»¬çš„ç½‘ç«™å¹¶æ²¡æœ‰è¢«ç™¾åº¦æ”¶å½•ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥ç‚¹å‡»ä¸‹é¢çš„â€œç½‘å€æäº¤â€æ¥æäº¤æˆ‘ä»¬çš„ç½‘ç«™ ç„¶åç‚¹å‡»é€”ä¸­çš„æäº¤ç½‘å€ é€‰æ‹©ç«™ç‚¹çš„ç›¸å…³å±æ€§ï¼š æ¥ä¸‹æ¥è¿›è¡Œç½‘ç«™éªŒè¯ï¼Œæ¨èä½¿ç”¨ç¬¬ä¸‰ç§GNAMEéªŒè¯ï¼Œç®€å•å¿«æ·ï¼Œåªéœ€è¦ç»™ä½ çš„é“¾æ¥å¢åŠ ä¸€æ¡è§£æå³å¯: 7.1.2 ç”Ÿæˆç½‘ç«™åœ°å›¾æ¥ä¸‹æ¥è¦è®©ä½ çš„ç½‘ç«™ç”Ÿæˆç½‘ç«™åœ°å›¾ï¼ŒåŠç”Ÿäº§sitemapï¼Œå°†sitemapæäº¤åˆ°ç™¾åº¦ï¼Œå…ˆå®‰è£…åœ°å›¾ç”Ÿæˆæ’ä»¶ï¼š 12npm install hexo-generator-sitemap --savenpm install hexo-generator-baidu-sitemap --save æ³¨æ„æ ¹ç›®å½•çš„_config.ymlå°†urlé…ç½®æˆä½ çš„ç«™ç‚¹1234# URL## If your site is put in a subdirectory, set url as &apos;http://yoursite.com/child&apos; and root as &apos;/child/&apos;url: https://lisq.xyz/root: / é‡æ–°éƒ¨ç½²åšå®¢åå°±ä¼šç”Ÿæˆä¸¤ä¸ªæ–°æ–‡ä»¶sitemap.xmlå’Œbaidusitemap.xml 7.1.3 å°†sitemapæäº¤ç»™ç™¾åº¦ç‚¹å‡»é“¾æ¥æäº¤ ä½¿ç”¨ä¸»åŠ¨æ¨é€ ä¸»åŠ¨æ¨é€å®‰è£…æ’ä»¶npm install hexo-baidu-url-submit â€“saveç„¶åå†æ ¹ç›®å½•çš„é…ç½®æ–‡ä»¶ä¸­æ–°å¢å­—æ®µ12345baidu_url_submit: count: 100 host: https://lisq.xyz/ token: 8OGYpxowYnhgVsUM path: baidu_urls.txt # æ–‡æœ¬æ–‡æ¡£çš„åœ°å€ åœ¨åŠ å…¥æ–°çš„deploye12deploy: - type:baidu_url_submitter ç™¾åº¦æ”¶å½•çš„æ—¶é—´éå¸¸é•¿ï¼Œè€å¿ƒç­‰å¾…å§ã€‚ 7.2.è°·æ­Œç‚¹å‡»è¿™é‡Œæ·»åŠ ä½ çš„ç½‘å€ ç‚¹å‡»æ·»åŠ å±æ€§åå³å¯æ·»åŠ ä½ çš„åšå®¢åœ°å€ã€‚ è¿›è¡ŒéªŒè¯ï¼š è°·æ­Œæ”¶å½•çš„é€Ÿåº¦è¿˜æ˜¯ç›¸å½“å¿«çš„ï¼Œè€Œä¸”æ“ä½œæ¯”è¾ƒç®€å•ã€‚","categories":[],"tags":[{"name":"åšå®¢æ­å»º","slug":"åšå®¢æ­å»º","permalink":"https://www.lisq.xyz/tags/åšå®¢æ­å»º/"}]}]}